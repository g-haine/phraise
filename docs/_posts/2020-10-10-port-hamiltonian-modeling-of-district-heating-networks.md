---
layout: post
title: "Port-Hamiltonian Modeling of District Heating Networks"
date: 2020-10-10 00:00:00 +0100
permalink: port-hamiltonian-modeling-of-district-heating-networks
year: 2020
authors: Sarah-Alexa Hauschild, Nicole Marheineke, Volker Mehrmann, Jan Mohring, Arbi Moses Badlyan, Markus Rein, Martin Schmidt
category: chapters
tags:
  - Partial differential equations on networks
  - Port-Hamiltonian model framework
  - Energy-based formulation
  - District heating network
  - Thermodynamic fluid flow
  - Turbulent pipe flow
  - Euler-like equations
  - 93A30
  - 35Q31
  - 37D35
  - 76-XX
---
 
## Authors
[Sarah-Alexa Hauschild](authors/sarah-alexa-hauschild), [Nicole Marheineke](authors/nicole-marheineke), [Volker Mehrmann](authors/volker-mehrmann), [Jan Mohring](authors/jan-mohring), [Arbi Moses Badlyan](authors/arbi-moses-badlyan), [Markus Rein](authors/markus-rein), [Martin Schmidt](authors/martin-schmidt)
 
## Abstract
This paper provides a first contribution to port-Hamiltonian modeling of district heating networks. District heating network By introducing a model hierarchy of flow equations on the network, this work aims at a thermodynamically consistent port-Hamiltonian embedding of the partial differential-algebraic systems. We show that a spatially discretized network model describing the advection of the internal energy density with respect to an underlying incompressible stationary Euler-type hydrodynamics can be considered as a parameter-dependent finite-dimensional port-Hamiltonian system. Port-Hamiltonian system Moreover, we present an infinite-dimensional port-Hamiltonian formulation for a compressible instationary thermodynamic fluid flow Thermodynamic fluid flow in a pipe. Based on these first promising results, we raise open questions and point out research perspectives concerning structure-preserving discretization, model reduction, and optimization.
 
## Keywords
Partial differential equations on networks; Port-Hamiltonian model framework; Energy-based formulation; District heating network; Thermodynamic fluid flow; Turbulent pipe flow; Euler-like equations; 93A30; 35Q31; 37D35; 76-XX
 
## Citation
- **ISBN:** 9783030539047
- **Publisher:** Springer International Publishing
- **DOI:** [10.1007/978-3-030-53905-4_11](https://doi.org/10.1007/978-3-030-53905-4_11)
 
## BibTeX
{% highlight bibtex %}
{% raw %}
@inbook{Hauschild_2020,
  title={{Port-Hamiltonian Modeling of District Heating Networks}},
  ISBN={9783030539054},
  ISSN={2199-840X},
  DOI={10.1007/978-3-030-53905-4_11},
  booktitle={{Progress in Differential-Algebraic Equations II}},
  publisher={Springer International Publishing},
  author={Hauschild, Sarah-Alexa and Marheineke, Nicole and Mehrmann, Volker and Mohring, Jan and Badlyan, Arbi Moses and Rein, Markus and Schmidt, Martin},
  year={2020},
  pages={333--355}
}
{% endraw %}
{% endhighlight %}
 
## References
- [Altmann, R., Schulze, P.: A port-Hamiltonian formulation of the Navier-Stokes equations for reactive flows. Syst. Control Lett. 100, 51–55 (2017). 
https://doi.org/10.10.16/j.sysconle.2016.12.005](a-port-hamiltonian-formulation-of-the-navier-stokes-equations-for-reactive-flows) -- [10.1016/j.sysconle.2016.12.005](https://doi.org/10.1016/j.sysconle.2016.12.005)
- Antoulas, A.: Approximation of Large-Scale Dynamical Systems. SIAM, Philadelphia (2005). 
https://doi.org/10.1137/1.9780898718713 -- [10.1137/1.9780898718713](https://doi.org/10.1137/1.9780898718713)
- [Beattie, C., Mehrmann, V., Xu, H., Zwart, H.: Linear port-Hamiltonian descriptor systems. Math. Control Signals Syst. 30, 17 (2018). 
https://doi.org/10.1007/s00498-018-0223-3](linear-port-hamiltonian-descriptor-systems) -- [10.1007/s00498-018-0223-3](https://doi.org/10.1007/s00498-018-0223-3)
- Betsch, P., Schiebl, M.: Energy-momentum-entropy consistent numerical methods for large-strain thermoelasticity relying on the GENERIC formalism. Int. J. Numer. Methods Eng. 119(12), 1216–1244 (2019). 
https://doi.org/10.1002/nme.6089 -- [10.1002/nme.6089](https://doi.org/10.1002/nme.6089)
- Bundesverband der deutschen Gas- und Wasserwirtschaft (BGW): Anwendung von Standardlastprofilen zur Belieferung nichtleistungsgemessener Kunden (2006). 
http://www.gwb-netz.de/wa_files/05_bgw_leitfaden_lastprofile_56550.pdf

. Accessed July 23 2019
- [Chaturantabut, S., Beattie, C., Gugercin, S.: Structure-preserving model reduction for nonlinear port-Hamiltonian systems. SIAM J. Sci. Comput. 38(5), B837–B865 (2016). 
https://doi.org/10.1137/15M1055085](structure-preserving-model-reduction-for-nonlinear-port-hamiltonian-systems) -- [10.1137/15M1055085](https://doi.org/10.1137/15M1055085)
- Clamond, D.: Efficient resolution of the Colebrook equation. Ind. Eng. Chem. Res. 48(7), 3665–3671 (2009). 
https://doi.org/10.1021/ie801626g -- [10.1021/ie801626g](https://doi.org/10.1021/ie801626g)
- [Dalsmo, M., van der Schaft, A.: On representations and integrability of mathematical structures in energy-conserving physical systems. SIAM J. Control Optim. 37(1), 54–91 (1999). 
https://doi.org/10.1137/S0363012996312039](on-representations-and-integrability-of-mathematical-structures-in-energy-conserving-physical-systems) -- [10.1137/S0363012996312039](https://doi.org/10.1137/S0363012996312039)
- Egger, H.: Energy stable Galerkin approximation of Hamiltonian and gradient systems (2018). arXiv:1812.04253
- [Egger, H., Kugler, T., Liljegren-Sailer, B., Marheineke, N., Mehrmann, V.: On structure-preserving model reduction for damped wave propagation in transport networks. SIAM J. Sci. Comput. 40(1), A331–A365 (2018). 
https://doi.org/10.1137/17M1125303](on-structure-preserving-model-reduction-for-damped-wave-propagation-in-transport-networks) -- [10.1137/17M1125303](https://doi.org/10.1137/17M1125303)
- Feireisl, E.: Relative entropies in thermodynamics of complete fluid systems. Discrete Continuous Dynam. Syst. 32(9), 3059–3080 (2012). 
https://doi.org/10.3934/dcds.2012.32.3059 -- [10.3934/dcds.2012.32.3059](https://doi.org/10.3934/dcds.2012.32.3059)
- Geißler, B., Morsi, A., Schewe, L., Schmidt, M.: Solving power-constrained gas transportation problems using an MIP-based alternating direction method. Comput. Chem. Eng. 82, 303–317 (2015). 
https://doi.org/10.1016/j.compchemeng.2015.07.005 -- [10.1016/j.compchemeng.2015.07.005](https://doi.org/10.1016/j.compchemeng.2015.07.005)
- Geißler, B., Morsi, A., Schewe, L., Schmidt, M.: Solving highly detailed gas transport MINLPs: block separability and penalty alternating direction methods. INFORMS J. Comput. 30(2), 309–323 (2018). 
https://doi.org/10.1287/ijoc.2017.0780 -- [10.1287/ijoc.2017.0780](https://doi.org/10.1287/ijoc.2017.0780)
- Grmela, M., Öttinger, H.C.: Dynamics and thermodynamics of complex fluids. I. Development of a general formalism. Phys. Rev. E 56(6), 6620–6632 (1997). 
https://doi.org/10.1103/PhysRevE.56.6620 -- [10.1103/PhysRevE.56.6620](https://doi.org/10.1103/PhysRevE.56.6620)
- Hante, F.M., Schmidt, M.: Complementarity-based nonlinear programming techniques for optimal mixing in gas networks. EURO J. Comput. Optim. 7, 299–323, (2019). 
https://doi.org/10.1007/s13675-019-00112-w -- [10.1007/s13675-019-00112-w](https://doi.org/10.1007/s13675-019-00112-w)
- [Jacob, B., Zwart, H.: Linear Port-Hamiltonian Systems on Infinite-Dimensional Spaces. Birkhäuser/Springer, Basel (2012). 
https://doi.org/10.1007/978-3-0348-0399-1](linear-port-hamiltonian-systems-on-infinite-dimensional-spaces) -- [10.1007/978-3-0348-0399-1](https://doi.org/10.1007/978-3-0348-0399-1)
- [Kotyczka, P., Lefèvre, L.: Discrete-time port-Hamiltonian systems based on Gauss-Legendre collocation. IFAC-Papers OnLine 51(3), 125–130 (2018). 
https://doi.org/10.1016/j.ifacol.2018.06.035](discrete-time-port-hamiltonian-systems-based-on-gauss-legendre-collocation) -- [10.1016/j.ifacol.2018.06.035](https://doi.org/10.1016/j.ifacol.2018.06.035)
- Kraus, M., Hirvijoki, E.: Metriplectic integrators for the Landau collision operator. Phys. Plasmas 24(10), 102311 (2017). 
https://doi.org/10.1063/1.4998610 -- [10.1063/1.4998610](https://doi.org/10.1063/1.4998610)
- Kraus, M., Kormann, K., Morrison, P.J., Sonnendrücker, E.: GEMPIC: Geometric electromagnetic particle-in-cell methods. J. Plasma Phys. 83(4), 905830401 (2017). 
https://doi.org/10.1017/S002237781700040X -- [10.1017/S002237781700040X](https://doi.org/10.1017/S002237781700040X)
- [Le Gorrec, Y., Zwart, H., Maschke, B.: Dirac structures and boundary control systems associated with skew-symmetric differential operators. SIAM J. Control Optim. 44(5), 1864–1892 (2005). 
https://doi.org/10.1137/040611677](dirac-structures-and-boundary-control-systems-associated-with-skew-symmetric-differential-operators) -- [10.1137/040611677](https://doi.org/10.1137/040611677)
- LeVeque, R.J.: Numerical Methods for Conservation Laws, 2 edn. Birkhäuser, Basel (2008). 
https://doi.org/10.1007/978-3-0348-8629-1 -- [10.1007/978-3-0348-8629-1](https://doi.org/10.1007/978-3-0348-8629-1)
- Liljegren-Sailer, B., Marheineke, N.: Structure-preserving Galerkin approximation for a class of nonlinear port-Hamiltonian partial differential equations on networks. Proc. Appl. Math. Mech. 19(1), e201900399 (2019). 
https://doi.org/10.1002/pamm.201900399 -- [10.1002/pamm.201900399](https://doi.org/10.1002/pamm.201900399)
- [Mehl, C., Mehrmann, V., Wojtylak, M.: Linear algebra properties of dissipative port-Hamiltonian descriptor systems. SIAM J. Matrix Anal. Appl. 39(3), 1489–1519 (2018). 
https://doi.org/10.1137/18M1164275](linear-algebra-properties-of-dissipative-hamiltonian-descriptor-systems) -- [10.1137/18M1164275](https://doi.org/10.1137/18M1164275)
- Mehrmann, V., Morandin, R.: Structure-preserving discretization for port-Hamiltonian descriptor systems (2019). arXiv:1903.10451
- Mehrmann, V., Schmidt, M., Stolwijk, J.J.: Model and discretization error adaptivity within stationary gas transport optimization. Vietnam J. Math. 46(4), 779–801 (2018). 
https://doi.org/10.1007/s10013-018-0303-1 -- [10.1007/s10013-018-0303-1](https://doi.org/10.1007/s10013-018-0303-1)
- Moses Badlyan, A., Zimmer, C.: Operator-GENERIC formulation of thermodynamics of irreversible processes (2018). arXiv:1807.09822
- Moses Badlyan, A., Maschke, B., Beattie, C., Mehrmann, V.: Open physical systems: from GENERIC to port-Hamiltonian systems. In: Proceedings of the 23rd International Symposium on Mathematical Theory of Systems and Networks, pp. 204–211 (2018)
- National Institute of Standards and Technology: Thermophysical Properties of Fluid Systems (2016). 
http://webbook.nist.gov/chemistry/fluid
- Öttinger, H.C.: Nonequilibrium thermodynamics for open systems. Phys. Rev. E 73(3), 036126 (2006). 
https://doi.org/10.1103/PhysRevE.73.036126 -- [10.1103/PhysRevE.73.036126](https://doi.org/10.1103/PhysRevE.73.036126)
- Öttinger, H.C., Grmela, M.: Dynamics and thermodynamics of complex fluids. II. Illustrations of a general formalism. Phys. Rev. E 56(6), 6633–6655 (1997). 
https://doi.org/10.1103/PhysRevE.56.6633 -- [10.1103/PhysRevE.56.6633](https://doi.org/10.1103/PhysRevE.56.6633)
- [Polner, M., van der Vegt, J.: A Hamiltonian vorticity-dilatation formulation of the compressible Euler equations. Nonlinear Anal. 109, 113–135 (2014). 
https://doi.org/10.1016/j.na.2014.07.005](a-hamiltonian-vorticity-dilatation-formulation-of-the-compressible-euler-equations) -- [10.1016/j.na.2014.07.005](https://doi.org/10.1016/j.na.2014.07.005)
- Rein, M., Mohring, J., Damm, T., Klar, A.: Model order reduction of hyperbolic systems at the example of district heating networks (2019). arXiv:1903.03342
- Rein, M., Mohring, J., Damm, T., Klar, A.: Optimal control of district heating networks using a reduced order model (2019). arXiv:1907.05255
- Schlichting, H., Gersten, K.: Grenzschicht-Theorie, 10th edn. Springer, Berlin (2006). 
https://doi.org/10.1007/3-540-32985-4 -- [10.1007/3-540-32985-4](https://doi.org/10.1007/3-540-32985-4)
- [Serhani, A., Haine, G., Matignon, D.: Anisotropic heterogeneous n-D heat equation with boundary control and observation: I. Modeling as port-Hamiltonian system. IFAC-PapersOnLine 52(7), 51–56 (2019). 
https://doi.org/10.1016/j.ifacol.2019.07.009](anisotropic-heterogeneous-n-d-heat-equation-with-boundary-control-and-observation-i-modeling-as-port-hamiltonian-system) -- [10.1016/j.ifacol.2019.07.009](https://doi.org/10.1016/j.ifacol.2019.07.009)
- [Serhani, A., Haine, G., Matignon, D.: Anisotropic heterogeneous n-D heat equation with boundary control and observation: II. Structure-preserving discretization. IFAC-PapersOnLine 52(7), 57–62 (2019). 
https://doi.org/10.1016/j.ifacol.2019.07.010](anisotropic-heterogeneous-n-d-heat-equation-with-boundary-control-and-observation-ii-structure-preserving-discretization) -- [10.1016/j.ifacol.2019.07.010](https://doi.org/10.1016/j.ifacol.2019.07.010)
- [Serhani, A., Matignon, D., Haine, G.: A partitioned finite element method for the structure-preserving discretization of damped infinite-dimensional port-Hamiltonian systems with boundary control. In: F. Nielsen, F. Barbaresco (eds.) Geometric Science of Information, pp. 549–558. Springer (2019)](a-partitioned-finite-element-method-for-the-structure-preserving-discretization-of-damped-infinite-dimensional-port-hamiltonian-systems-with-boundary-control) -- [10.1007/978-3-030-26980-7_57](https://doi.org/10.1007/978-3-030-26980-7_57)
- Shashi Menon, E.: Transmission Pipeline Calculations and Simulations Manual. Elsevier, Amsterdam (2015). 
https://doi.org/10.1016/C2009-0-60912-0 -- [10.1016/C2009-0-60912-0](https://doi.org/10.1016/C2009-0-60912-0)
- [van der Schaft, A.: Port-Hamiltonian differential-algebraic systems. In: Surveys in Differential-Algebraic Equations I, pp. 173–226. Springer, Berlin (2013). 
https://doi.org/10.1007/978-3-642-34928-7_5](port-hamiltonian-differential-algebraic-systems) -- [10.1007/978-3-642-34928-7_5](https://doi.org/10.1007/978-3-642-34928-7_5)
- [van der Schaft, A., Jeltsema, D.: Port-Hamiltonian systems theory: an introductory overview. Found. Trends Syst. Control 1(2–3), 173–378 (2014). 
https://doi.org/10.1561/2600000002](port-hamiltonian-systems-theory-an-introductory-overview-journal) -- [10.1561/2600000002](https://doi.org/10.1561/2600000002)
- [van der Schaft, A., Maschke, B.: Hamiltonian formulation of distributed-parameter systems with boundary energy flow. J. Geom. Phys. 42(1–2), 166–194 (2002). 
https://doi.org/10.1016/S0393-0440(01)00083-3](hamiltonian-formulation-of-distributed-parameter-systems-with-boundary-energy-flow) -- [10.1016/S0393-0440(01)00083-3](https://doi.org/10.1016/S0393-0440(01)00083-3)
- [van der Schaft, A., Maschke, B.: Port-Hamiltonian systems on graphs. SIAM J. Control Optim. 51(2), 906–937 (2013). 
https://doi.org/10.1137/110840091](port-hamiltonian-systems-on-graphs) -- [10.1137/110840091](https://doi.org/10.1137/110840091)
- [van der Schaft, A., Maschke, B.: Generalized port-Hamiltonian DAE systems. Syst. Control Lett. 121, 31–37 (2018). 
https://doi.org/10.1016/j.sysconle.2018.09.008](generalized-port-hamiltonian-dae-systems) -- [10.1016/j.sysconle.2018.09.008](https://doi.org/10.1016/j.sysconle.2018.09.008)
- [van der Schaft, A., Maschke, B.: Geometry of thermodynamic processes. Entropy 20(12), 92523 (2018). 
https://doi.org/10.3390/e20120925](geometry-of-thermodynamic-processes) -- [10.3390/e20120925](https://doi.org/10.3390/e20120925)
- [Vu, N., Lefèvre, L., Maschke, B.: A structured control model for the thermo-magneto-hydrodynamics of plasmas in tokamaks. Math. Comput. Model. Dyn. Syst. 22(3), 181–206 (2016). 
https://doi.org/10.1080/13873954.2016.1154874](a-structured-control-model-for-the-thermo-magneto-hydrodynamics-of-plasmas-in-tokamaks) -- [10.1080/13873954.2016.1154874](https://doi.org/10.1080/13873954.2016.1154874)
- [Zhou, W., Hamroun, B., Couenne, F., Le Gorrec, Y.: Distributed port-Hamiltonian modelling for irreversible processes. Math. Comput. Model. Dyn. Syst. 23(1), 3–22 (2017). 
https://doi.org/10.1080/13873954.2016.1237970](distributed-port-hamiltonian-modelling-for-irreversible-processes) -- [10.1080/13873954.2016.1237970](https://doi.org/10.1080/13873954.2016.1237970)

