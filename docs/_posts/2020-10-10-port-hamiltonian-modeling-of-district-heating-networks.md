---
title: "Port-Hamiltonian Modeling of District Heating Networks"
date: 2020-10-10 00:00:00 +0100
permalink: port-hamiltonian-modeling-of-district-heating-networks
year: 2020
authors: Sarah-Alexa Hauschild, Nicole Marheineke, Volker Mehrmann, Jan Mohring, Arbi Moses Badlyan, Markus Rein, Martin Schmidt
category: chapters
tags:
  - Partial differential equations on networks
  - Port-Hamiltonian model framework
  - Energy-based formulation
  - District heating network
  - Thermodynamic fluid flow
  - Turbulent pipe flow
  - Euler-like equations
  - 93A30
  - 35Q31
  - 37D35
  - 76-XX
---
 
## Authors
[Sarah-Alexa Hauschild](authors/sarah-alexa-hauschild), [Nicole Marheineke](authors/nicole-marheineke), [Volker Mehrmann](authors/volker-mehrmann), [Jan Mohring](authors/jan-mohring), [Arbi Moses Badlyan](authors/arbi-moses-badlyan), [Markus Rein](authors/markus-rein), [Martin Schmidt](authors/martin-schmidt)
 
## Abstract
This paper provides a first contribution to port-Hamiltonian modeling of district heating networks. District heating network By introducing a model hierarchy of flow equations on the network, this work aims at a thermodynamically consistent port-Hamiltonian embedding of the partial differential-algebraic systems. We show that a spatially discretized network model describing the advection of the internal energy density with respect to an underlying incompressible stationary Euler-type hydrodynamics can be considered as a parameter-dependent finite-dimensional port-Hamiltonian system. Port-Hamiltonian system Moreover, we present an infinite-dimensional port-Hamiltonian formulation for a compressible instationary thermodynamic fluid flow Thermodynamic fluid flow in a pipe. Based on these first promising results, we raise open questions and point out research perspectives concerning structure-preserving discretization, model reduction, and optimization.
 
## Keywords
Partial differential equations on networks; Port-Hamiltonian model framework; Energy-based formulation; District heating network; Thermodynamic fluid flow; Turbulent pipe flow; Euler-like equations; 93A30; 35Q31; 37D35; 76-XX
 
## Citation
- **ISBN:** 9783030539047
- **Publisher:** Springer International Publishing
- **DOI:** [10.1007/978-3-030-53905-4_11](https://doi.org/10.1007/978-3-030-53905-4_11)
 
## BibTeX
{% highlight bibtex %}
{% raw %}
@inbook{Hauschild_2020,
  title={{Port-Hamiltonian Modeling of District Heating Networks}},
  ISBN={9783030539054},
  ISSN={2199-840X},
  DOI={10.1007/978-3-030-53905-4_11},
  booktitle={{Progress in Differential-Algebraic Equations II}},
  publisher={Springer International Publishing},
  author={Hauschild, Sarah-Alexa and Marheineke, Nicole and Mehrmann, Volker and Mohring, Jan and Badlyan, Arbi Moses and Rein, Markus and Schmidt, Martin},
  year={2020},
  pages={333--355}
}
{% endraw %}
{% endhighlight %}
 
[Download the bib file]({{ site.baseurl }}/assets/bib/port-hamiltonian-modeling-of-district-heating-networks.bib)
 
## References
- [Altmann, R. & Schulze, P. A port-Hamiltonian formulation of the Navier–Stokes equations for reactive flows. Systems &amp; Control Letters 100, 51–55 (2017)](a-port-hamiltonian-formulation-of-the-navier-stokes-equations-for-reactive-flows) -- [10.1016/j.sysconle.2016.12.005](https://doi.org/10.1016/j.sysconle.2016.12.005)
- Antoulas, A. C. Approximation of Large-Scale Dynamical Systems. (2005) doi:10.1137/1.9780898718713 -- [10.1137/1.9780898718713](https://doi.org/10.1137/1.9780898718713)
- [Beattie, C., Mehrmann, V., Xu, H. & Zwart, H. Linear port-Hamiltonian descriptor systems. Math. Control Signals Syst. 30, (2018)](linear-port-hamiltonian-descriptor-systems) -- [10.1007/s00498-018-0223-3](https://doi.org/10.1007/s00498-018-0223-3)
- Betsch, P. & Schiebl, M. Energy‐momentum‐entropy consistent numerical methods for large‐strain thermoelasticity relying on the GENERIC formalism. Numerical Meth Engineering 119, 1216–1244 (2019) -- [10.1002/nme.6089](https://doi.org/10.1002/nme.6089)
- [Chaturantabut, S., Beattie, C. & Gugercin, S. Structure-Preserving Model Reduction for Nonlinear Port-Hamiltonian Systems. SIAM J. Sci. Comput. 38, B837–B865 (2016)](structure-preserving-model-reduction-for-nonlinear-port-hamiltonian-systems) -- [10.1137/15m1055085](https://doi.org/10.1137/15m1055085)
- Clamond, D. Efficient Resolution of the Colebrook Equation. Ind. Eng. Chem. Res. 48, 3665–3671 (2009) -- [10.1021/ie801626g](https://doi.org/10.1021/ie801626g)
- [Dalsmo, M. & van der Schaft, A. On Representations and Integrability of Mathematical Structures in Energy-Conserving Physical Systems. SIAM J. Control Optim. 37, 54–91 (1998)](on-representations-and-integrability-of-mathematical-structures-in-energy-conserving-physical-systems) -- [10.1137/s0363012996312039](https://doi.org/10.1137/s0363012996312039)
- [Egger, H., Kugler, T., Liljegren-Sailer, B., Marheineke, N. & Mehrmann, V. On Structure-Preserving Model Reduction for Damped Wave Propagation in Transport Networks. SIAM J. Sci. Comput. 40, A331–A365 (2018)](on-structure-preserving-model-reduction-for-damped-wave-propagation-in-transport-networks) -- [10.1137/17m1125303](https://doi.org/10.1137/17m1125303)
- Feireisl, E. Relative entropies in thermodynamics of complete fluid systems. Discrete &amp; Continuous Dynamical Systems - A 32, 3059–3080 (2012) -- [10.3934/dcds.2012.32.3059](https://doi.org/10.3934/dcds.2012.32.3059)
- Geißler, B., Morsi, A., Schewe, L. & Schmidt, M. Solving power-constrained gas transportation problems using an MIP-based alternating direction method. Computers &amp; Chemical Engineering 82, 303–317 (2015) -- [10.1016/j.compchemeng.2015.07.005](https://doi.org/10.1016/j.compchemeng.2015.07.005)
- Geißler, B., Morsi, A., Schewe, L. & Schmidt, M. Solving Highly Detailed Gas Transport MINLPs: Block Separability and Penalty Alternating Direction Methods. INFORMS Journal on Computing 30, 309–323 (2018) -- [10.1287/ijoc.2017.0780](https://doi.org/10.1287/ijoc.2017.0780)
- Grmela, M. & Öttinger, H. C. Dynamics and thermodynamics of complex fluids.  I. Development of a general formalism. Phys. Rev. E 56, 6620–6632 (1997) -- [10.1103/physreve.56.6620](https://doi.org/10.1103/physreve.56.6620)
- Hante, FalkM. & Schmidt, M. Complementarity-based nonlinear programming techniques for optimal mixing in gas networks. EURO Journal on Computational Optimization 7, 299–323 (2019) -- [10.1007/s13675-019-00112-w](https://doi.org/10.1007/s13675-019-00112-w)
- [Jacob, B. & Zwart, H. J. Linear Port-Hamiltonian Systems on Infinite-Dimensional Spaces. (Springer Basel, 2012). doi:10.1007/978-3-0348-0399-1](linear-port-hamiltonian-systems-on-infinite-dimensional-spaces) -- [10.1007/978-3-0348-0399-1](https://doi.org/10.1007/978-3-0348-0399-1)
- [Kotyczka, P. & Lefèvre, L. Discrete-time port-Hamiltonian systems based on Gauss-Legendre collocation ⁎ ⁎P. Kotyczka received financial support as a part-time post-doctoral researcher (03/17–08/17) from the DFG-ANR funded project INFI-DHEM (no ANR-16-CE92-0028) and by a part-time visiting fellowship of Grenoble INP in summer term 2017. The work makes also part of the project KO 4750/1-1, funded by the German Research Foundation (DFG). IFAC-PapersOnLine 51, 125–130 (2018)](discrete-time-port-hamiltonian-systems-based-on-gauss-legendre-collocation) -- [10.1016/j.ifacol.2018.06.035](https://doi.org/10.1016/j.ifacol.2018.06.035)
- Kraus, M. & Hirvijoki, E. Metriplectic integrators for the Landau collision operator. Physics of Plasmas 24, (2017) -- [10.1063/1.4998610](https://doi.org/10.1063/1.4998610)
- Kraus, M., Kormann, K., Morrison, P. J. & Sonnendrücker, E. GEMPIC: geometric electromagnetic particle-in-cell methods. J. Plasma Phys. 83, (2017) -- [10.1017/s002237781700040x](https://doi.org/10.1017/s002237781700040x)
- [Le Gorrec, Y., Zwart, H. & Maschke, B. Dirac structures and Boundary Control Systems associated with Skew-Symmetric Differential Operators. SIAM J. Control Optim. 44, 1864–1892 (2005)](dirac-structures-and-boundary-control-systems-associated-with-skew-symmetric-differential-operators) -- [10.1137/040611677](https://doi.org/10.1137/040611677)
- LeVeque, R. J. Numerical Methods for Conservation Laws. (Birkhäuser Basel, 1992). doi:10.1007/978-3-0348-8629-1 -- [10.1007/978-3-0348-8629-1](https://doi.org/10.1007/978-3-0348-8629-1)
- [Liljegren-Sailer, B. & Marheineke, N. Structure‐preserving Galerkin approximation for a class of nonlinear port‐Hamiltonian partial differential equations on networks. Proc Appl Math and Mech 19, (2019)](structure-preserving-galerkin-approximation-for-a-class-of-nonlinear-port-hamiltonian-partial-differential-equations-on-networks) -- [10.1002/pamm.201900399](https://doi.org/10.1002/pamm.201900399)
- [Mehl, C., Mehrmann, V. & Wojtylak, M. Linear Algebra Properties of Dissipative Hamiltonian Descriptor Systems. SIAM J. Matrix Anal. &amp; Appl. 39, 1489–1519 (2018)](linear-algebra-properties-of-dissipative-hamiltonian-descriptor-systems) -- [10.1137/18m1164275](https://doi.org/10.1137/18m1164275)
- Mehrmann, V., Schmidt, M. & Stolwijk, J. J. Model and Discretization Error Adaptivity Within Stationary Gas Transport Optimization. Vietnam J. Math. 46, 779–801 (2018) -- [10.1007/s10013-018-0303-1](https://doi.org/10.1007/s10013-018-0303-1)
- Öttinger, H. C. Nonequilibrium thermodynamics for open systems. Phys. Rev. E 73, (2006) -- [10.1103/physreve.73.036126](https://doi.org/10.1103/physreve.73.036126)
- Öttinger, H. C. & Grmela, M. Dynamics and thermodynamics of complex fluids.  II. Illustrations of a general formalism. Phys. Rev. E 56, 6633–6655 (1997) -- [10.1103/physreve.56.6633](https://doi.org/10.1103/physreve.56.6633)
- [Polner, M. & van der Vegt, J. J. W. A Hamiltonian vorticity–dilatation formulation of the compressible Euler equations. Nonlinear Analysis: Theory, Methods &amp; Applications 109, 113–135 (2014)](a-hamiltonian-vorticity-dilatation-formulation-of-the-compressible-euler-equations) -- [10.1016/j.na.2014.07.005](https://doi.org/10.1016/j.na.2014.07.005)
- Grenzschicht-Theorie. (Springer-Verlag, 2006). doi:10.1007/3-540-32985-4 -- [10.1007/3-540-32985-4](https://doi.org/10.1007/3-540-32985-4)
- [Serhani, A., Haine, G. & Matignon, D. Anisotropic heterogeneous n-D heat equation with boundary control and observation: I. Modeling as port-Hamiltonian system. IFAC-PapersOnLine 52, 51–56 (2019)](anisotropic-heterogeneous-n-d-heat-equation-with-boundary-control-and-observation-i-modeling-as-port-hamiltonian-system) -- [10.1016/j.ifacol.2019.07.009](https://doi.org/10.1016/j.ifacol.2019.07.009)
- [Serhani, A., Haine, G. & Matignon, D. Anisotropic heterogeneous n-D heat equation with boundary control and observation: II. Structure-preserving discretization. IFAC-PapersOnLine 52, 57–62 (2019)](anisotropic-heterogeneous-n-d-heat-equation-with-boundary-control-and-observation-ii-structure-preserving-discretization) -- [10.1016/j.ifacol.2019.07.010](https://doi.org/10.1016/j.ifacol.2019.07.010)
- [Serhani, A., Matignon, D. & Haine, G. A Partitioned Finite Element Method for the Structure-Preserving Discretization of Damped Infinite-Dimensional Port-Hamiltonian Systems with Boundary Control. Lecture Notes in Computer Science 549–558 (2019) doi:10.1007/978-3-030-26980-7_57](a-partitioned-finite-element-method-for-the-structure-preserving-discretization-of-damped-infinite-dimensional-port-hamiltonian-systems-with-boundary-control) -- [10.1007/978-3-030-26980-7_57](https://doi.org/10.1007/978-3-030-26980-7_57)
- Transmission Pipeline Calculations and Simulations Manual. (2015) doi:10.1016/c2009-0-60912-0 -- [10.1016/c2009-0-60912-0](https://doi.org/10.1016/c2009-0-60912-0)
- [van der Schaft, A. J. Port-Hamiltonian Differential-Algebraic Systems. Surveys in Differential-Algebraic Equations I 173–226 (2013) doi:10.1007/978-3-642-34928-7_5](port-hamiltonian-differential-algebraic-systems) -- [10.1007/978-3-642-34928-7_5](https://doi.org/10.1007/978-3-642-34928-7_5)
- [van der Schaft, A. & Jeltsema, D. Port-Hamiltonian Systems Theory: An Introductory Overview. FnT in Systems and Control 1, 173–378 (2014)](port-hamiltonian-systems-theory-an-introductory-overview) -- [10.1561/2600000002](https://doi.org/10.1561/2600000002)
- [van der Schaft, A. J. & Maschke, B. M. Hamiltonian formulation of distributed-parameter systems with boundary energy flow. Journal of Geometry and Physics 42, 166–194 (2002)](hamiltonian-formulation-of-distributed-parameter-systems-with-boundary-energy-flow) -- [10.1016/s0393-0440(01)00083-3](https://doi.org/10.1016/s0393-0440(01)00083-3)
- [van der Schaft, A. J. & Maschke, B. M. Port-Hamiltonian Systems on Graphs. SIAM J. Control Optim. 51, 906–937 (2013)](port-hamiltonian-systems-on-graphs) -- [10.1137/110840091](https://doi.org/10.1137/110840091)
- [van der Schaft, A. & Maschke, B. Generalized port-Hamiltonian DAE systems. Systems &amp; Control Letters 121, 31–37 (2018)](generalized-port-hamiltonian-dae-systems) -- [10.1016/j.sysconle.2018.09.008](https://doi.org/10.1016/j.sysconle.2018.09.008)
- [Van der Schaft, A. & Maschke, B. Geometry of Thermodynamic Processes. Entropy 20, 925 (2018)](geometry-of-thermodynamic-processes) -- [10.3390/e20120925](https://doi.org/10.3390/e20120925)
- [Vu, N. M. T., Lefèvre, L. & Maschke, B. A structured control model for the thermo-magneto-hydrodynamics of plasmas in tokamaks. Mathematical and Computer Modelling of Dynamical Systems 22, 181–206 (2016)](a-structured-control-model-for-the-thermo-magneto-hydrodynamics-of-plasmas-in-tokamaks) -- [10.1080/13873954.2016.1154874](https://doi.org/10.1080/13873954.2016.1154874)
- [Zhou, W., Hamroun, B., Couenne, F. & Le Gorrec, Y. Distributed port-Hamiltonian modelling for irreversible processes. Mathematical and Computer Modelling of Dynamical Systems 23, 3–22 (2016)](distributed-port-hamiltonian-modelling-for-irreversible-processes) -- [10.1080/13873954.2016.1237970](https://doi.org/10.1080/13873954.2016.1237970)

