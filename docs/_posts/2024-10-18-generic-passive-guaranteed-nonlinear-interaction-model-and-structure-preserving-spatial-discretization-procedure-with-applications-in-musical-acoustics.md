---
layout: post
title: "Generic passive-guaranteed nonlinear interaction model and structure-preserving spatial discretization procedure with applications in musical acoustics"
date: 2024-10-18 00:00:00 +0100
permalink: generic-passive-guaranteed-nonlinear-interaction-model-and-structure-preserving-spatial-discretization-procedure-with-applications-in-musical-acoustics
year: 2025
authors: Antoine Falaize, David Roze
category: articles
tags:
  - Port Hamiltonian system
  - Order reduction
  - Friction
  - Collision
---
 
## Authors
[Antoine Falaize](authors/antoine-falaize), [David Roze](authors/david-roze)
 
## Abstract
In musical acoustics, the production of sound is usually described by the nonlinear interaction of the musician with a resonator (the instrument). For example a string (resonator) can be bowed or hit by a piano hammer (nonlinear interactions). The aim of this paper is to provide a stable (passive-guaranteed) simulation of such interaction systems. Our approach consists in first defining a generic passive-guaranteed structure for the interaction (finite dimensional) and for the resonator (infinite dimensional) and second constructing a generic procedure for the discretization of the resonator. This is achieved in the Port-Hamiltonian systems framework that decomposes a physical model into a network of energy-storing components, dissipative components and inputs-outputs, thus guaranteeing the passivity of the proposed models. Finally, a well established structure preserving time discretization method is used to provide numerical models which prove to fulfill a discrete power balance, hence the numerical stability. This generic procedure is applied to the sound synthesis of a bowed string and of a string hit by a piano hammer.
 
## Keywords
Port Hamiltonian system; Order reduction; Friction; Collision
 
## Citation
- **Journal:** Nonlinear Dynamics
- **Year:** 2025
- **Volume:** 113
- **Issue:** 4
- **Pages:** 3249--3275
- **Publisher:** Springer Science and Business Media LLC
- **DOI:** [10.1007/s11071-024-10438-9](https://doi.org/10.1007/s11071-024-10438-9)
 
## BibTeX
{% highlight bibtex %}
{% raw %}
@article{Falaize_2024,
  title={{Generic passive-guaranteed nonlinear interaction model and structure-preserving spatial discretization procedure with applications in musical acoustics}},
  volume={113},
  ISSN={1573-269X},
  DOI={10.1007/s11071-024-10438-9},
  number={4},
  journal={Nonlinear Dynamics},
  publisher={Springer Science and Business Media LLC},
  author={Falaize, Antoine and Roze, David},
  year={2024},
  pages={3249--3275}
}
{% endraw %}
{% endhighlight %}
 
## References
- Arnold, D.N.: Finite element exterior calculus. Soc. Ind. Appl. Math. (2018). https://doi.org/10.1137/1.9781611975543 -- [10.1137/1.9781611975543](https://doi.org/10.1137/1.9781611975543)
- Ayoub, R., Hamdouni, A., Razafindralandy, D.: A new hodge operator in discrete exterior calculus: application to fluid mechanics. Commun. Pure Appl. Anal. 20(6), 2155–2185 (2021). https://doi.org/10.3934/cpaa.2021062 -- [10.3934/cpaa.2021062](https://doi.org/10.3934/cpaa.2021062)
- Bensa, J., Bilbao, S., Kronland-Martinet, R., Smith III, J.O.: A power normalized non-linear lossy piano hammer. In: Proceedings of the stockholm music acoustics conference (SMAC03) (2003). URL https://www.speech.kth.se/music/smac03/programme.html
- Bensoam, J., Misdariis, N., Vergez, C., Causse, R.: Integral formalism and finite element method applied to sound synthesis by physical modeling. In: ICA : International congress of acoustics (2001)
- Bilbao, S.: Wave and scattering methods for numerical simulation. Wiley Online Library (2004). https://doi.org/10.1002/0470870192 -- [10.1002/0470870192](https://doi.org/10.1002/0470870192)
- Bilbao, S.: Numerical sound synthesis. Wiley Online. Library (2009). https://doi.org/10.1002/9780470749012 -- [10.1002/9780470749012](https://doi.org/10.1002/9780470749012)
- Bilbao, S., Torin, A., Chatziioannou, V.: Numerical modeling of collisions in musical instruments. Acta Acust. United Acust. 101(1), 155–173 (2015). https://doi.org/10.3813/aaa.918813 -- [10.3813/aaa.918813](https://doi.org/10.3813/aaa.918813)
- Boutillon, X.: Model for piano hammers: experimental determination and digital simulation. J. Acoust. Soc. Am. 83(2), 746–754 (1988). https://doi.org/10.1121/1.396117 -- [10.1121/1.396117](https://doi.org/10.1121/1.396117)
- [Cardoso-Ribeiro, F.L., Matignon, D., Lefèvre, L.: A structure-preserving partitioned finite element method for the 2d wave equation. In: IFAC-PapersOnLine, vol. 51, pp. 119–124. Elsevier (2018). https://doi.org/10.1016/j.ifacol.2018.06.033](a-structure-preserving-partitioned-finite-element-method-for-the-2d-wave-equation) -- [10.1016/j.ifacol.2018.06.033](https://doi.org/10.1016/j.ifacol.2018.06.033)
- Chabassier, J., Chaigne, A., Joly, P.: Modeling and simulation of a grand piano. J. Acoust. Soc. Am. 134(1), 648–665 (2013). https://doi.org/10.1121/1.4809649 -- [10.1121/1.4809649](https://doi.org/10.1121/1.4809649)
- Chaigne, A., Kergomard, J.: Acoustics of Musical Instruments. Springer, New York (2016). https://doi.org/10.1007/978-1-4939-3679-3 -- [10.1007/978-1-4939-3679-3](https://doi.org/10.1007/978-1-4939-3679-3)
- Chatziioannou, V., van Walstijn, M.: An energy conserving finite difference scheme for simulation of collisions. In: Proceedings of the stockholm music acoustics conference (SMAC13) (2013). URL https://www.kth.se/is/tmh/publications/archive-1.859266
- Chatziioannou, V., van Walstijn, M.: Energy conserving schemes for the simulation of musical instrument contact dynamics. J. Sound Vib. 339, 262–279 (2015). https://doi.org/10.1016/j.jsv.2014.11.017 -- [10.1016/j.jsv.2014.11.017](https://doi.org/10.1016/j.jsv.2014.11.017)
- Ciarlet, P.G.: The finite element method for elliptic problems. Soc. Ind. Appl. Math. (2002). https://doi.org/10.1137/1.9780898719208 -- [10.1137/1.9780898719208](https://doi.org/10.1137/1.9780898719208)
- Cohen, D., Hairer, E.: Linear energy-preserving integrators for poisson systems. BIT Numer. Math. 51(1), 91–101 (2011). https://doi.org/10.1007/s10543-011-0310-z -- [10.1007/s10543-011-0310-z](https://doi.org/10.1007/s10543-011-0310-z)
- Dahl, P.R.: Solid friction damping of mechanical vibrations. AIAA J. 14(12), 1675–1682 (1976). https://doi.org/10.2514/3.61511 -- [10.2514/3.61511](https://doi.org/10.2514/3.61511)
- De Wit, C.C., Olsson, H., Astrom, K.J., Lischinsky, P.: A new model for control of systems with friction. IEEE Trans. Autom. Control 40(3), 419–425 (1995). https://doi.org/10.1109/9.376053 -- [10.1109/9.376053](https://doi.org/10.1109/9.376053)
- Desvages, C.: Physical modelling of the bowed string and applications to sound synthesis. Ph.D. thesis, University of Edinburgh (2018)
- Desvages, C., Bilbao, S.: Two-polarisation physical model of bowed strings with nonlinear contact and friction forces, and application to gesture-based sound synthesis. Appl. Sci. (2016). https://doi.org/10.3390/app6050135 -- [10.3390/app6050135](https://doi.org/10.3390/app6050135)
- Ducceschi, M., Bilbao, S.: Non-iterative simulation methods for virtual analog modelling. IEEE/ACM Trans. Audio Speech Lang. Process. 30, 3189–3198 (2022). https://doi.org/10.1109/TASLP.2022.3209934 -- [10.1109/TASLP.2022.3209934](https://doi.org/10.1109/TASLP.2022.3209934)
- Ducceschi, M., Bilbao, S., Desvages, C.: Modelling collisions of nonlinear strings against rigid barriers: conservative finite difference schemes with application to sound synthesis. In: Proceedings of the 22nd international congress on acoustics (2016)
- Ducceschi, M., Bilbao, S., Willemsen, S., Serafin, S.: Linearly-implicit schemes for collisions in musical acoustics based on energy quadratisation. J. Acoust. Soc. Am. 149(5), 3502–3516 (2021). https://doi.org/10.1121/10.0005008 -- [10.1121/10.0005008](https://doi.org/10.1121/10.0005008)
- [Duindam, V., Macchelli, A., Stramigioli, S., Bruyninckx, H.: Modeling and Control of Complex Physical Systems: The Port-Hamiltonian Approach. Springer (2009). https://doi.org/10.1007/978-3-642-03196-0](modeling-and-control-of-complex-physical-systems) -- [10.1007/978-3-642-03196-0](https://doi.org/10.1007/978-3-642-03196-0)
- Dupont, P., Hayward, V., Armstrong, B., Altpeter, F.: Single state elastoplastic friction models. IEEE Trans. Autom. Control 47(5), 787–792 (2002). https://doi.org/10.1109/TAC.2002.1000274 -- [10.1109/TAC.2002.1000274](https://doi.org/10.1109/TAC.2002.1000274)
- [Falaize, A., Hélie, T.: Passive guaranteed simulation of analog audio circuits: a port-hamiltonian approach. Appl. Sci. (2016). https://doi.org/10.3390/app6100273](passive-guaranteed-simulation-of-analog-audio-circuits-a-port-hamiltonian-approach) -- [10.3390/app6100273](https://doi.org/10.3390/app6100273)
- [Falaize, A., Hélie, T.: Passive simulation of the nonlinear port-hamiltonian modeling of a rhodes piano. J. Sound Vib. 390, 289–309 (2017). https://doi.org/10.1016/j.jsv.2016.11.008](passive-simulation-of-the-nonlinear-port-hamiltonian-modeling-of-a-rhodes-piano) -- [10.1016/j.jsv.2016.11.008](https://doi.org/10.1016/j.jsv.2016.11.008)
- Ghosh, M.: Experimental study of the duration of contat of an elastic hammer striking a damped pianoforte string (1932)
- Giordano, N., Winans, J.: Piano hammers and their force compression characteristics: does a power law make sense? J. Acoust. Soc. Am. 107(4), 2248–2255 (2000). https://doi.org/10.1121/1.428505 -- [10.1121/1.428505](https://doi.org/10.1121/1.428505)
- Gong, Y., Wang, Q., Wang, Z.: Structure-preserving galerkin pod reduced-order modeling of hamiltonian systems. Comput. Methods Appl. Mech. and Eng. 315, 780–798 (2017). https://doi.org/10.1016/j.cma.2016.11.016 -- [10.1016/j.cma.2016.11.016](https://doi.org/10.1016/j.cma.2016.11.016)
- Gonzalez, O., Simo, J.C.: On the stability of symplectic and energy-momentum algorithms for non-linear hamiltonian systems with symmetry. Comput. Methods Appl. Mech. and Eng. 134(3–4), 197–222 (1996). https://doi.org/10.1016/0045-7825(96)01009-2 -- [10.1016/0045-7825(96)01009-2](https://doi.org/10.1016/0045-7825(96)01009-2)
- Hairer, E., Hochbruck, M., Iserles, A., Lubich, C.: Geometric Numerical Integration, 2nd edn Springer-Verlag (2010). https://doi.org/10.1007/3-540-30666-8 -- [10.1007/3-540-30666-8](https://doi.org/10.1007/3-540-30666-8)
- Ishikawa, A., Michels, D.L., Yaguchi, T.: Geometric-integration tools for the simulation of musical sounds. Jpn. J. Ind. Appl. Math. 35, 511–540 (2018). https://doi.org/10.1007/s13160-017-0292-6 -- [10.1007/s13160-017-0292-6](https://doi.org/10.1007/s13160-017-0292-6)
- Issanchou, C.: Vibrations non linéaires de cordes avec contact unilatéral. application aux instruments de musique. Ph.D. thesis, Université Pierre et Marie Curie—Paris VI (2017). URL https://theses.hal.science/tel-01631495
- Issanchou, C., Bilbao, S., Le Carrou, J.L., Touzé, C., Doaré, O.: A modal-based approach to the nonlinear vibration of strings against a unilateral obstacle: simulations and experiments in the pointwise case. J. Sound Vib. 393, 229–251 (2017). https://doi.org/10.1016/j.jsv.2016.12.025 -- [10.1016/j.jsv.2016.12.025](https://doi.org/10.1016/j.jsv.2016.12.025)
- Itoh, T., Abe, K.: Hamiltonian-conserving discrete canonical equations based on variational difference quotients. J. Comput. Phys. 76(1), 85–102 (1988). https://doi.org/10.1016/0021-9991(88)90132-5 -- [10.1016/0021-9991(88)90132-5](https://doi.org/10.1016/0021-9991(88)90132-5)
- [Jacob, B., Zwart, H.J.: Linear Port-Hamiltonian Systems on Infinite-dimensional Spaces. Springer Basel (2012). https://doi.org/10.1007/978-3-0348-0399-1](linear-port-hamiltonian-systems-on-infinite-dimensional-spaces) -- [10.1007/978-3-0348-0399-1](https://doi.org/10.1007/978-3-0348-0399-1)
- Kaselouris, E., Bakarezos, M., Tatarakis, M., Papadogiannis, N.A., Dimitriou, V.: A review of finite element studies in string musical instruments. Acoust. 4(1), 183–202 (2022). https://doi.org/10.3390/acoustics4010012 -- [10.3390/acoustics4010012](https://doi.org/10.3390/acoustics4010012)
- [Kotyczka, P., Maschke, B., Lefèvre, L.: Weak form of stokes-dirac structures and geometric discretization of port-hamiltonian systems. J. Comput. Phys. 361, 442–476 (2018). https://doi.org/10.1016/j.jcp.2018.02.006](weak-form-of-stokes-dirac-structures-and-geometric-discretization-of-port-hamiltonian-systems) -- [10.1016/j.jcp.2018.02.006](https://doi.org/10.1016/j.jcp.2018.02.006)
- Leimkuhler, B., Reich, S.: Simulating hamiltonian dynamics. 14. Cambridge university press (2004). https://doi.org/10.1017/CBO9780511614118 -- [10.1017/CBO9780511614118](https://doi.org/10.1017/CBO9780511614118)
- Marx, D., Bailliet, H., Valière, J.C.: Analysis of the acoustic flow at an abrupt change in section of an acoustic waveguide using particle image velocimetry and proper orthogonal decomposition. Acta Acust. United Acust. 94(1), 54–65 (2008). https://doi.org/10.3813/AAA.918008 -- [10.3813/AAA.918008](https://doi.org/10.3813/AAA.918008)
- Maschke, B., van der Schaft, A., Breedveld, P.C.: An intrinsic hamiltonian formulation of network dynamics: non-standard poisson structures and gyrators. J. Franklin Inst. 329(5), 923–966 (1992). https://doi.org/10.1016/S0016-0032(92)90049-M -- [10.1016/S0016-0032(92)90049-M](https://doi.org/10.1016/S0016-0032(92)90049-M)
- McIntyre, M.E., Woodhouse, J.: On the fundamentals of bowed-string dynamics. Acta Acust. United Acust. 43(2), 93–108 (1979)
- McLachlan, R.I., Perlmutter, M., Quispel, G.: On the nonlinear stability of symplectic integrators. BIT Numer. Math. 44, 99–117 (2004). https://doi.org/10.1023/B:BITN.0000025088.13092.7f -- [10.1023/B:BITN.0000025088.13092.7f](https://doi.org/10.1023/B:BITN.0000025088.13092.7f)
- Morrison, J.D., Adrien, J.M.: MOSAIC: a framework for modal synthesis. Comput. Music. J. 17(1), 45–56 (1993). https://doi.org/10.2307/3680569 -- [10.2307/3680569](https://doi.org/10.2307/3680569)
- Onofrei, M.G., Willemsen, S., Serafin, S.: Real-time implementation of a friction drum inspired instrument using finite difference schemes. In: 24th International conference on digital audio effects (2021) -- [10.23919/DAFx51585.2021.9768291](https://doi.org/10.23919/DAFx51585.2021.9768291)
- Raibaud, M.: Modélisation et simulation de systèmes discrétisés par la méthode des éléments finis dans le formalisme des systèmes hamiltoniens à ports : application à la synthèse sonore. Master’s thesis, Sorbonne Université (2018)
- Rath, M., Rocchesso, D., Avanzini, F.: Physically based real-time modeling of contact sounds. In: Proceedings international computer music conference (2002). URL http://hdl.handle.net/2027/spo.bbp2372.2002.046
- Rhaouti, L., Chaigne, A., Joly, P.: Time-domain modeling and numerical simulation of a kettledrum. J. Acoust. Soc. Am. 105(6), 3545–3562 (1999). https://doi.org/10.1121/1.424679 -- [10.1121/1.424679](https://doi.org/10.1121/1.424679)
- Rodet, X., Vergez, C.: Nonlinear dynamics in physical models: From basic models to true musical-instrument models. Comput. Music J. 23(3), 35–49 (1999) -- [10.1162/014892699559878](https://doi.org/10.1162/014892699559878)
- Russo, R., Ducceschi, M., Bilbao, S.: Efficient simulation of the bowed string in modal form. In: Proceedings of the 25th international conference on digital audio effects (DAFx20in2022) (2022)
- Salisbury, K., Conti, F., Barbagli, F.: Haptic rendering: introductory concepts. IEEE Comput. Graph. Appl. 24(2), 24–32 (2004). https://doi.org/10.1109/MCG.2004.1274058 -- [10.1109/MCG.2004.1274058](https://doi.org/10.1109/MCG.2004.1274058)
- Sato, S., Miyatake, Y., Butcher, J.C.: High-order linearly implicit schemes conserving quadratic invariants. Appl. Numer. Math. 187, 71–88 (2023). https://doi.org/10.1016/j.apnum.2023.02.005 -- [10.1016/j.apnum.2023.02.005](https://doi.org/10.1016/j.apnum.2023.02.005)
- [van der Schaft, A.: Port-hamiltonian systems: an introductory survey. In: Proc. of the Int. Congr. of Math., vol. 3, pp. 1339–1365 (2006)](port-hamiltonian-systems-an-introductory-survey) -- [10.4171/022-3/65](https://doi.org/10.4171/022-3/65)
- [van der Schaft, A., Maschke, B.: Hamiltonian formulation of distributed-parameter systems with boundary energy flow. J. Geom. Phys. 42(1), 166–194 (2002). https://doi.org/10.1016/S0393-0440(01)00083-3](hamiltonian-formulation-of-distributed-parameter-systems-with-boundary-energy-flow) -- [10.1016/S0393-0440(01)00083-3](https://doi.org/10.1016/S0393-0440(01)00083-3)
- Serafin, S., Avanzini, F., Rocchesso, D.: Bowed string simulation using an elasto-plastic friction model. In: Proceedings of the Stockholm music acoustics conference (2003). URL https://hdl.handle.net/2434/656637
- Slotine, J.J.E., Li, W.: Applied Nonlinear Control, vol. 199. Prentice-hall Englewood Cliffs, NJ (1991)
- Souriau, J.M.: Structure of Dynamical Systems: A Symplectic View of Physics, vol. 149. Springer (1997)
- Stulov, A.: Hysteretic model of the grand piano hammer felt. J. Acoust. Soc. Am. 97(4), 2577–2585 (1995). https://doi.org/10.1121/1.411912 -- [10.1121/1.411912](https://doi.org/10.1121/1.411912)
- Stulov, A.: Experimental and theoretical studies of piano hammer. In: Proceedings of the Stockholm music acoustics conference, vol. 485 (2003). URL https://www.speech.kth.se/music/smac03/programme.html
- Torin, A.: Percussion instrument modelling in 3d: sound synthesis through time domain numerical simulation. Ph.D. thesis, University of Edinburgh (2015)
- [Trenchant, V., Ramirez, H., Le Gorrec, Y., Kotyczka, P.: Finite differences on staggered grids preserving the port-hamiltonian structure with application to an acoustic duct. J. Comput. Phys. 373, 673–697 (2018). https://doi.org/10.1016/j.jcp.2018.06.051](finite-differences-on-staggered-grids-preserving-the-port-hamiltonian-structure-with-application-to-an-acoustic-duct) -- [10.1016/j.jcp.2018.06.051](https://doi.org/10.1016/j.jcp.2018.06.051)
- Välimäki, V., Pakarinen, J., Erkut, C., Karjalainen, M.: Discrete-time modelling of musical instruments. Reports Prog. Phys. 69(1), 1–78 (2005). https://doi.org/10.1088/0034-4885/69/1/R01 -- [10.1088/0034-4885/69/1/R01](https://doi.org/10.1088/0034-4885/69/1/R01)
- Willemsen, S., Bilbao, S., Serafin, S.: Real-time implementation of an elasto-plastic friction model applied to stiff strings using finite-difference schemes. In: 22nd Int. conference on digital audio effects (2019)

