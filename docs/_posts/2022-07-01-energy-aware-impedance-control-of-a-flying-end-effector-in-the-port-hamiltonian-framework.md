---
title: "Energy Aware Impedance Control of a Flying End-Effector in the Port-Hamiltonian Framework"
date: 2022-07-01 00:00:00 +0100
permalink: energy-aware-impedance-control-of-a-flying-end-effector-in-the-port-hamiltonian-framework
year: 2022
authors: Ramy Rashad, Davide Bicego, Jelle Zult, Santiago Sanchez-Escalonilla, Ran Jiao, Antonio Franchi, Stefano Stramigioli
category: articles
---
 
## Authors
[Ramy Rashad](authors/ramy-rashad), [Davide Bicego](authors/davide-bicego), [Jelle Zult](authors/jelle-zult), [Santiago Sanchez-Escalonilla](authors/santiago-sanchez-escalonilla), [Ran Jiao](authors/ran-jiao), [Antonio Franchi](authors/antonio-franchi), [Stefano Stramigioli](authors/stefano-stramigioli)
 
## Abstract
This work addresses the interaction control problem of a fully actuated aerial vehicle considered as a flying end-effector. We tackle the problem using geometrically consistent variable-stiffness impedance control for safe wrench regulation using the concept of energy tanks, where both the modeling and the control are carried out in the port Hamiltonian framework. We exploit previous well-known results in the literature of ground manipulators and extend them to be applied for novel and challenging aerial physical interaction with a focus on quasi-static applications. The energy-awareness of the presented control method guarantees the stability of the aerial robot in both free-flight and in-contact scenarios together with a level of safety in the case of contact-loss with the unknown environment. Furthermore, by utilizing bond graphs we demonstrate how the closed-loop passivity can be graphically conducted. The validity of our proposed approach is shown via several experiments. We also provide several insights on how the proposed framework could be extended to a generic dynamic aerial physical interaction.
 
## Citation
- **Journal:** IEEE Transactions on Robotics
- **Year:** 2022
- **Volume:** 38
- **Issue:** 6
- **Pages:** 3936--3955
- **Publisher:** Institute of Electrical and Electronics Engineers (IEEE)
- **DOI:** [10.1109/tro.2022.3183532](https://doi.org/10.1109/tro.2022.3183532)
 
## BibTeX
{% highlight bibtex %}
{% raw %}
@article{Rashad_2022,
  title={{Energy Aware Impedance Control of a Flying End-Effector in the Port-Hamiltonian Framework}},
  volume={38},
  ISSN={1941-0468},
  DOI={10.1109/tro.2022.3183532},
  number={6},
  journal={IEEE Transactions on Robotics},
  publisher={Institute of Electrical and Electronics Engineers (IEEE)},
  author={Rashad, Ramy and Bicego, Davide and Zult, Jelle and Sanchez-Escalonilla, Santiago and Jiao, Ran and Franchi, Antonio and Stramigioli, Stefano},
  year={2022},
  pages={3936--3955}
}
{% endraw %}
{% endhighlight %}
 
[Download the bib file]({{ site.baseurl }}/assets/bib/energy-aware-impedance-control-of-a-flying-end-effector-in-the-port-hamiltonian-framework.bib)
 
## References
- van der Schaft, A. L2 - Gain and Passivity Techniques in Nonlinear Control. Communications and Control Engineering (Springer London, 2000). doi:10.1007/978-1-4471-0507-7 -- [10.1007/978-1-4471-0507-7](https://doi.org/10.1007/978-1-4471-0507-7)
- rashad, Energy-based modeling and control of interactive aerial robots: A geometric port-Hamiltonian approach. (2021)
- [Acosta, J. A., Sanchez, M. I. & Ollero, A. Robust control of underactuated Aerial Manipulators via IDA-PBC. 53rd IEEE Conference on Decision and Control 673–678 (2014) doi:10.1109/cdc.2014.7039459](robust-control-of-underactuated-aerial-manipulators-via-ida-pbc) -- [10.1109/cdc.2014.7039459](https://doi.org/10.1109/cdc.2014.7039459)
- [Mersha, A. Y., Carloni, R. & Stramigioli, S. Port-based modeling and control of underactuated aerial vehicles. 2011 IEEE International Conference on Robotics and Automation 14–19 (2011) doi:10.1109/icra.2011.5980053](port-based-modeling-and-control-of-underactuated-aerial-vehicles) -- [10.1109/icra.2011.5980053](https://doi.org/10.1109/icra.2011.5980053)
- Bullo, F. & Murray, R. M. Tracking for fully actuated mechanical systems: a geometric framework. Automatica vol. 35 17–34 (1999) -- [10.1016/s0005-1098(98)00119-8](https://doi.org/10.1016/s0005-1098(98)00119-8)
- Lee, T., Leok, M. & McClamroch, N. H. Geometric tracking control of a quadrotor UAV on SE(3). 49th IEEE Conference on Decision and Control (CDC) 5420–5425 (2010) doi:10.1109/cdc.2010.5717652 -- [10.1109/cdc.2010.5717652](https://doi.org/10.1109/cdc.2010.5717652)
- Holm, D. D. Geometric Mechanics. (IMPERIAL COLLEGE PRESS, 2008). doi:10.1142/p549 -- [10.1142/p549](https://doi.org/10.1142/p549)
- murray, A Mathematical Introduction to Robotic Manipulation (1994)
- Hong, Y. et al. A geometric formulation of multirotor aerial vehicle dynamics. Nonlinear Dynamics vol. 107 495–513 (2021) -- [10.1007/s11071-021-07042-6](https://doi.org/10.1007/s11071-021-07042-6)
- Acosta, J. A., de Cos, C. R. & Ollero, A. A robust decentralised strategy for multi-task control of unmanned aerial systems. Application on underactuated aerial manipulator. 2016 International Conference on Unmanned Aircraft Systems (ICUAS) 1075–1084 (2016) doi:10.1109/icuas.2016.7502675 -- [10.1109/icuas.2016.7502675](https://doi.org/10.1109/icuas.2016.7502675)
- Villani, L. & De Schutter, J. Force Control. Springer Handbooks 195–220 (2016) doi:10.1007/978-3-319-32552-1_9 -- [10.1007/978-3-319-32552-1_9](https://doi.org/10.1007/978-3-319-32552-1_9)
- luca, Sensorless robot collision detection and hybrid force/motion control. Proc IEEE Int Conf Robot Automat (0)
- Fasse, E. D. & Broenink, J. F. A spatial impedance controller for robotic manipulation. IEEE Transactions on Robotics and Automation vol. 13 546–556 (1997) -- [10.1109/70.611315](https://doi.org/10.1109/70.611315)
- Stramigioli, S. & Duindam, V. Variable spatial springs for robot control applications. Proceedings 2001 IEEE/RSJ International Conference on Intelligent Robots and Systems. Expanding the Societal Role of Robotics in the the Next Millennium (Cat. No.01CH37180) vol. 4 1906–1911 -- [10.1109/iros.2001.976352](https://doi.org/10.1109/iros.2001.976352)
- [Duindam, V. & Stramigioli, S. Port-Based Asymptotic Curve Tracking for Mechanical Systems. European Journal of Control vol. 10 411–420 (2004)](port-based-asymptotic-curve-tracking-for-mechanical-systems) -- [10.3166/ejc.10.411-420](https://doi.org/10.3166/ejc.10.411-420)
- [Cervera, J., van der Schaft, A. J. & Baños, A. Interconnection of port-Hamiltonian systems and composition of Dirac structures. Automatica vol. 43 212–225 (2007)](interconnection-of-port-hamiltonian-systems-and-composition-of-dirac-structures) -- [10.1016/j.automatica.2006.08.014](https://doi.org/10.1016/j.automatica.2006.08.014)
- Rashad, R., Goerres, J., Aarts, R., Engelen, J. B. C. & Stramigioli, S. Fully Actuated Multirotor UAVs: A Literature Review. IEEE Robotics &amp; Automation Magazine vol. 27 97–107 (2020) -- [10.1109/mra.2019.2955964](https://doi.org/10.1109/mra.2019.2955964)
- Fasse, E. D. On the Spatial Compliance of Robotic Manipulators. Journal of Dynamic Systems, Measurement, and Control vol. 119 839–844 (1997) -- [10.1115/1.2802402](https://doi.org/10.1115/1.2802402)
- [Rashad, R., Califano, F. & Stramigioli, S. Port-Hamiltonian Passivity-Based Control on SE(3) of a Fully Actuated UAV for Aerial Physical Interaction Near-Hovering. IEEE Robotics and Automation Letters vol. 4 4378–4385 (2019)](port-hamiltonian-passivity-based-control-on-se-3-of-a-fully-actuated-uav-for-aerial-physical-interaction-near-hovering) -- [10.1109/lra.2019.2932864](https://doi.org/10.1109/lra.2019.2932864)
- Schindlbeck, C. & Haddadin, S. Unified passivity-based Cartesian force/impedance control for rigid and flexible joint robots via task-energy tanks. 2015 IEEE International Conference on Robotics and Automation (ICRA) 440–447 (2015) doi:10.1109/icra.2015.7139036 -- [10.1109/icra.2015.7139036](https://doi.org/10.1109/icra.2015.7139036)
- Ferraguti, F., Secchi, C. & Fantuzzi, C. A tank-based approach to impedance control with variable stiffness. 2013 IEEE International Conference on Robotics and Automation 4948–4953 (2013) doi:10.1109/icra.2013.6631284 -- [10.1109/icra.2013.6631284](https://doi.org/10.1109/icra.2013.6631284)
- Mersha, A. Y., Stramigioli, S. & Carloni, R. Variable impedance control for aerial interaction. 2014 IEEE/RSJ International Conference on Intelligent Robots and Systems 3435–3440 (2014) doi:10.1109/iros.2014.6943041 -- [10.1109/iros.2014.6943041](https://doi.org/10.1109/iros.2014.6943041)
- Park, S. et al. ODAR: Aerial Manipulation Platform Enabling Omnidirectional Wrench Generation. IEEE/ASME Transactions on Mechatronics vol. 23 1907–1918 (2018) -- [10.1109/tmech.2018.2848255](https://doi.org/10.1109/tmech.2018.2848255)
- Nava, G., Sable, Q., Tognon, M., Pucci, D. & Franchi, A. Direct Force Feedback Control and Online Multi-Task Optimization for Aerial Manipulators. IEEE Robotics and Automation Letters vol. 5 331–338 (2020) -- [10.1109/lra.2019.2958473](https://doi.org/10.1109/lra.2019.2958473)
- Ollero, A. et al. The AEROARMS Project: Aerial Robots with Advanced Manipulation Capabilities for Inspection and Maintenance. IEEE Robotics &amp; Automation Magazine vol. 25 12–23 (2018) -- [10.1109/mra.2018.2852789](https://doi.org/10.1109/mra.2018.2852789)
- stramigioli, Modeling and IPC Control of Interactive Mechanical System - A Coordinate-free Approach (2001)
- Suarez, A., Heredia, G. & Ollero, A. Physical-Virtual Impedance Control in Ultralightweight and Compliant Dual-Arm Aerial Manipulators. IEEE Robotics and Automation Letters vol. 3 2553–2560 (2018) -- [10.1109/lra.2018.2809964](https://doi.org/10.1109/lra.2018.2809964)
- Stramigioli, S. Energy-Aware Robotics. Lecture Notes in Control and Information Sciences 37–50 (2015) doi:10.1007/978-3-319-20988-3_3 -- [10.1007/978-3-319-20988-3_3](https://doi.org/10.1007/978-3-319-20988-3_3)
- Hogan, N. Impedance Control: An Approach to Manipulation: Part II—Implementation. Journal of Dynamic Systems, Measurement, and Control vol. 107 8–16 (1985) -- [10.1115/1.3140713](https://doi.org/10.1115/1.3140713)
- Hogan, N. Impedance Control: An Approach to Manipulation: Part I—Theory. Journal of Dynamic Systems, Measurement, and Control vol. 107 1–7 (1985) -- [10.1115/1.3140702](https://doi.org/10.1115/1.3140702)
- Ruggiero, F., Lippiello, V. & Ollero, A. Aerial Manipulation: A Literature Review. IEEE Robotics and Automation Letters vol. 3 1957–1964 (2018) -- [10.1109/lra.2018.2808541](https://doi.org/10.1109/lra.2018.2808541)
- Hogan, N. Impedance Control: An Approach to Manipulation: Part II—Implementation. Journal of Dynamic Systems, Measurement, and Control vol. 107 8–16 (1985) -- [10.1115/1.3140713](https://doi.org/10.1115/1.3140713)
- Ryll, M. et al. 6D interaction control with aerial robots: The flying end-effector paradigm. The International Journal of Robotics Research vol. 38 1045–1062 (2019) -- [10.1177/0278364919856694](https://doi.org/10.1177/0278364919856694)
- zult, Achieving stable and safe physical interaction for a fully actuated aerial robot using energy tank-based interaction control. (2020)
- Ferraguti, F. et al. An Energy Tank-Based Interactive Control Architecture for Autonomous and Teleoperated Robotic Surgery. IEEE Transactions on Robotics vol. 31 1073–1088 (2015) -- [10.1109/tro.2015.2455791](https://doi.org/10.1109/tro.2015.2455791)
- Furrer, F., Burri, M., Achtelik, M. & Siegwart, R. RotorS—A Modular Gazebo MAV Simulator Framework. Studies in Computational Intelligence 595–625 (2016) doi:10.1007/978-3-319-26054-9_23 -- [10.1007/978-3-319-26054-9_23](https://doi.org/10.1007/978-3-319-26054-9_23)
- Dietrich, A. et al. Passive Hierarchical Impedance Control Via Energy Tanks. IEEE Robotics and Automation Letters vol. 2 522–529 (2017) -- [10.1109/lra.2016.2645504](https://doi.org/10.1109/lra.2016.2645504)
- Rashad, R., Bicego, D., Jiao, R., Sanchez-Escalonilla, S. & Stramigioli, S. Towards Vision-Based Impedance Control for the Contact Inspection of Unknown Generically-Shaped Surfaces with a Fully-Actuated UAV. 2020 IEEE/RSJ International Conference on Intelligent Robots and Systems (IROS) 1605–1612 (2020) doi:10.1109/iros45743.2020.9341203 -- [10.1109/iros45743.2020.9341203](https://doi.org/10.1109/iros45743.2020.9341203)
- [Rashad, R., Engelen, J. B. C. & Stramigioli, S. Energy Tank-Based Wrench/Impedance Control of a Fully-Actuated Hexarotor: A Geometric Port-Hamiltonian Approach. 2019 International Conference on Robotics and Automation (ICRA) 6418–6424 (2019) doi:10.1109/icra.2019.8793939](energy-tank-based-wrench-impedance-control-of-a-fully-actuated-hexarotor-a-geometric-port-hamiltonian-approach) -- [10.1109/icra.2019.8793939](https://doi.org/10.1109/icra.2019.8793939)
- Kyung-Soo Kim, Keun-Ho Rew & Soohyun Kim. Disturbance Observer for Estimating Higher Order Disturbances in Time Series Expansion. IEEE Transactions on Automatic Control vol. 55 1905–1911 (2010) -- [10.1109/tac.2010.2049522](https://doi.org/10.1109/tac.2010.2049522)
- Tadele, T. S., de Vries, T. J. A. & Stramigioli, S. Combining energy and power based safety metrics in controller design for domestic robots. 2014 IEEE International Conference on Robotics and Automation (ICRA) (2014) doi:10.1109/icra.2014.6907007 -- [10.1109/icra.2014.6907007](https://doi.org/10.1109/icra.2014.6907007)
- luca, Collision detection and safe reaction with the DLR-III lightweight manipulator ARM. Proc IEEE/RSJ Int Conf Intell Robots Syst (0)
- Raiola, G., Cardenas, C. A., Tadele, T. S., de Vries, T. & Stramigioli, S. Development of a Safety- and Energy-Aware Impedance Controller for Collaborative Robots. IEEE Robotics and Automation Letters vol. 3 1237–1244 (2018) -- [10.1109/lra.2018.2795639](https://doi.org/10.1109/lra.2018.2795639)
- 20Sim 4.7, Controllab Products B.V. (0)
- Orsag, M., Korpela, C., Bogdan, S. & Oh, P. Dexterous Aerial Robots—Mobile Manipulation Using Unmanned Aerial Systems. IEEE Transactions on Robotics vol. 33 1453–1466 (2017) -- [10.1109/tro.2017.2750693](https://doi.org/10.1109/tro.2017.2750693)
- Tomić, T., Lutz, P., Schmid, K., Mathers, A. & Haddadin, S. Simultaneous contact and aerodynamic force estimation (s-CAFE) for aerial robots. The International Journal of Robotics Research vol. 39 688–728 (2020) -- [10.1177/0278364920904788](https://doi.org/10.1177/0278364920904788)
- Shahriari, E., Johannsmeier, L. & Haddadin, S. Valve-based Virtual Energy Tanks: A Framework to Simultaneously Passify Controls and Embed Control Objectives. 2018 Annual American Control Conference (ACC) (2018) doi:10.23919/acc.2018.8431718 -- [10.23919/acc.2018.8431718](https://doi.org/10.23919/acc.2018.8431718)

