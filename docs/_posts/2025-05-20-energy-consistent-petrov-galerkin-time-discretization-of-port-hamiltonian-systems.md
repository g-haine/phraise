---
title: "Energy-consistent Petrov–Galerkin time discretization of port-Hamiltonian systems"
date: 2025-05-20 00:00:00 +0100
permalink: energy-consistent-petrov-galerkin-time-discretization-of-port-hamiltonian-systems
year: 2025
authors: Jan Giesselmann, Attila Karsai, Tabea Tscherpel
category: articles
---
 
## Authors
[Jan Giesselmann](authors/jan-giesselmann), [Attila Karsai](authors/attila-karsai), [Tabea Tscherpel](authors/tabea-tscherpel)
 
## Abstract
For a general class of nonlinear port-Hamiltonian systems we develop a high-order time discretization scheme with certain structure preservation properties. The finite or infinite-dimensional system under consideration possesses a Hamiltonian function, which represents an energy in the system and is conserved or dissipated along solutions. For infinite-dimensional systems this structure is preserved under suitable Galerkin discretization in space. The numerical scheme is energy-consistent in the sense that the Hamiltonian of the approximate solutions at time grid points behaves accordingly. This structure preservation property is achieved by specific design of a continuous Petrov–Galerkin (cPG) method in time. It coincides with standard cPG methods in special cases, in which the latter are energy-consistent. Examples of port-Hamiltonian ODEs and PDEs are presented to visualize the framework. In numerical experiments the energy consistency is verified and the convergence behavior is investigated.
 
## Citation
- **Journal:** The SMAI Journal of computational mathematics
- **Year:** 2025
- **Volume:** 11
- **Issue:** 
- **Pages:** 335--367
- **Publisher:** Cellule MathDoc/Centre Mersenne
- **DOI:** [10.5802/smai-jcm.127](https://doi.org/10.5802/smai-jcm.127)
 
## BibTeX
{% highlight bibtex %}
{% raw %}
@article{Giesselmann_2025,
  title={{Energy-consistent Petrov–Galerkin time discretization of port-Hamiltonian systems}},
  volume={11},
  ISSN={2426-8399},
  DOI={10.5802/smai-jcm.127},
  journal={The SMAI Journal of computational mathematics},
  publisher={Cellule MathDoc/Centre Mersenne},
  author={Giesselmann, Jan and Karsai, Attila and Tscherpel, Tabea},
  year={2025},
  pages={335--367}
}
{% endraw %}
{% endhighlight %}
 
[Download the bib file]({{ site.baseurl }}/assets/bib/energy-consistent-petrov-galerkin-time-discretization-of-port-hamiltonian-systems.bib)
 
## References
- Ahmed, N. & Matthies, G. Higher order continuous Galerkin−Petrov time stepping schemes for transient convection-diffusion-reaction equations. ESAIM: M2AN 49, 1429–1450 (2015) -- [10.1051/m2an/2015019](https://doi.org/10.1051/m2an/2015019)
- Altmann, R. & Herzog, R. Continuous Galerkin schemes for semiexplicit differential-algebraic equations. IMA Journal of Numerical Analysis 42, 2214–2237 (2021) -- [10.1093/imanum/drab037](https://doi.org/10.1093/imanum/drab037)
- Andrews, B. D., High-order conservative and accurately dissipative numerical integrators via auxiliary variables (2024)
- Aziz, A. K. & Monk, P. Continuous finite elements in space and time for the heat equation. Math. Comp. 52, 255–274 (1989) -- [10.2307/2008467](https://doi.org/10.2307/2008467)
- Bradbury, J., JAX: composable transformations of Python+NumPy programs. (2018)
- Celledoni, E., Eidnes, S., Owren, B. & Ringholm, T. Dissipative Numerical Schemes on Riemannian Manifolds with Applications to Gradient Flows. SIAM J. Sci. Comput. 40, A3789–A3806 (2018) -- [10.1137/18m1190628](https://doi.org/10.1137/18m1190628)
- Celledoni, E., Energy-Preserving and Passivity-Consistent Numerical Discretization of Port-Hamiltonian Systems (2017)
- [Celledoni, E. & Jackaman, J. Discrete conservation laws for finite element discretisations of multisymplectic PDEs. Journal of Computational Physics 444, 110520 (2021)](discrete-conservation-laws-for-finite-element-discretisations-of-multisymplectic-pdes) -- [10.1016/j.jcp.2021.110520](https://doi.org/10.1016/j.jcp.2021.110520)
- [Chaturantabut, S., Beattie, C. & Gugercin, S. Structure-Preserving Model Reduction for Nonlinear Port-Hamiltonian Systems. SIAM J. Sci. Comput. 38, B837–B865 (2016)](structure-preserving-model-reduction-for-nonlinear-port-hamiltonian-systems) -- [10.1137/15m1055085](https://doi.org/10.1137/15m1055085)
- Chrysafinos, K. & Walkington, N. Discontinuous Galerkin approximations of the Stokes and Navier-Stokes equations. Math. Comp. 79, 2135–2167 (2010) -- [10.1090/s0025-5718-10-02348-3](https://doi.org/10.1090/s0025-5718-10-02348-3)
- Cohen, D. & Hairer, E. Linear energy-preserving integrators for Poisson systems. Bit Numer Math 51, 91–101 (2011) -- [10.1007/s10543-011-0310-z](https://doi.org/10.1007/s10543-011-0310-z)
- Diening, L. & Růžička, M. Interpolation operators in Orlicz–Sobolev spaces. Numer. Math. 107, 107–129 (2007) -- [10.1007/s00211-007-0079-9](https://doi.org/10.1007/s00211-007-0079-9)
- [Egger, H., Giesselmann, J., Kunkel, T. & Philippi, N. An asymptotic-preserving discretization scheme for gas transport in pipe networks. IMA Journal of Numerical Analysis 43, 2137–2168 (2022)](an-asymptotic-preserving-discretization-scheme-for-gas-transport-in-pipe-networks) -- [10.1093/imanum/drac032](https://doi.org/10.1093/imanum/drac032)
- [Egger, H., Habrich, O. & Shashkov, V. On the Energy Stable Approximation of Hamiltonian and Gradient Systems. Computational Methods in Applied Mathematics 21, 335–349 (2020)](on-the-energy-stable-approximation-of-hamiltonian-and-gradient-systems) -- [10.1515/cmam-2020-0025](https://doi.org/10.1515/cmam-2020-0025)
- Eidnes, S. Order theory for discrete gradient methods. Bit Numer Math 62, 1207–1255 (2022) -- [10.1007/s10543-022-00909-z](https://doi.org/10.1007/s10543-022-00909-z)
- Ern, A. & Guermond, J.-L. Finite Elements III. Texts in Applied Mathematics (Springer International Publishing, 2021). doi:10.1007/978-3-030-57348-5 -- [10.1007/978-3-030-57348-5](https://doi.org/10.1007/978-3-030-57348-5)
- French, D. A. & Schaeffer, J. W. Continuous finite element methods which preserve energy properties for nonlinear problems. Applied Mathematics and Computation 39, 271–295 (1990) -- [10.1016/s0096-3003(20)80006-x](https://doi.org/10.1016/s0096-3003(20)80006-x)
- [Zhong, G. & Marsden, J. E. Lie-Poisson Hamilton-Jacobi theory and Lie-Poisson integrators. Physics Letters A 133, 134–139 (1988)](lie-poisson-hamilton-jacobi-theory-and-lie-poisson-integrators) -- [10.1016/0375-9601(88)90773-6](https://doi.org/10.1016/0375-9601(88)90773-6)
- Gess, B., Sauer, J. & Tadmor, E. Optimal regularity in time and space for the porous medium equation. Analysis &amp; PDE 13, 2441–2480 (2020) -- [10.2140/apde.2020.13.2441](https://doi.org/10.2140/apde.2020.13.2441)
- Girault, V. & Raviart, P.-A. Finite Element Methods for Navier-Stokes Equations. Springer Series in Computational Mathematics (Springer Berlin Heidelberg, 1986). doi:10.1007/978-3-642-61623-5 -- [10.1007/978-3-642-61623-5](https://doi.org/10.1007/978-3-642-61623-5)
- [Gonzalez, O. Time integration and discrete Hamiltonian systems. J Nonlinear Sci 6, 449–467 (1996)](time-integration-and-discrete-hamiltonian-systems) -- [10.1007/bf02440162](https://doi.org/10.1007/bf02440162)
- Grmela, M. & Öttinger, H. C. Dynamics and thermodynamics of complex fluids.  I. Development of a general formalism. Phys. Rev. E 56, 6620–6632 (1997) -- [10.1103/physreve.56.6620](https://doi.org/10.1103/physreve.56.6620)
- Groß, M., Betsch, P. & Steinmann, P. Conservation properties of a time FE method. Part IV: Higher order energy and momentum conserving schemes. Int. J. Numer. Meth. Engng 63, 1849–1897 (2005) -- [10.1002/nme.1339](https://doi.org/10.1002/nme.1339)
- Hairer, E., Energy-preserving variant of collocation methods. JNAIAM, J. Numer. Anal. Ind. Appl. Math. (2010)
- Hairer, E. & Lubich, C. Energy-diminishing integration of gradient systems. IMA Journal of Numerical Analysis 34, 452–461 (2013) -- [10.1093/imanum/drt031](https://doi.org/10.1093/imanum/drt031)
- Hairer, E., Geometric numerical integration. Structure-preserving algorithms for ordinary differential equations (2010)
- Jackaman, J. I. Finite element methods as geometric structure preserving algorithms. University of Reading (2019) doi:10.48683/1926.00097182 -- [10.48683/1926.00097182](https://doi.org/10.48683/1926.00097182)
- Jackaman, J. & Pryer, T. Conservative Galerkin methods for dispersive Hamiltonian problems. Calcolo 58, (2021) -- [10.1007/s10092-021-00423-8](https://doi.org/10.1007/s10092-021-00423-8)
- [Kotyczka, P. & Lefèvre, L. Discrete-time port-Hamiltonian systems: A definition based on symplectic integration. Systems &amp; Control Letters 133, 104530 (2019)](discrete-time-port-hamiltonian-systems-a-definition-based-on-symplectic-integration) -- [10.1016/j.sysconle.2019.104530](https://doi.org/10.1016/j.sysconle.2019.104530)
- McLachlan, R. I., Quispel, G. R. W. & Robidoux, N. Geometric integration using discrete gradients. Philosophical Transactions of the Royal Society of London. Series A: Mathematical, Physical and Engineering Sciences 357, 1021–1045 (1999) -- [10.1098/rsta.1999.0363](https://doi.org/10.1098/rsta.1999.0363)
- [Mehrmann, V. & Morandin, R. Structure-preserving discretization for port-Hamiltonian descriptor systems. 2019 IEEE 58th Conference on Decision and Control (CDC) 6863–6868 (2019) doi:10.1109/cdc40024.2019.9030180](structure-preserving-discretization-for-port-hamiltonian-descriptor-systems) -- [10.1109/cdc40024.2019.9030180](https://doi.org/10.1109/cdc40024.2019.9030180)
- [Mehrmann, V. & Unger, B. Control of port-Hamiltonian differential-algebraic systems and applications. Acta Numerica 32, 395–515 (2023)](control-of-port-hamiltonian-differential-algebraic-systems-and-applications) -- [10.1017/s0962492922000083](https://doi.org/10.1017/s0962492922000083)
- Morandin, R., Modeling and Numerical Treatment of Port-Hamiltonian Descriptor Systems (2024)
- Raviart, P. A. Sur la résolution de certaines equations paraboliques non linéaires. Journal of Functional Analysis 5, 299–328 (1970) -- [10.1016/0022-1236(70)90031-5](https://doi.org/10.1016/0022-1236(70)90031-5)
- [van der Schaft, A. L2-Gain and Passivity Techniques in Nonlinear Control. Communications and Control Engineering (Springer International Publishing, 2017). doi:10.1007/978-3-319-49992-5](l2-gain-and-passivity-techniques-in-nonlinear-control) -- [10.1007/978-3-319-49992-5](https://doi.org/10.1007/978-3-319-49992-5)
- [van der Schaft, A. & Jeltsema, D. Port-Hamiltonian Systems Theory: An Introductory Overview. FnT in Systems and Control 1, 173–378 (2014)](port-hamiltonian-systems-theory-an-introductory-overview) -- [10.1561/2600000002](https://doi.org/10.1561/2600000002)
- Schieweck, F. A-stable discontinuous Galerkin–Petrov time discretization of higher order. Journal of Numerical Mathematics 18, (2010) -- [10.1515/jnum.2010.002](https://doi.org/10.1515/jnum.2010.002)
- Schöbel-Kröhn, L., Analysis and Numerical Approximation of Nonlinear Evolution Equations on Network Structures (2020)
- Schulze, P., Structure-Preserving Time Discretization of Port-Hamiltonian Systems via Discrete Gradient Pairs (2023)
- Vázquez, J. L., The porous medium equation. Mathematical theory (2007)

