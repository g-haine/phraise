---
layout: post
title: "Port-Hamiltonian based control of water distribution networks"
date: 2022-11-16 00:00:00 +0100
permalink: port-hamiltonian-based-control-of-water-distribution-networks
year: 2022
authors: Richard Perryman, Joshua A. Taylor, Bryan Karney
category:
  - articles
tags:
  - port-hamiltonian systems
  - nonlinear systems
  - passivity
  - incremental models
---
 
## Authors
[Richard Perryman](authors/richard_perryman), [Joshua A. Taylor](authors/joshua_a_taylor), [Bryan Karney](authors/bryan_karney)
 
## Abstract
We design controllers for a nonlinear model of a water distribution network (WDN). Most existing approaches to the control of WDNs model the pumps as simple pressure gains. We show that a commonly used empirical model of a pump leads to a port-Hamiltonian (pH) and hence stable system. We use standard arguments to show that WDNs are incrementally pH, and show that local PI controllers preserve stability. These controllers are robust in that they do not require specific knowledge of the equilibrium input. We further show that controllers based on physical feedback that WDN operators usually rely on have merit in the pH framework. All of these controllers are shown to be useful in mitigating disturbances and tracking setpoints corresponding to assignable equilibria.
 
## Keywords
Port-Hamiltonian systems; Nonlinear systems; Passivity; Incremental models
 
## Citation
- **Journal:** Systems &amp; Control Letters
- **Year:** 2022
- **Volume:** 170
- **Issue:** 
- **Pages:** 105402
- **Publisher:** Elsevier BV
- **DOI:** [10.1016/j.sysconle.2022.105402](https://doi.org/10.1016/j.sysconle.2022.105402)
 
## BibTeX
{% highlight bibtex %}
{% raw %}
@article{Perryman_2022,
  title={{Port-Hamiltonian based control of water distribution networks}},
  volume={170},
  ISSN={0167-6911},
  DOI={10.1016/j.sysconle.2022.105402},
  journal={Systems &amp; Control Letters},
  publisher={Elsevier BV},
  author={Perryman, Richard and Taylor, Joshua A. and Karney, Bryan},
  year={2022},
  pages={105402}
}
{% endraw %}
{% endhighlight %}
 
## References
- [van der Schaft, A. & Jeltsema, D. Port-Hamiltonian Systems Theory: An Introductory Overview. Foundations and Trends® in Systems and Control vol. 1 173–378 (2014)](port-hamiltonian-systems-theory-an-introductory-overview-journal) -- [10.1561/2600000002](https://doi.org/10.1561/2600000002)
- Zeng, Y., Zhang, L., Guo, Y., Qian, J. & Zhang, C. The generalized Hamiltonian model for the shafting transient analysis of the hydro turbine generating sets. Nonlinear Dynamics vol. 76 1921–1933 (2014) -- [10.1007/s11071-014-1257-9](https://doi.org/10.1007/s11071-014-1257-9)
- [Cisneros, N., Rojas, A. J. & Ramirez, H. Port-Hamiltonian Modeling and Control of a Micro-Channel Experimental Plant. IEEE Access vol. 8 176935–176946 (2020)](port-hamiltonian-modeling-and-control-of-a-micro-channel-experimental-plant) -- [10.1109/ACCESS.2020.3026653](https://doi.org/10.1109/ACCESS.2020.3026653)
- De Persis, C. & Kallesøe, C. S. Proportional and Proportional-Integral Controllers for a Nonlinear Hydraulic Network. IFAC Proceedings Volumes vol. 41 319–324 (2008) -- [10.3182/20080706-5-KR-1001.00054](https://doi.org/10.3182/20080706-5-KR-1001.00054)
- De Persis, C. & Kallesoe, C. S. Pressure Regulation in Nonlinear Hydraulic Networks by Positive and Quantized Controls. IEEE Transactions on Control Systems Technology vol. 19 1371–1383 (2011) -- [10.1109/TCST.2010.2094619](https://doi.org/10.1109/TCST.2010.2094619)
- Jensen, T. N. & Wisniewski, R. Global practical stabilisation of large-scale hydraulic networks. IET Control Theory &amp; Applications vol. 5 1335–1342 (2011) -- [10.1049/iet-cta.2010.0360](https://doi.org/10.1049/iet-cta.2010.0360)
- Jensen, T. N. & Wisniewski, R. Global Asymptotic Stabilization of Large-Scale Hydraulic Networks Using Positive Proportional Controls. IEEE Transactions on Control Systems Technology vol. 22 2417–2423 (2014) -- [10.1109/TCST.2014.2306990](https://doi.org/10.1109/TCST.2014.2306990)
- De Persis, C., Jensen, T. N., Ortega, R. & Wisniewski, R. Output Regulation of Large-Scale Hydraulic Networks. IEEE Transactions on Control Systems Technology vol. 22 238–245 (2014) -- [10.1109/TCST.2012.2233477](https://doi.org/10.1109/TCST.2012.2233477)
- Nørgaard Jensen, T., Wisniewski, R., DePersis, C. & Skovmose Kallesøe, C. Output regulation of large-scale hydraulic networks with minimal steady state power consumption. Control Engineering Practice vol. 22 103–113 (2014) -- [10.1016/j.conengprac.2013.10.004](https://doi.org/10.1016/j.conengprac.2013.10.004)
- Scholten, T., Trip◊, S. & De Persis, C. Pressure Regulation in Large Scale Hydraulic Networks with Input Constraints. IFAC-PapersOnLine vol. 50 5367–5372 (2017) -- [10.1016/j.ifacol.2017.08.1068](https://doi.org/10.1016/j.ifacol.2017.08.1068)
- Nørgaard Jensen, T., Skovmose Kallesøe, C. & Wisniewski, R. Asymptotic set-point regulation for a large class of non-linear hydraulic networks. IFAC-PapersOnLine vol. 50 5355–5360 (2017) -- [10.1016/j.ifacol.2017.08.937](https://doi.org/10.1016/j.ifacol.2017.08.937)
- Machado, J. E., Cucuzzella, M., Pronk, N. & Scherpen, J. M. A. Adaptive Control for Flow and Volume Regulation in Multi-Producer District Heating Systems. IEEE Control Systems Letters vol. 6 794–799 (2022) -- [10.1109/LCSYS.2021.3085702](https://doi.org/10.1109/LCSYS.2021.3085702)
- Tahavori, M., Leth, J., Kallesøe, C. & Wisniewski, R. Optimal control of nonlinear hydraulic networks in the presence of disturbance. Nonlinear Dynamics vol. 75 539–548 (2013) -- [10.1007/s11071-013-1083-5](https://doi.org/10.1007/s11071-013-1083-5)
- Fooladivanda, D. & Taylor, J. A. Energy-Optimal Pump Scheduling and Water Flow. IEEE Transactions on Control of Network Systems vol. 5 1016–1026 (2018) -- [10.1109/TCNS.2017.2670501](https://doi.org/10.1109/TCNS.2017.2670501)
- Jayawardhana, B., Ortega, R., García-Canseco, E. & Castaños, F. Passivity of nonlinear incremental systems: Application to PI stabilization of nonlinear RLC circuits. Systems &amp; Control Letters vol. 56 618–622 (2007) -- [10.1016/j.sysconle.2007.03.011](https://doi.org/10.1016/j.sysconle.2007.03.011)
- Nault, J. D. & Karney, B. W. Improved Rigid Water Column Formulation for Simulating Slow Transients and Controlled Operations. Journal of Hydraulic Engineering vol. 142 (2016) -- [10.1061/(ASCE)HY.1943-7900.0001145](https://doi.org/10.1061/(ASCE)HY.1943-7900.0001145)
- Simpson, A. R. & Marchi, A. Evaluating the Approximation of the Affinity Laws and Improving the Efficiency Estimate for Variable Speed Pumps. Journal of Hydraulic Engineering vol. 139 1314–1317 (2013) -- [10.1061/(ASCE)HY.1943-7900.0000776](https://doi.org/10.1061/(ASCE)HY.1943-7900.0000776)
- Zhou, D. & Sachdeva, R. Simple model of electric submersible pump in gassy well. Journal of Petroleum Science and Engineering vol. 70 204–213 (2010) -- [10.1016/j.petrol.2009.11.012](https://doi.org/10.1016/j.petrol.2009.11.012)
- van der Schaft, A. Classical Thermodynamics Revisited: A Systems and Control Perspective. IEEE Control Systems vol. 41 32–60 (2021) -- [10.1109/MCS.2021.3092809](https://doi.org/10.1109/MCS.2021.3092809)
- Hill, D. J. & Moylan, P. J. Dissipative Dynamical Systems: Basic Input-Output and State Properties. Journal of the Franklin Institute vol. 309 327–357 (1980) -- [10.1016/0016-0032(80)90026-5](https://doi.org/10.1016/0016-0032(80)90026-5)
- [Monshizadeh, N., Monshizadeh, P., Ortega, R. & van der Schaft, A. Conditions on shifted passivity of port-Hamiltonian systems. Systems &amp; Control Letters vol. 123 55–61 (2019)](conditions-on-shifted-passivity-of-port-hamiltonian-systems) -- [10.1016/j.sysconle.2018.10.010](https://doi.org/10.1016/j.sysconle.2018.10.010)
- [Zonetti, D., Ortega, R. & Benchaib, A. Modeling and control of HVDC transmission systems from theory to practice and back. Control Engineering Practice vol. 45 133–146 (2015)](modeling-and-control-of-hvdc-transmission-systems-from-theory-to-practice-and-back) -- [10.1016/j.conengprac.2015.09.012](https://doi.org/10.1016/j.conengprac.2015.09.012)
- Harris, C. R. et al. Array programming with NumPy. Nature vol. 585 357–362 (2020) -- [10.1038/s41586-020-2649-2](https://doi.org/10.1038/s41586-020-2649-2)
- Virtanen, P. et al. SciPy 1.0: fundamental algorithms for scientific computing in Python. Nature Methods vol. 17 261–272 (2020) -- [10.1038/s41592-019-0686-2](https://doi.org/10.1038/s41592-019-0686-2)
- Hunter, J. D. Matplotlib: A 2D Graphics Environment. Computing in Science &amp; Engineering vol. 9 90–95 (2007) -- [10.1109/MCSE.2007.55](https://doi.org/10.1109/MCSE.2007.55)

