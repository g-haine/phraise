---
title: "Passivity-Based Control of Grid Forming and Grid Following Converters in Microgrids"
date: 2023-09-25 00:00:00 +0100
permalink: passivity-based-control-of-grid-forming-and-grid-following-converters-in-microgrids
year: 2023
authors: Yonghao Gui, Yaosuo Xue
category: proceedings
---
 
## Authors
[Yonghao Gui](authors/yonghao-gui), [Yaosuo Xue](authors/yaosuo-xue)
 
## Abstract
With the integration of more and more power electronics devices into the grid, it is not easy to guarantee the stability of the whole system due to the complexity of the control structure of various power converters. In this paper, we consider grid-forming and grid-following converters in one microgrid, in which the grid-forming converters support the voltage and frequency of the microgrid and the grid-following converters inject their maximum power into the microgrid. To handle the stability issue, the passivity principle is applied to guarantee the stability of the whole microgrid. We ensure every grid-following converter satisfies the passivity via the port-controlled Hamiltonian method. In addition, we apply the passivity-based proportional-resonant controller to the grid-forming converter. One of the advantages of the proposed method is that the phase lock loop system is eliminated, which may cause stability issues. Simulation results show that the proposed method can control the microgrid effectively.
 
## Citation
- **Journal:** 2023 IEEE Power &amp; Energy Society General Meeting (PESGM)
- **Year:** 2023
- **Volume:** 
- **Issue:** 
- **Pages:** 1--5
- **Publisher:** IEEE
- **DOI:** [10.1109/pesgm52003.2023.10252343](https://doi.org/10.1109/pesgm52003.2023.10252343)
 
## BibTeX
{% highlight bibtex %}
{% raw %}
@inproceedings{Gui_2023,
  title={{Passivity-Based Control of Grid Forming and Grid Following Converters in Microgrids}},
  DOI={10.1109/pesgm52003.2023.10252343},
  booktitle={{2023 IEEE Power &amp; Energy Society General Meeting (PESGM)}},
  publisher={IEEE},
  author={Gui, Yonghao and Xue, Yaosuo},
  year={2023},
  pages={1--5}
}
{% endraw %}
{% endhighlight %}
 
[Download the bib file]({{ site.baseurl }}/assets/bib/passivity-based-control-of-grid-forming-and-grid-following-converters-in-microgrids.bib)
 
## References
- Rocabert, J., Luna, A., Blaabjerg, F. & Rodríguez, P. Control of Power Converters in AC Microgrids. IEEE Trans. Power Electron. 27, 4734–4749 (2012) -- [10.1109/tpel.2012.2199334](https://doi.org/10.1109/tpel.2012.2199334)
- Dong, D., Wen, B., Boroyevich, D., Mattavelli, P. & Xue, Y. Analysis of Phase-Locked Loop Low-Frequency Stability in Three-Phase Grid-Connected Power Converters Considering Impedance Interactions. IEEE Trans. Ind. Electron. 62, 310–321 (2015) -- [10.1109/tie.2014.2334665](https://doi.org/10.1109/tie.2014.2334665)
- Wang, X., Wu, H., Wang, X., Dall, L. & Kwon, J. B. Transient Stability Analysis of Grid-Following VSCs Considering Voltage-Dependent Current Injection During Fault Ride-Through. IEEE Trans. Energy Convers. 37, 2749–2760 (2022) -- [10.1109/tec.2022.3204358](https://doi.org/10.1109/tec.2022.3204358)
- Gao, S. et al. Comparative Study of Symmetrical Controlled Grid-Connected Inverters. IEEE Trans. Power Electron. 37, 3954–3968 (2022) -- [10.1109/tpel.2021.3122002](https://doi.org/10.1109/tpel.2021.3122002)
- Chen, M., Zhou, D. & Blaabjerg, F. Enhanced Transient Angle Stability Control of Grid-Forming Converter Based on Virtual Synchronous Generator. IEEE Trans. Ind. Electron. 69, 9133–9144 (2022) -- [10.1109/tie.2021.3114723](https://doi.org/10.1109/tie.2021.3114723)
- Simpson-Porco, J. W., Dörfler, F. & Bullo, F. Synchronization and power sharing for droop-controlled inverters in islanded microgrids. Automatica 49, 2603–2611 (2013) -- [10.1016/j.automatica.2013.05.018](https://doi.org/10.1016/j.automatica.2013.05.018)
- Huang, L. et al. Transient Stability Analysis and Control Design of Droop-Controlled Voltage Source Converters Considering Current Limitation. IEEE Trans. Smart Grid 10, 578–591 (2019) -- [10.1109/tsg.2017.2749259](https://doi.org/10.1109/tsg.2017.2749259)
- Li, M. et al. Inverter Parallelization for an Islanded Microgrid Using the Hopf Oscillator Controller Approach With Self-Synchronization Capabilities. IEEE Trans. Ind. Electron. 68, 10879–10889 (2021) -- [10.1109/tie.2020.3031520](https://doi.org/10.1109/tie.2020.3031520)
- [Kong, L., Xue, Y., Qiao, L. & Wang, F. Enhanced Synchronization Stability of Grid-Forming Inverters With Passivity-Based Virtual Oscillator Control. IEEE Trans. Power Electron. 37, 14141–14156 (2022)](enhanced-synchronization-stability-of-grid-forming-inverters-with-passivity-based-virtual-oscillator-control) -- [10.1109/tpel.2022.3187402](https://doi.org/10.1109/tpel.2022.3187402)
- Chen, M. et al. Generalized Multivariable Grid-Forming Control Design for Power Converters. IEEE Trans. Smart Grid 13, 2873–2885 (2022) -- [10.1109/tsg.2022.3161608](https://doi.org/10.1109/tsg.2022.3161608)
- He, X., Pan, S. & Geng, H. Transient Stability of Hybrid Power Systems Dominated by Different Types of Grid-Forming Devices. IEEE Trans. Energy Convers. 37, 868–879 (2022) -- [10.1109/tec.2021.3113399](https://doi.org/10.1109/tec.2021.3113399)
- Fu, X. et al. Large-Signal Stability of Grid-Forming and Grid-Following Controls in Voltage Source Converter: A Comparative Study. IEEE Trans. Power Electron. 36, 7832–7840 (2021) -- [10.1109/tpel.2020.3047480](https://doi.org/10.1109/tpel.2020.3047480)
- Nonlinear Control. Control Theory for Physicists 454–490 (2021) doi:10.1017/9780511734809.012 -- [10.1017/9780511734809.012](https://doi.org/10.1017/9780511734809.012)
- Sira-Ramirez, Control design techniques in power electronics devices (2006)
- [Gui, Y., Kim, C. & Chung, C. C. Improved low-voltage ride through capability for PMSG wind turbine based on port-controlled hamiltonian system. Int. J. Control Autom. Syst. 14, 1195–1204 (2016)](improved-low-voltage-ride-through-capability-for-pmsg-wind-turbine-based-on-port-controlled-hamiltonian-system) -- [10.1007/s12555-014-0480-y](https://doi.org/10.1007/s12555-014-0480-y)
- Lasseter, R. H., Chen, Z. & Pattabiraman, D. Grid-Forming Inverters: A Critical Asset for the Power Grid. IEEE J. Emerg. Sel. Topics Power Electron. 8, 925–935 (2020) -- [10.1109/jestpe.2019.2959271](https://doi.org/10.1109/jestpe.2019.2959271)
- Gao, S. et al. A Novel Direct Power Control for DFIG With Parallel Compensator Under Unbalanced Grid Condition. IEEE Trans. Ind. Electron. 68, 9607–9618 (2021) -- [10.1109/tie.2020.3022495](https://doi.org/10.1109/tie.2020.3022495)
- Wai, R.-J. & Yang, Y. Design of Backstepping Direct Power Control for Three-Phase PWM Rectifier. IEEE Trans. on Ind. Applicat. 55, 3160–3173 (2019) -- [10.1109/tia.2019.2893832](https://doi.org/10.1109/tia.2019.2893832)
- Gui, Y., Wang, X. & Blaabjerg, F. Vector Current Control Derived from Direct Power Control for Grid-Connected Inverters. IEEE Trans. Power Electron. 34, 9224–9235 (2019) -- [10.1109/tpel.2018.2883507](https://doi.org/10.1109/tpel.2018.2883507)
- Mazouz, F., Belkacem, S., Colak, I., Drid, S. & Harbouche, Y. Adaptive direct power control for double fed induction generator used in wind turbine. International Journal of Electrical Power &amp; Energy Systems 114, 105395 (2020) -- [10.1016/j.ijepes.2019.105395](https://doi.org/10.1016/j.ijepes.2019.105395)
- Gong, Z., Liu, C., Shang, L., Lai, Q. & Terriche, Y. Power Decoupling Strategy for Voltage Modulated Direct Power Control of Voltage Source Inverters Connected to Weak Grids. IEEE Trans. Sustain. Energy 14, 152–167 (2023) -- [10.1109/tste.2022.3204405](https://doi.org/10.1109/tste.2022.3204405)
- Gong, Z., Liu, C., Gui, Y., da Silva, F. F. & Bak, C. L. Power Decoupling Method for Voltage Source Inverters Using Grid Voltage Modulated Direct Power Control in Unbalanced System. IEEE Trans. Power Electron. 38, 3084–3099 (2023) -- [10.1109/tpel.2022.3220436](https://doi.org/10.1109/tpel.2022.3220436)
- Harnefors, L., Yepes, A. G., Vidal, A. & Doval-Gandoy, J. Passivity-Based Controller Design of Grid-Connected VSCs for Prevention of Electrical Resonance Instability. IEEE Trans. Ind. Electron. 62, 702–710 (2015) -- [10.1109/tie.2014.2336632](https://doi.org/10.1109/tie.2014.2336632)
- Gui, Y., Wei, B., Li, M., Guerrero, J. M. & Vasquez, J. C. Passivity-based coordinated control for islanded AC microgrid. Applied Energy 229, 551–561 (2018) -- [10.1016/j.apenergy.2018.07.115](https://doi.org/10.1016/j.apenergy.2018.07.115)
- Fang Zheng Peng & Jih-Sheng Lai. Generalized instantaneous reactive power theory for three-phase power systems. IEEE Trans. Instrum. Meas. 45, 293–297 (1996) -- [10.1109/19.481350](https://doi.org/10.1109/19.481350)
- Hu, J. Improved Dead-Beat Predictive DPC Strategy of Grid-Connected DC–AC Converters With Switching Loss Minimization and Delay Compensations. IEEE Trans. Ind. Inf. 9, 728–738 (2013) -- [10.1109/tii.2012.2223705](https://doi.org/10.1109/tii.2012.2223705)
- Gui, Y. et al. Improved Direct Power Control for Grid-Connected Voltage Source Converters. IEEE Trans. Ind. Electron. 65, 8041–8051 (2018) -- [10.1109/tie.2018.2801835](https://doi.org/10.1109/tie.2018.2801835)
- Gui, Y., Wang, X., Wu, H. & Blaabjerg, F. Voltage-Modulated Direct Power Control for a Weak Grid-Connected Voltage Source Inverters. IEEE Trans. Power Electron. 34, 11383–11395 (2019) -- [10.1109/tpel.2019.2898268](https://doi.org/10.1109/tpel.2019.2898268)
- [Gui, Y., Chung, C. C., Blaabjerg, F. & Taul, M. G. Dynamic Extension Algorithm-Based Tracking Control of STATCOM Via Port-Controlled Hamiltonian System. IEEE Trans. Ind. Inf. 16, 5076–5087 (2020)](dynamic-extension-algorithm-based-tracking-control-of-statcom-via-port-controlled-hamiltonian-system) -- [10.1109/tii.2019.2957038](https://doi.org/10.1109/tii.2019.2957038)
- [Yonghao Gui, Dong Eui Chang & Chung Choo Chung. Tracking controller design methodology for passive port-controlled Hamiltonians with application to type-2 STATCOM systems. 52nd IEEE Conference on Decision and Control 1653–1658 (2013) doi:10.1109/cdc.2013.6760119](tracking-controller-design-methodology-for-passive-port-controlled-hamiltonians-with-application-to-type-2-statcom-systems) -- [10.1109/cdc.2013.6760119](https://doi.org/10.1109/cdc.2013.6760119)
- Levine, J. Analysis and Control of Nonlinear Systems. (Springer Berlin Heidelberg, 2009). doi:10.1007/978-3-642-00839-9 -- [10.1007/978-3-642-00839-9](https://doi.org/10.1007/978-3-642-00839-9)

