---
title: "A perturbed Port-Hamiltonian approach for the stabilization of homogeneous reaction systems via the control of vessel extents"
date: 2021-07-24 00:00:00 +0100
permalink: a-perturbed-port-hamiltonian-approach-for-the-stabilization-of-homogeneous-reaction-systems-via-the-control-of-vessel-extents
year: 2021
authors: T. Sang Nguyen, C.K. Tan, N. Ha Hoang, M.A. Hussain, D. Bonvin
category: articles
tags:
  - Chemical reaction
  - Vessel extents
  - Disturbance compensation
  - Port-Hamiltonian formulation
  - Tracking-error passivity-based control
---
 
## Authors
[T. Sang Nguyen](authors/thanh-sang-nguyen), [C.K. Tan](authors/chee-keong-tan), [N. Ha Hoang](authors/ngoc-ha-hoang), [M.A. Hussain](authors/mohd-azlan-hussain), [D. Bonvin](authors/d-bonvin)
 
## Abstract
The paper proposes a tracking-error passivity-based control scheme for the asymptotic stabilization of homogeneous reaction systems. The approach uses the concept of vessel extents in the Port-Hamiltonian (PH) framework. Concretely, the extent-based representation that is obtained by linear time-invariant transformation of the reaction model is expressed as a perturbed PH system, whereby the reaction rates constitute unmatched time-varying disturbances. Two scenarios are considered. The first one assumes that the molar numbers of all species and the reaction temperature are measured and, furthermore, the kinetic model is known, while the second scenario relaxes these assumptions and requires only the measurements of a subset of the molar numbers and of the reactor temperature, but no knowledge of reaction kinetics. For the first scenario, the passivity-based method is used to compensate the disturbances, while preserving the PH structure of the error system via simple matrix factorization of the disturbances. For the second scenario, a constructive procedure is proposed to complete the space of vessel extents with the aim of computing an appropriate damping injection for the closed-loop system. It is shown that the proposed strategies guarantee that the system trajectories converge towards the desired setpoints without the need of state observation. A reaction system exhibiting non-minimum phase behavior is used to illustrate the theoretical developments. The closed-loop performance is discussed and compared to that of a PI controller.
 
## Keywords
Chemical reaction; Vessel extents; Disturbance compensation; Port-Hamiltonian formulation; Tracking-error passivity-based control
 
## Citation
- **Journal:** Computers &amp; Chemical Engineering
- **Year:** 2021
- **Volume:** 154
- **Issue:** 
- **Pages:** 107458
- **Publisher:** Elsevier BV
- **DOI:** [10.1016/j.compchemeng.2021.107458](https://doi.org/10.1016/j.compchemeng.2021.107458)
 
## BibTeX
{% highlight bibtex %}
{% raw %}
@article{Nguyen_2021,
  title={{A perturbed Port-Hamiltonian approach for the stabilization of homogeneous reaction systems via the control of vessel extents}},
  volume={154},
  ISSN={0098-1354},
  DOI={10.1016/j.compchemeng.2021.107458},
  journal={Computers &amp; Chemical Engineering},
  publisher={Elsevier BV},
  author={Nguyen, T. Sang and Tan, C.K. and Hoang, N. Ha and Hussain, M.A. and Bonvin, D.},
  year={2021},
  pages={107458}
}
{% endraw %}
{% endhighlight %}
 
[Download the bib file]({{ site.baseurl }}/assets/bib/a-perturbed-port-hamiltonian-approach-for-the-stabilization-of-homogeneous-reaction-systems-via-the-control-of-vessel-extents.bib)
 
## References
- Alvarez-Ramirez, J. & Puebla, H. On classical PI control of chemical reactors. Chemical Engineering Science vol. 56 2111–2121 (2001) -- [10.1016/s0009-2509(00)00471-1](https://doi.org/10.1016/s0009-2509(00)00471-1)
- Alvarez-Ramírez, J., Suárez, R. & Femat, R. Control of continuous-stirred tank reactors: Stabilization with unknown reaction rates. Chemical Engineering Science vol. 51 4183–4188 (1996) -- [10.1016/0009-2509(96)00240-0](https://doi.org/10.1016/0009-2509(96)00240-0)
- Amrhein, M., Bhatt, N., Srinivasan, B. & Bonvin, D. Extents of reaction and flow for homogeneous reaction systems with inlet and outlet streams. AIChE Journal vol. 56 2873–2886 (2010) -- [10.1002/aic.12125](https://doi.org/10.1002/aic.12125)
- Asbjørnsen, O. A. Reaction invariants in the control of continuous chemical reactors. Chemical Engineering Science vol. 27 709–717 (1972) -- [10.1016/0009-2509(72)85007-3](https://doi.org/10.1016/0009-2509(72)85007-3)
- Asbjørnsen, O. A. & Field, M. Response modes of continuous stirred tank reactors. Chemical Engineering Science vol. 25 1627–1636 (1970) -- [10.1016/0009-2509(70)80054-9](https://doi.org/10.1016/0009-2509(70)80054-9)
- Bhatt, N., Amrhein, M. & Bonvin, D. Extents of Reaction, Mass Transfer and Flow for Gas−Liquid Reaction Systems. Industrial &amp; Engineering Chemistry Research vol. 49 7704–7717 (2010) -- [10.1021/ie902015t](https://doi.org/10.1021/ie902015t)
- Billeter, J., Rodrigues, D., Srinivasan, S., Amrhein, M. & Bonvin, D. On decoupling rate processes in chemical reaction systems – Methods and applications. Computers &amp; Chemical Engineering vol. 114 296–305 (2018) -- [10.1016/j.compchemeng.2017.09.021](https://doi.org/10.1016/j.compchemeng.2017.09.021)
- [Donaire, A. & Junco, S. On the addition of integral action to port-controlled Hamiltonian systems. Automatica vol. 45 1910–1916 (2009)](on-the-addition-of-integral-action-to-port-controlled-hamiltonian-systems) -- [10.1016/j.automatica.2009.04.006](https://doi.org/10.1016/j.automatica.2009.04.006)
- [Ferguson, J., Donaire, A. & Middleton, R. H. Integral Control of Port-Hamiltonian Systems: Nonpassive Outputs Without Coordinate Transformation. IEEE Transactions on Automatic Control vol. 62 5947–5953 (2017)](integral-control-of-port-hamiltonian-systems-nonpassive-outputs-without-coordinate-transformation) -- [10.1109/tac.2017.2700995](https://doi.org/10.1109/tac.2017.2700995)
- Fjeld, M., Asbjørnsen, O. A. & Åström, K. J. Reaction invariants and their importance in the analysis of eigenvectors, state observability and controllability of the continuous stirred tank reactor. Chemical Engineering Science vol. 29 1917–1926 (1974) -- [10.1016/0009-2509(74)85009-8](https://doi.org/10.1016/0009-2509(74)85009-8)
- Fradkov, A., Ortega, R. & Bastin, G. Semi‐adaptive control of convexly parametrized systems with application to temperature regulation of chemical reactors. International Journal of Adaptive Control and Signal Processing vol. 15 415–426 (2001) -- [10.1002/acs.634](https://doi.org/10.1002/acs.634)
- [Fujimoto, K., Sakurama, K. & Sugie, T. Trajectory tracking control of port-controlled Hamiltonian systems via generalized canonical transformations. Automatica vol. 39 2059–2069 (2003)](trajectory-tracking-control-of-port-controlled-hamiltonian-systems-via-generalized-canonical-transformations) -- [10.1016/j.automatica.2003.07.005](https://doi.org/10.1016/j.automatica.2003.07.005)
- Hammarström, L. G. Control of chemical reactors in the subspace of reaction and control variants. Chemical Engineering Science vol. 34 891–899 (1979) -- [10.1016/0009-2509(79)85146-5](https://doi.org/10.1016/0009-2509(79)85146-5)
- [Hoang, H., Couenne, F., Jallut, C. & Le Gorrec, Y. The port Hamiltonian approach to modeling and control of Continuous Stirred Tank Reactors. Journal of Process Control vol. 21 1449–1458 (2011)](the-port-hamiltonian-approach-to-modeling-and-control-of-continuous-stirred-tank-reactors) -- [10.1016/j.jprocont.2011.06.014](https://doi.org/10.1016/j.jprocont.2011.06.014)
- Hoang, N. H., Couenne, F., Jallut, C. & Le Gorrec, Y. Thermodynamics based stability analysis and its use for nonlinear stabilization of the CSTR. Computers &amp; Chemical Engineering vol. 58 156–177 (2013) -- [10.1016/j.compchemeng.2013.06.016](https://doi.org/10.1016/j.compchemeng.2013.06.016)
- [Ha Hoang, N., Couenne, F., Le Gorrec, Y., Chen, C. L. & Ydstie, B. E. Passivity-based nonlinear control of CSTR via asymptotic observers. Annual Reviews in Control vol. 37 278–288 (2013)](passivity-based-nonlinear-control-of-cstr-via-asymptotic-observers) -- [10.1016/j.arcontrol.2013.09.007](https://doi.org/10.1016/j.arcontrol.2013.09.007)
- Hoang, N. H. & Dochain, D. A comment on thermodynamically consistent feasibility condition of asymptotic observers. Chemical Engineering Science vol. 199 258–274 (2019) -- [10.1016/j.ces.2019.01.010](https://doi.org/10.1016/j.ces.2019.01.010)
- Hoang, On the computation of extents of reaction with a limited number of measurements. Comput. Chem. Eng. (2020)
- Ha Hoang, N., Rodrigues, D. & Bonvin, D. Revisiting the concept of extents for chemical reaction systems using an enthalpy balance. Computers &amp; Chemical Engineering vol. 136 106652 (2020) -- [10.1016/j.compchemeng.2019.106652](https://doi.org/10.1016/j.compchemeng.2019.106652)
- Khalil, (2002)
- Lucia, S., Finkler, T. & Engell, S. Multi-stage nonlinear model predictive control applied to a semi-batch polymerization reactor under uncertainty. Journal of Process Control vol. 23 1306–1319 (2013) -- [10.1016/j.jprocont.2013.08.008](https://doi.org/10.1016/j.jprocont.2013.08.008)
- Luyben, (1990)
- Marquez-Ruiz, A., Mendez-Blanco, C. S. & Özkan, L. Control of Homogeneous Reaction Systems using Extent-Based LPV Models. IFAC-PapersOnLine vol. 51 548–553 (2018) -- [10.1016/j.ifacol.2018.09.367](https://doi.org/10.1016/j.ifacol.2018.09.367)
- Marquez-Ruiz, A., Loonen, M., Saltık, M. B. & Özkan, L. Model Learning Predictive Control for Batch Processes: A Reactive Batch Distillation Column Case Study. Industrial &amp; Engineering Chemistry Research vol. 58 13737–13749 (2019) -- [10.1021/acs.iecr.8b06474](https://doi.org/10.1021/acs.iecr.8b06474)
- Marquez-Ruiz, A., Méndez-Blanco, C. S. & Özkan, L. Modeling of reactive batch distillation processes for control. Computers &amp; Chemical Engineering vol. 121 86–98 (2019) -- [10.1016/j.compchemeng.2018.10.010](https://doi.org/10.1016/j.compchemeng.2018.10.010)
- Marquez-Ruiz, A., Mendez-Blanco, C. & Özkan, L. Constrained Control and Estimation of Homogeneous Reaction Systems Using Extent-Based Linear Parameter Varying Models. Industrial &amp; Engineering Chemistry Research vol. 59 2242–2251 (2020) -- [10.1021/acs.iecr.9b04412](https://doi.org/10.1021/acs.iecr.9b04412)
- [Nguyen, T. S., Hoang, N. H. & Azlan Hussain, M. Feedback passivation plus tracking-error-based multivariable control for a class of free-radical polymerisation reactors. International Journal of Control vol. 92 1970–1984 (2018)](feedback-passivation-plus-tracking-error-based-multivariable-control-for-a-class-of-free-radical-polymerisation-reactors) -- [10.1080/00207179.2017.1423393](https://doi.org/10.1080/00207179.2017.1423393)
- [Nguyen, T. S., Hoang, N. H., Hussain, M. A. & Tan, C. K. Tracking-error control via the relaxing port-Hamiltonian formulation: Application to level control and batch polymerization reactor. Journal of Process Control vol. 80 152–166 (2019)](tracking-error-control-via-the-relaxing-port-hamiltonian-formulation-application-to-level-control-and-batch-polymerization-reactor) -- [10.1016/j.jprocont.2019.05.014](https://doi.org/10.1016/j.jprocont.2019.05.014)
- [Nguyen, T. S., Tan, C. K., Hoang, N. H. & Hussain, M. A. Tracking-error-based control of a chemical reactor using decoupled dynamic variables. IFAC-PapersOnLine vol. 52 74–79 (2019)](tracking-error-based-control-of-a-chemical-reactor-using-decoupled-dynamic-variables) -- [10.1016/j.ifacol.2019.07.013](https://doi.org/10.1016/j.ifacol.2019.07.013)
- [Thanh Sang, N., Chee Keong, T., Ngoc Ha, H. & Hussain, M. A. Control of reaction systems using decoupled dynamics via perturbed Hamiltonian formulation. IFAC-PapersOnLine vol. 53 11527–11532 (2020)](control-of-reaction-systems-using-decoupled-dynamics-via-perturbed-hamiltonian-formulation) -- [10.1016/j.ifacol.2020.12.628](https://doi.org/10.1016/j.ifacol.2020.12.628)
- [Nunna, K., Sassano, M. & Astolfi, A. Constructive Interconnection and Damping Assignment for Port-Controlled Hamiltonian Systems. IEEE Transactions on Automatic Control vol. 60 2350–2361 (2015)](constructive-interconnection-and-damping-assignment-for-port-controlled-hamiltonian-systems) -- [10.1109/tac.2015.2400663](https://doi.org/10.1109/tac.2015.2400663)
- [Ortega, R. & Romero, J. G. Robust integral control of port-Hamiltonian systems: The case of non-passive outputs with unmatched disturbances. Systems &amp; Control Letters vol. 61 11–17 (2012)](robust-integral-control-of-port-hamiltonian-systems-the-case-of-non-passive-outputs-with-unmatched-disturbances) -- [10.1016/j.sysconle.2011.09.015](https://doi.org/10.1016/j.sysconle.2011.09.015)
- [Ortega, R., van der Schaft, A., Maschke, B. & Escobar, G. Interconnection and damping assignment passivity-based control of port-controlled Hamiltonian systems. Automatica vol. 38 585–596 (2002)](interconnection-and-damping-assignment-passivity-based-control-of-port-controlled-hamiltonian-systems) -- [10.1016/s0005-1098(01)00278-3](https://doi.org/10.1016/s0005-1098(01)00278-3)
- Prakash, J. & Srinivasan, K. Design of nonlinear PID controller and nonlinear model predictive controller for a continuous stirred tank reactor. ISA Transactions vol. 48 273–282 (2009) -- [10.1016/j.isatra.2009.02.001](https://doi.org/10.1016/j.isatra.2009.02.001)
- Rasmuson, (2014)
- Rawlings, (2015)
- Rodrigues, Control of reaction systems via rate estimation and feedback linearization. (2015)
- Rodrigues, D., Billeter, J. & Bonvin, D. Maximum-likelihood estimation of kinetic parameters via the extent-based incremental approach. Computers &amp; Chemical Engineering vol. 122 152–171 (2019) -- [10.1016/j.compchemeng.2018.05.024](https://doi.org/10.1016/j.compchemeng.2018.05.024)
- Rodrigues, D. & Bonvin, D. On reducing the number of decision variables for dynamic optimization. Optimal Control Applications and Methods vol. 41 292–311 (2019) -- [10.1002/oca.2543](https://doi.org/10.1002/oca.2543)
- Rodrigues, D., Srinivasan, S., Billeter, J. & Bonvin, D. Variant and invariant states for chemical reaction systems. Computers &amp; Chemical Engineering vol. 73 23–33 (2015) -- [10.1016/j.compchemeng.2014.10.009](https://doi.org/10.1016/j.compchemeng.2014.10.009)
- Srinivasan, B., Amrhein, M. & Bonvin, D. Reaction and flow variants/invariants in chemical reaction systems with inlet and outlet streams. AIChE Journal vol. 44 1858–1867 (1998) -- [10.1002/aic.690440815](https://doi.org/10.1002/aic.690440815)
- Srinivasan, S., Billeter, J., Narasimhan, S. & Bonvin, D. Data reconciliation for chemical reaction systems using vessel extents and shape constraints. Computers &amp; Chemical Engineering vol. 101 44–58 (2017) -- [10.1016/j.compchemeng.2017.02.003](https://doi.org/10.1016/j.compchemeng.2017.02.003)
- Viel, F., Busvelle, E. & Gauthier, J. P. Stability of polymerization reactors using I/O linearization and a high-gain observer. Automatica vol. 31 971–984 (1995) -- [10.1016/0005-1098(95)00009-l](https://doi.org/10.1016/0005-1098(95)00009-l)
- Viel, F., Jadot, F. & Bastin, G. Robust feedback stabilization of chemical reactors. IEEE Transactions on Automatic Control vol. 42 473–481 (1997) -- [10.1109/9.566657](https://doi.org/10.1109/9.566657)
- Waller, K. V. & Makila, P. M. Chemical reaction invariants and variants and their use in reactor modeling, simulation, and control. Industrial &amp; Engineering Chemistry Process Design and Development vol. 20 1–11 (1981) -- [10.1021/i200012a001](https://doi.org/10.1021/i200012a001)
- Wu, D., Ortega, R. & Duan, G. On universal stabilization property of Interconnection and Damping Assignment Control. Automatica vol. 119 109087 (2020) -- [10.1016/j.automatica.2020.109087](https://doi.org/10.1016/j.automatica.2020.109087)
- [Yaghmaei, A. & Yazdanpanah, M. J. Trajectory tracking for a class of contractive port Hamiltonian systems. Automatica vol. 83 331–336 (2017)](trajectory-tracking-for-a-class-of-contractive-port-hamiltonian-systems) -- [10.1016/j.automatica.2017.06.039](https://doi.org/10.1016/j.automatica.2017.06.039)
- Zerari, Robust adaptive neural network prescribed performance control for uncertain CSTR system with input nonlinearities and external disturbance. Neural Comput. Appl. (2019)
- Zhang, M., Ortega, R., Liu, Z. & Su, H. A new family of interconnection and damping assignment passivity-based controllers. International Journal of Robust and Nonlinear Control vol. 27 50–65 (2016) -- [10.1002/rnc.3557](https://doi.org/10.1002/rnc.3557)

