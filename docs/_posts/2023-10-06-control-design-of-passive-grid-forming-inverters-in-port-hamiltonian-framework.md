---
layout: post
title: "Control Design of Passive Grid-Forming Inverters in Port-Hamiltonian Framework"
date: 2023-10-06 00:00:00 +0100
permalink: control-design-of-passive-grid-forming-inverters-in-port-hamiltonian-framework
year: 2024
authors: Le Kong, Yaosuo Xue, Liang Qiao, Fei Wang
category: articles
---
 
## Authors
[Le Kong](authors/le-kong), [Yaosuo Xue](authors/yaosuo-xue), [Liang Qiao](authors/liang-qiao), [Fei Wang](authors/fei-wang)
 
## Abstract
This article presents a modified dispatchable virtual oscillator control approach for achieving the passivity of grid-forming inverters (GFMs), without assuming constant voltage and constant frequency. The proposed control framework utilizes the port-Hamiltonian (PH)–based structure that mimics the behaviors of coupled harmonic oscillators, along with an energy “pumping-or-damping” block and the control by interconnection technique, to render the inverter passive. Once passivity is achieved, the transient stability of the system will be guaranteed. The proposed control framework is composed of three loops: an outer power dispatching loop that generates the voltage and frequency references, a virtual oscillator loop that emulates the spontaneous synchronization of oscillators, and an inductor current loop that maintains lossless interconnection in PH systems. The study shows that the proposed control approach ensures the passivity of GFMs, facilitating the transient stability design of multi-inverter systems, as interconnections of passive systems remain passive and stable.
 
## Citation
- **Journal:** IEEE Transactions on Power Electronics
- **Year:** 2024
- **Volume:** 39
- **Issue:** 1
- **Pages:** 332--345
- **Publisher:** Institute of Electrical and Electronics Engineers (IEEE)
- **DOI:** [10.1109/tpel.2023.3319966](https://doi.org/10.1109/tpel.2023.3319966)
 
## BibTeX
{% highlight bibtex %}
{% raw %}
@article{Kong_2024,
  title={{Control Design of Passive Grid-Forming Inverters in Port-Hamiltonian Framework}},
  volume={39},
  ISSN={1941-0107},
  DOI={10.1109/tpel.2023.3319966},
  number={1},
  journal={IEEE Transactions on Power Electronics},
  publisher={Institute of Electrical and Electronics Engineers (IEEE)},
  author={Kong, Le and Xue, Yaosuo and Qiao, Liang and Wang, Fei},
  year={2024},
  pages={332--345}
}
{% endraw %}
{% endhighlight %}
 
[Download the bib file]({{ site.baseurl }}/assets/bib/control-design-of-passive-grid-forming-inverters-in-port-hamiltonian-framework.bib)
 
## References
- Hatziargyriou, N. et al. Definition and Classification of Power System Stability – Revisited &amp; Extended. IEEE Transactions on Power Systems vol. 36 3271–3281 (2021) -- [10.1109/tpwrs.2020.3041774](https://doi.org/10.1109/tpwrs.2020.3041774)
- Kong, L., Xue, Y., Qiao, L. & Wang, F. Review of Small-Signal Converter-Driven Stability Issues in Power Systems. IEEE Open Access Journal of Power and Energy vol. 9 29–41 (2022) -- [10.1109/oajpe.2021.3137468](https://doi.org/10.1109/oajpe.2021.3137468)
- Lin, Y. et al. Research Roadmap on Grid-Forming Inverters. http://dx.doi.org/10.2172/1721727 (2020) doi:10.2172/1721727 -- [10.2172/1721727](https://doi.org/10.2172/1721727)
- Lasseter, R. H., Chen, Z. & Pattabiraman, D. Grid-Forming Inverters: A Critical Asset for the Power Grid. IEEE Journal of Emerging and Selected Topics in Power Electronics vol. 8 925–935 (2020) -- [10.1109/jestpe.2019.2959271](https://doi.org/10.1109/jestpe.2019.2959271)
- Yu, H., Awal, M. A., Tu, H., Husain, I. & Lukic, S. Comparative Transient Stability Assessment of Droop and Dispatchable Virtual Oscillator Controlled Grid-Connected Inverters. IEEE Transactions on Power Electronics vol. 36 2119–2130 (2021) -- [10.1109/tpel.2020.3007628](https://doi.org/10.1109/tpel.2020.3007628)
- Pan, D., Wang, X., Liu, F. & Shi, R. Transient Stability of Voltage-Source Converters With Grid-Forming Control: A Design-Oriented Study. IEEE Journal of Emerging and Selected Topics in Power Electronics vol. 8 1019–1033 (2020) -- [10.1109/jestpe.2019.2946310](https://doi.org/10.1109/jestpe.2019.2946310)
- Torres, L. A. B., Hespanha, J. P. & Moehlis, J. Power supply synchronization without communication. 2012 IEEE Power and Energy Society General Meeting 1–6 (2012) doi:10.1109/pesgm.2012.6344905 -- [10.1109/pesgm.2012.6344905](https://doi.org/10.1109/pesgm.2012.6344905)
- Zhong, Q. Power Electronics‐Enabled Autonomous Power Systems. (2020) doi:10.1002/9781118803516 -- [10.1002/9781118803516](https://doi.org/10.1002/9781118803516)
- Navarro-López, E. M. & Licéaga-Castro, E. Combining passivity and classical frequency-domain methods: An insight into decentralised control. Applied Mathematics and Computation vol. 215 4426–4438 (2010) -- [10.1016/j.amc.2010.01.012](https://doi.org/10.1016/j.amc.2010.01.012)
- Yu, H. et al. Passivity-Oriented Discrete-Time Voltage Controller Design for Grid-Forming Inverters. 2019 IEEE Energy Conversion Congress and Exposition (ECCE) (2019) doi:10.1109/ecce.2019.8912988 -- [10.1109/ecce.2019.8912988](https://doi.org/10.1109/ecce.2019.8912988)
- Liao, Y. & Wang, X. Passivity Analysis and Enhancement of Voltage Control for Voltage-Source Converters. 2019 IEEE Energy Conversion Congress and Exposition (ECCE) 5424–5429 (2019) doi:10.1109/ecce.2019.8912790 -- [10.1109/ecce.2019.8912790](https://doi.org/10.1109/ecce.2019.8912790)
- Wu, G. et al. Passivity-Based Stability Analysis and Generic Controller Design for Grid-Forming Inverter. IEEE Transactions on Power Electronics vol. 38 5832–5843 (2023) -- [10.1109/tpel.2023.3237608](https://doi.org/10.1109/tpel.2023.3237608)
- Wu, H. & Wang, X. Passivity-Based Dual-Loop Vector Voltage and Current Control for Grid-Forming VSCs. IEEE Transactions on Power Electronics vol. 36 8647–8652 (2021) -- [10.1109/tpel.2020.3048239](https://doi.org/10.1109/tpel.2020.3048239)
- Qi, Y., Deng, H., Wang, J. & Tang, Y. Passivity-Based Synchronization Stability Analysis for Power-Electronic-Interfaced Distributed Generations. IEEE Transactions on Sustainable Energy vol. 12 1141–1150 (2021) -- [10.1109/tste.2020.3035261](https://doi.org/10.1109/tste.2020.3035261)
- Zhao, F., Wang, X. & Zhu, T. Low-Frequency Passivity-Based Analysis and Damping of Power-Synchronization Controlled Grid-Forming Inverter. IEEE Journal of Emerging and Selected Topics in Power Electronics vol. 11 1542–1554 (2023) -- [10.1109/jestpe.2022.3218845](https://doi.org/10.1109/jestpe.2022.3218845)
- Khefifi, N., Houari, A., Machmoum, M., Ghanes, M. & Ait-Ahmed, M. Control of grid forming inverter based on robust IDA-PBC for power quality enhancement. Sustainable Energy, Grids and Networks vol. 20 100276 (2019) -- [10.1016/j.segan.2019.100276](https://doi.org/10.1016/j.segan.2019.100276)
- Yang, P., Liu, F., Wang, Z. & Shen, C. Distributed Stability Conditions for Power Systems With Heterogeneous Nonlinear Bus Dynamics. IEEE Transactions on Power Systems vol. 35 2313–2324 (2020) -- [10.1109/tpwrs.2019.2951202](https://doi.org/10.1109/tpwrs.2019.2951202)
- [Zhong, Q.-C. & Stefanello, M. A Port-Hamiltonian Control Framework to Render a Power Electronic System Passive. IEEE Transactions on Automatic Control vol. 67 1960–1965 (2022)](a-port-hamiltonian-control-framework-to-render-a-power-electronic-system-passive) -- [10.1109/tac.2021.3069389](https://doi.org/10.1109/tac.2021.3069389)
- Multidomain modeling of nonlinear networks and systems. IEEE Control Systems vol. 29 28–59 (2009) -- [10.1109/mcs.2009.932927](https://doi.org/10.1109/mcs.2009.932927)
- van der Schaft, A. & Jeltsema, D. Port-Hamiltonian Systems Theory: An Introductory Overview. (2014) doi:10.1561/9781601987877 -- [10.1561/9781601987877](https://doi.org/10.1561/9781601987877)
- van der Schaft, A. & Schumacher, H. An Introduction to Hybrid Dynamical Systems. Lecture Notes in Control and Information Sciences (Springer London, 2000). doi:10.1007/bfb0109998 -- [10.1007/bfb0109998](https://doi.org/10.1007/bfb0109998)
- Rosso, R., Wang, X., Liserre, M., Lu, X. & Engelken, S. Grid-Forming Converters: Control Approaches, Grid-Synchronization, and Future Trends—A Review. IEEE Open Journal of Industry Applications vol. 2 93–109 (2021) -- [10.1109/ojia.2021.3074028](https://doi.org/10.1109/ojia.2021.3074028)
- Zhang, L., Harnefors, L. & Nee, H.-P. Power-Synchronization Control of Grid-Connected Voltage-Source Converters. IEEE Transactions on Power Systems vol. 25 809–820 (2010) -- [10.1109/tpwrs.2009.2032231](https://doi.org/10.1109/tpwrs.2009.2032231)
- Wu, H. & Wang, X. Design-Oriented Transient Stability Analysis of Grid-Connected Converters With Power Synchronization Control. IEEE Transactions on Industrial Electronics vol. 66 6473–6482 (2019) -- [10.1109/tie.2018.2875669](https://doi.org/10.1109/tie.2018.2875669)
- Guerrero, J. M., GarciadeVicuna, L., Matas, J., Castilla, M. & Miret, J. A Wireless Controller to Enhance Dynamic Performance of Parallel Inverters in Distributed Generation Systems. IEEE Transactions on Power Electronics vol. 19 1205–1213 (2004) -- [10.1109/tpel.2004.833451](https://doi.org/10.1109/tpel.2004.833451)
- Li, Y., Vilathgamuwa, D. M. & Loh, P. C. Design, Analysis, and Real-Time Testing of a Controller for Multibus Microgrid System. IEEE Transactions on Power Electronics vol. 19 1195–1204 (2004) -- [10.1109/tpel.2004.833456](https://doi.org/10.1109/tpel.2004.833456)
- Du, W. et al. A Comparative Study of Two Widely Used Grid-Forming Droop Controls on Microgrid Small-Signal Stability. IEEE Journal of Emerging and Selected Topics in Power Electronics vol. 8 963–975 (2020) -- [10.1109/jestpe.2019.2942491](https://doi.org/10.1109/jestpe.2019.2942491)
- Pogaku, N., Prodanovic, M. & Green, T. C. Modeling, Analysis and Testing of Autonomous Operation of an Inverter-Based Microgrid. IEEE Transactions on Power Electronics vol. 22 613–625 (2007) -- [10.1109/tpel.2006.890003](https://doi.org/10.1109/tpel.2006.890003)
- Hart, P. & Lesieutre, B. Energy function for a grid-tied, droop-controlled inverter. 2014 North American Power Symposium (NAPS) 1–6 (2014) doi:10.1109/naps.2014.6965437 -- [10.1109/naps.2014.6965437](https://doi.org/10.1109/naps.2014.6965437)
- Johnson, B. B., Sinha, M., Ainsworth, N. G., Dorfler, F. & Dhople, S. V. Synthesizing Virtual Oscillators to Control Islanded Inverters. IEEE Transactions on Power Electronics vol. 31 6002–6015 (2016) -- [10.1109/tpel.2015.2497217](https://doi.org/10.1109/tpel.2015.2497217)
- Johnson, B. B., Dhople, S. V., Hamadeh, A. O. & Krein, P. T. Synchronization of Nonlinear Oscillators in an LTI Electrical Power Network. IEEE Transactions on Circuits and Systems I: Regular Papers vol. 61 834–844 (2014) -- [10.1109/tcsi.2013.2284180](https://doi.org/10.1109/tcsi.2013.2284180)
- Seo, G.-S. et al. Dispatchable Virtual Oscillator Control for Decentralized Inverter-dominated Power Systems: Analysis and Experiments. 2019 IEEE Applied Power Electronics Conference and Exposition (APEC) (2019) doi:10.1109/apec.2019.8722028 -- [10.1109/apec.2019.8722028](https://doi.org/10.1109/apec.2019.8722028)
- Lu, M., Dutta, S., Purba, V., Dhople, S. & Johnson, B. A Grid-compatible Virtual Oscillator Controller: Analysis and Design. 2019 IEEE Energy Conversion Congress and Exposition (ECCE) 2643–2649 (2019) doi:10.1109/ecce.2019.8913128 -- [10.1109/ecce.2019.8913128](https://doi.org/10.1109/ecce.2019.8913128)
- Colombino, M., Groz, D., Brouillon, J.-S. & Dorfler, F. Global Phase and Magnitude Synchronization of Coupled Oscillators With Application to the Control of Grid-Forming Power Inverters. IEEE Transactions on Automatic Control vol. 64 4496–4511 (2019) -- [10.1109/tac.2019.2898549](https://doi.org/10.1109/tac.2019.2898549)
- [Kong, L., Xue, Y., Qiao, L. & Wang, F. Enhanced Synchronization Stability of Grid-Forming Inverters With Passivity-Based Virtual Oscillator Control. IEEE Transactions on Power Electronics vol. 37 14141–14156 (2022)](enhanced-synchronization-stability-of-grid-forming-inverters-with-passivity-based-virtual-oscillator-control) -- [10.1109/tpel.2022.3187402](https://doi.org/10.1109/tpel.2022.3187402)
- Sinha, M., Dorfler, F., Johnson, B. B. & Dhople, S. V. Uncovering Droop Control Laws Embedded Within the Nonlinear Dynamics of Van der Pol Oscillators. IEEE Transactions on Control of Network Systems vol. 4 347–358 (2017) -- [10.1109/tcns.2015.2503558](https://doi.org/10.1109/tcns.2015.2503558)
- Sinha, M., Dorfler, F., Johnson, B. B. & Dhople, S. V. Virtual Oscillator Control subsumes droop control. 2015 American Control Conference (ACC) 2353–2358 (2015) doi:10.1109/acc.2015.7171084 -- [10.1109/acc.2015.7171084](https://doi.org/10.1109/acc.2015.7171084)
- Lu, M., Purba, V., Dhople, S. & Johnson, B. Comparison of Droop Control and Virtual Oscillator Control Realized by Andronov-Hopf Dynamics. IECON 2020 The 46th Annual Conference of the IEEE Industrial Electronics Society 4051–4056 (2020) doi:10.1109/iecon43393.2020.9254645 -- [10.1109/iecon43393.2020.9254645](https://doi.org/10.1109/iecon43393.2020.9254645)
- D’Arco, S. & Suul, J. A. Equivalence of Virtual Synchronous Machines and Frequency-Droops for Converter-Based MicroGrids. IEEE Transactions on Smart Grid vol. 5 394–395 (2014) -- [10.1109/tsg.2013.2288000](https://doi.org/10.1109/tsg.2013.2288000)
- Xiong, X., Wu, C. & Blaabjerg, F. An Improved Synchronization Stability Method of Virtual Synchronous Generators Based on Frequency Feedforward on Reactive Power Control Loop. IEEE Transactions on Power Electronics vol. 36 9136–9148 (2021) -- [10.1109/tpel.2021.3052350](https://doi.org/10.1109/tpel.2021.3052350)
- [Ortega, R., van der Schaft, A., Castanos, F. & Astolfi, A. Control by Interconnection and Standard Passivity-Based Control of Port-Hamiltonian Systems. IEEE Transactions on Automatic Control vol. 53 2527–2542 (2008)](control-by-interconnection-and-standard-passivity-based-control-of-port-hamiltonian-systems) -- [10.1109/tac.2008.2006930](https://doi.org/10.1109/tac.2008.2006930)
- Si, W. & Fang, J. Transient Stability Improvement of Grid-Forming Converters Through Voltage Amplitude Regulation and Reactive Power Injection. IEEE Transactions on Power Electronics vol. 38 12116–12125 (2023) -- [10.1109/tpel.2023.3290170](https://doi.org/10.1109/tpel.2023.3290170)
- Tolbert, L. M. et al. Reconfigurable Real-Time Power Grid Emulator for Systems With High Penetration of Renewables. IEEE Open Access Journal of Power and Energy vol. 7 489–500 (2020) -- [10.1109/oajpe.2020.3030219](https://doi.org/10.1109/oajpe.2020.3030219)

