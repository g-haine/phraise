---
title: "Applications of Port Hamiltonian Methods to Non-Iterative Stable Simulations of the KORG35 and MOOG 4-Pole VCF"
date: 2022-05-11 00:00:00 +0100
permalink: applications-of-port-hamiltonian-methods-to-non-iterative-stable-simulations-of-the-korg35-and-moog-4-pole-vcf
year: 2021
authors: Mohammed Danish, Stefan Bilbao, Michele Ducceschi
category: proceedings
---
 
## Authors
[Mohammed Danish](authors/mohammed-danish), [Stefan Bilbao](authors/stefan-bilbao), [Michele Ducceschi](authors/michele-ducceschi)
 
## Abstract
This paper presents an application of the port Hamiltonian formalism to the nonlinear simulation of the OTA-based Korg35 filter circuit and the Moog 4-pole ladder filter circuit. Lyapunov analysis is used with their state-space representations to guarantee zero-input stability over the range of parameters consistent with the actual circuits. A zero-input stable non-iterative discrete-time scheme based on a discrete gradient and a change of state variables is shown along with numerical simulations. Simulations show behavior consistent with the actual operation of the circuits, e.g., self-oscillation, and are found to be stable and have lower computational cost compared to iterative methods.
 
## Citation
- **Journal:** 2021 24th International Conference on Digital Audio Effects (DAFx)
- **Year:** 2021
- **Volume:** 
- **Issue:** 
- **Pages:** 33--40
- **Publisher:** IEEE
- **DOI:** [10.23919/dafx51585.2021.9768301](https://doi.org/10.23919/dafx51585.2021.9768301)
 
## BibTeX
{% highlight bibtex %}
{% raw %}
@inproceedings{Danish_2021,
  title={{Applications of Port Hamiltonian Methods to Non-Iterative Stable Simulations of the KORG35 and MOOG 4-Pole VCF}},
  DOI={10.23919/dafx51585.2021.9768301},
  booktitle={{2021 24th International Conference on Digital Audio Effects (DAFx)}},
  publisher={IEEE},
  author={Danish, Mohammed and Bilbao, Stefan and Ducceschi, Michele},
  year={2021},
  pages={33--40}
}
{% endraw %}
{% endhighlight %}
 
[Download the bib file]({{ site.baseurl }}/assets/bib/applications-of-port-hamiltonian-methods-to-non-iterative-stable-simulations-of-the-korg35-and-moog-4-pole-vcf.bib)
 
## References
- holters, Antiderivative Antialiasing for Stateful Systems. Intl Conf on Digital Audio Effects (2019)
- esqueda, Aliasing Reduction in Nonlinear Audio Signal Processing (2018)
- Veberič, D. Lambert W function for applications in physics. Computer Physics Communications 183, 2622–2628 (2012) -- [10.1016/j.cpc.2012.07.008](https://doi.org/10.1016/j.cpc.2012.07.008)
- bilbao, Lyapunov function for the nonlinear Moog voltage-controlled filter (2021)
- muller, Trajectory Anti-Aliasing on Guaranteed-Passive Simulation of Nonlinear Physical Systems. Intl Conf on Digital Audio Effects (2017)
- carson, Aliasing Reduction in Virtual Analogue Mod-elling (2020)
- holters, Antiderivative Antialiasing for Stateful Systems. Applied Sciences (2020)
- Yeh, D. T., Abel, J. S. & Smith, J. O. Automated Physical Modeling of Nonlinear Audio Circuits For Real-Time Audio Effects—Part I: Theoretical Development. IEEE Trans. Audio Speech Lang. Process. 18, 728–737 (2010) -- [10.1109/tasl.2009.2033978](https://doi.org/10.1109/tasl.2009.2033978)
- Yeh, D. T. Automated Physical Modeling of Nonlinear Audio Circuits for Real-Time Audio Effects—Part II: BJT and Vacuum Tube Examples. IEEE Trans. Audio Speech Lang. Process. 20, 1207–1216 (2012) -- [10.1109/tasl.2011.2173677](https://doi.org/10.1109/tasl.2011.2173677)
- Fettweis, A. Wave digital filters: Theory and practice. Proc. IEEE 74, 270–327 (1986) -- [10.1109/proc.1986.13458](https://doi.org/10.1109/proc.1986.13458)
- Sarti, A. & De Poli, G. Toward nonlinear wave digital filters. IEEE Trans. Signal Process. 47, 1654–1668 (1999) -- [10.1109/78.765137](https://doi.org/10.1109/78.765137)
- Karjalainen, M. & Pakarinen, J. Wave Digital Simulation of a Vacuum-Tube Amplifier. 2006 IEEE International Conference on Acoustics Speed and Signal Processing Proceedings vol. 5 V-153-V–156 -- [10.1109/icassp.2006.1661235](https://doi.org/10.1109/icassp.2006.1661235)
- werner, A gen-eral and explicit formulation for wave digital filters with mul-tiple/multiport nonlinearities and complicated topologies. 2015 IEEE Workshop on App Sig Proces Audio and Acous-tics (WASPAA) (0)
- van der schaft, Port-Hamiltonian Systems: An Intro-ductory Survey. Proc Int Cong Math (0)
- hélie, Lyapunov Stability Analysis of the Moog Ladder Filter and Dissipativity Aspects in Numerical Solutions. Proc 14th Int Conf Digital Audio Effects (0)
- [Lopes, N., Hélie, T. & Falaize, A. Explicit second-order accurate method for the passive guaranteed simulation of port-Hamiltonian systems. IFAC-PapersOnLine 48, 223–228 (2015)](explicit-second-order-accurate-method-for-the-passive-guaranteed-simulation-of-port-hamiltonian-systems) -- [10.1016/j.ifacol.2015.10.243](https://doi.org/10.1016/j.ifacol.2015.10.243)
- [Falaize, A. & Hélie, T. Passive Guaranteed Simulation of Analog Audio Circuits: A Port-Hamiltonian Approach. Applied Sciences 6, 273 (2016)](passive-guaranteed-simulation-of-analog-audio-circuits-a-port-hamiltonian-approach) -- [10.3390/app6100273](https://doi.org/10.3390/app6100273)
- D’Angelo, S. & Valimaki, V. An improved virtual analog model of the Moog ladder filter. 2013 IEEE International Conference on Acoustics, Speech and Signal Processing 729–733 (2013) doi:10.1109/icassp.2013.6637744 -- [10.1109/icassp.2013.6637744](https://doi.org/10.1109/icassp.2013.6637744)
- schimmel, Non-linear Dynamics Processing. J Audio Eng Soc (2003)
- Helie, T. Volterra Series and State Transformation for Real-Time Simulations of Audio Circuits Including Saturations: Application to the Moog Ladder Filter. IEEE Trans. Audio Speech Lang. Process. 18, 747–759 (2010) -- [10.1109/tasl.2009.2035211](https://doi.org/10.1109/tasl.2009.2035211)
- schimmel, Using Nonlinear Amplifier Simulation in Dy-namic Range Comtrollers. Proc 6th Int Conf Digital Audio Effects (2003)
- yeh, Simulation of the Diode Limiter in Guitar Distortion Circuits by Numerical Solution of Ordinary Differential Equations. Proc 10th Int Conf Digital Audio Effects (2007)
- stinchcombe, Analysis of the Moog Transistor Ladder and Derivative Filters (2008)
- huovilainen, Non-Linear Digital Implementation of the Moog Ladder Filter. Proc 7th Int Conf Digital Audio Effects (2004)
- yeh, Nonlinear Modeling of a Guitar Loudspeaker Cabinet. Proc 11 th Int Conf Digital Audio Effects (2008)
- yeh, Simplified, Physically-Informed Models of Distortion and Overdrive Guitar Effects Pedals. Proc 10th Int Conf Digital Audio Effects (2007)
- yeh, Discretization of the '59 Fender Bassman Tone Stack. Proc 9th Int Conf Digital Audio Effects (2006)
- yeh, Simulating Guitar Distortion Circuits Using Wave Digital and Nonlinear State-Space For-mulations. Proc 11 th Int Conf Digital Audio Effects (2008)
- stilson, Analyzing the Moog VCF with Considerations for Digital Implementation. Proc Int Computer Music Conf (1996)
- khalil, Nonlinear Systems (2002)
- [Falaize, A. & Hélie, T. Passive modelling of the electrodynamic loudspeaker: from the Thiele–Small model to nonlinear port-Hamiltonian systems. Acta Acust. 4, 1 (2020)](passive-modelling-of-the-electrodynamic-loudspeaker-from-the-thiele-small-model-to-nonlinear-port-hamiltonian-systems) -- [10.1051/aacus/2019001](https://doi.org/10.1051/aacus/2019001)
- [Falaize, A. & Hélie, T. Passive simulation of the nonlinear port-Hamiltonian modeling of a Rhodes Piano. Journal of Sound and Vibration 390, 289–309 (2017)](passive-simulation-of-the-nonlinear-port-hamiltonian-modeling-of-a-rhodes-piano) -- [10.1016/j.jsv.2016.11.008](https://doi.org/10.1016/j.jsv.2016.11.008)
- paiva, Em-ulation of Operational Amplifiers and Diodes in Audio Dis-tortion Circuits. IEEE Trans Circ Syst II Express Briefs (2012)
- Esqueda, F., Pöntynen, H., Parker, J. & Bilbao, S. Virtual Analog Models of the Lockhart and Serge Wavefolders. Applied Sciences 7, 1328 (2017) -- [10.3390/app7121328](https://doi.org/10.3390/app7121328)
- hélie, On the Use of Volterra Series for Real-time Sim-ulations of Weakly Nonlinear Analog Audio Devices: Application to the Moog Ladder Filter. Proc 9th Int Conf Digital Audio Effects (2006)
- stinchcombe, A Study of the Korg MS10 and MS20 Filters (2006)

