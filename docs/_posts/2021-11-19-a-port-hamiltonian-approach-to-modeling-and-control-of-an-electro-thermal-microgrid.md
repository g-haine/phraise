---
layout: post
title: "A Port-Hamiltonian Approach to Modeling and Control of an Electro-Thermal Microgrid"
date: 2021-11-19 00:00:00 +0100
permalink: a-port-hamiltonian-approach-to-modeling-and-control-of-an-electro-thermal-microgrid
year: 2021
authors: Ajay Krishna, Johannes Schiffer
category: proceedings
tags:
  - Passivity-based control
  - port-Hamiltonian systems
  - multi-energy microgrids
  - district heating systems
  - distributed control
---
 
## Authors
[Ajay Krishna](authors/ajay-krishna), [Johannes Schiffer](authors/johannes-schiffer)
 
## Abstract
We address the problems of modeling and controlling multi-energy microgrids (meMGs) composed of an electrical and a thermal system, which are connected via heat pumps (HPs). At first, we model the individual subsystems in a port-Hamiltonian (pH) framework. Then, by exploiting the structural properties of pH systems, we interconnect the subsystems in a passive manner and show that the overall meMG is shifted passive with respect to the control input-output mapping. We then use this property to propose a distributed passivity based-control (PBC) that addresses frequency and temperature regulation by utilizing the resources in the meMG in a proportional fashion and renders the closed-loop equilibrium asymptotically stable.
 
## Keywords
Passivity-based control; port-Hamiltonian systems; multi-energy microgrids; district heating systems; distributed control
 
## Citation
- **Journal:** IFAC-PapersOnLine
- **Year:** 2021
- **Volume:** 54
- **Issue:** 19
- **Pages:** 287--293
- **Publisher:** Elsevier BV
- **DOI:** [10.1016/j.ifacol.2021.11.092](https://doi.org/10.1016/j.ifacol.2021.11.092)
- **Note:** 7th IFAC Workshop on Lagrangian and Hamiltonian Methods for Nonlinear Control LHMNC 2021- Berlin, Germany, 11-13 October 2021
 
## BibTeX
{% highlight bibtex %}
{% raw %}
@article{Krishna_2021,
  title={{A Port-Hamiltonian Approach to Modeling and Control of an Electro-Thermal Microgrid}},
  volume={54},
  ISSN={2405-8963},
  DOI={10.1016/j.ifacol.2021.11.092},
  number={19},
  journal={IFAC-PapersOnLine},
  publisher={Elsevier BV},
  author={Krishna, Ajay and Schiffer, Johannes},
  year={2021},
  pages={287--293}
}
{% endraw %}
{% endhighlight %}
 
[Download the bib file]({{ site.baseurl }}/assets/bib/a-port-hamiltonian-approach-to-modeling-and-control-of-an-electro-thermal-microgrid.bib)
 
## References
- Awad, B., Chaudry, M., Jianzhong Wu & Jenkins, N. Integrated optimal power flow for electric power and heat in a microgrid. IET Conference Publications 869–869 (2009) doi:10.1049/cp.2009.1037 -- [10.1049/cp.2009.1037](https://doi.org/10.1049/cp.2009.1037)
- Bidram, A., Davoudi, A., Lewis, F. L. & Qu, Z. Secondary control of microgrids based on distributed cooperative control of multi‐agent systems. IET Generation, Transmission &amp; Distribution vol. 7 822–831 (2013) -- [10.1049/iet-gtd.2012.0576](https://doi.org/10.1049/iet-gtd.2012.0576)
- [Fiaz, S., Zonetti, D., Ortega, R., Scherpen, J. M. A. & van der Schaft, A. J. A port-Hamiltonian approach to power network modeling and analysis. European Journal of Control vol. 19 477–485 (2013)](a-port-hamiltonian-approach-to-power-network-modeling-and-analysis) -- [10.1016/j.ejcon.2013.09.002](https://doi.org/10.1016/j.ejcon.2013.09.002)
- Geidl, M. & Andersson, G. Optimal Power Flow of Multiple Energy Carriers. IEEE Transactions on Power Systems vol. 22 145–155 (2007) -- [10.1109/tpwrs.2006.888988](https://doi.org/10.1109/tpwrs.2006.888988)
- Guerrero, J. M., GarciadeVicuna, L., Matas, J., Castilla, M. & Miret, J. Output Impedance Design of Parallel-Connected UPS Inverters With Wireless Load-Sharing Control. IEEE Transactions on Industrial Electronics vol. 52 1126–1135 (2005) -- [10.1109/tie.2005.851634](https://doi.org/10.1109/tie.2005.851634)
- Haddad, (2019)
- Hatziargyriou, N., Asano, H., Iravani, R. & Marnay, C. Microgrids. IEEE Power and Energy Magazine vol. 5 78–94 (2007) -- [10.1109/mpae.2007.376583](https://doi.org/10.1109/mpae.2007.376583)
- [Hauschild, S.-A. et al. Port-Hamiltonian Modeling of District Heating Networks. Differential-Algebraic Equations Forum 333–355 (2020) doi:10.1007/978-3-030-53905-4_11](port-hamiltonian-modeling-of-district-heating-networks) -- [10.1007/978-3-030-53905-4_11](https://doi.org/10.1007/978-3-030-53905-4_11)
- Horn, (2012)
- Jayawardhana, B., Ortega, R., García-Canseco, E. & Castaños, F. Passivity of nonlinear incremental systems: Application to PI stabilization of nonlinear RLC circuits. Systems &amp; Control Letters vol. 56 618–622 (2007) -- [10.1016/j.sysconle.2007.03.011](https://doi.org/10.1016/j.sysconle.2007.03.011)
- Kim, Y.-J., Norford, L. K. & Kirtley, J. L. Modeling and Analysis of a Variable Speed Heat Pump for Frequency Regulation Through Direct Load Control. IEEE Transactions on Power Systems vol. 30 397–408 (2015) -- [10.1109/tpwrs.2014.2319310](https://doi.org/10.1109/tpwrs.2014.2319310)
- Kundur, (1994)
- Lee, (2019)
- Lund, (2017)
- Mancarella, Evaluation of the impact of electric heat pumps and distributed chp on lv networks. IEEE Power Tech. (2011)
- Manias, (2017)
- [Ortega, R., van der Schaft, A., Maschke, B. & Escobar, G. Interconnection and damping assignment passivity-based control of port-controlled Hamiltonian systems. Automatica vol. 38 585–596 (2002)](interconnection-and-damping-assignment-passivity-based-control-of-port-controlled-hamiltonian-systems) -- [10.1016/s0005-1098(01)00278-3](https://doi.org/10.1016/s0005-1098(01)00278-3)
- [Ramirez, H., Maschke, B. & Sbarbaro, D. Modelling and control of multi-energy systems: An irreversible port-Hamiltonian approach. European Journal of Control vol. 19 513–520 (2013)](modelling-and-control-of-multi-energy-systems-an-irreversible-port-hamiltonian-approach) -- [10.1016/j.ejcon.2013.09.009](https://doi.org/10.1016/j.ejcon.2013.09.009)
- Schiffer, J. & Dorfler, F. On stability of a distributed averaging PI frequency and active power controlled differential-algebraic power system model. 2016 European Control Conference (ECC) 1487–1492 (2016) doi:10.1109/ecc.2016.7810500 -- [10.1109/ecc.2016.7810500](https://doi.org/10.1109/ecc.2016.7810500)
- Schiffer, J., Goldin, D., Raisch, J. & Sezi, T. Synchronization of droop-controlled microgrids with distributed rotational and electronic generation. 52nd IEEE Conference on Decision and Control 2334–2339 (2013) doi:10.1109/cdc.2013.6760229 -- [10.1109/cdc.2013.6760229](https://doi.org/10.1109/cdc.2013.6760229)
- [Schiffer, J., Ortega, R., Astolfi, A., Raisch, J. & Sezi, T. Conditions for stability of droop-controlled inverter-based microgrids. Automatica vol. 50 2457–2469 (2014)](conditions-for-stability-of-droop-controlled-inverter-based-microgrids) -- [10.1016/j.automatica.2014.08.009](https://doi.org/10.1016/j.automatica.2014.08.009)
- Scholten, T., De Persis, C. & Tesi, P. Modeling and Control of Heat Networks With Storage: The Single-Producer Multiple-Consumer Case. IEEE Transactions on Control Systems Technology vol. 25 414–428 (2017) -- [10.1109/tcst.2016.2565386](https://doi.org/10.1109/tcst.2016.2565386)
- [Stegink, T. W., De Persis, C. & Van Der Schaft, A. J. An energy-based analysis of reduced-order models of (networked) synchronous machines. Mathematical and Computer Modelling of Dynamical Systems vol. 25 1–39 (2019)](an-energy-based-analysis-of-reduced-order-models-of-networked-synchronous-machines) -- [10.1080/13873954.2019.1566265](https://doi.org/10.1080/13873954.2019.1566265)
- [Stegink, T., De Persis, C. & van der Schaft, A. A Unifying Energy-Based Approach to Stability of Power Grids With Market Dynamics. IEEE Transactions on Automatic Control vol. 62 2612–2622 (2017)](a-unifying-energy-based-approach-to-stability-of-power-grids-with-market-dynamics) -- [10.1109/tac.2016.2613901](https://doi.org/10.1109/tac.2016.2613901)
- [Strehle, F. et al. Towards Port-Hamiltonian Modeling of Multi-Carrier Energy Systems: A Case Study for a Coupled Electricity and Gas Distribution System. IFAC-PapersOnLine vol. 51 463–468 (2018)](towards-port-hamiltonian-modeling-of-multi-carrier-energy-systems-a-case-study-for-a-coupled-electricity-and-gas-distribution-system) -- [10.1016/j.ifacol.2018.03.078](https://doi.org/10.1016/j.ifacol.2018.03.078)
- van der Schaft, (2000)
- Vandermeulen, A., van der Heijde, B. & Helsen, L. Controlling district heating and cooling networks to unlock flexibility: A review. Energy vol. 151 103–115 (2018) -- [10.1016/j.energy.2018.03.034](https://doi.org/10.1016/j.energy.2018.03.034)
- Vladimarsson, District heat distribution networks. United Nations University Geothermal Training Programme (2014)

