---
layout: post
title: "Air supply control of a nonaffine proton exchange membrane fuel cell system under a port-Hamiltonian framework"
date: 2025-07-02 00:00:00 +0100
permalink: air-supply-control-of-a-nonaffine-proton-exchange-membrane-fuel-cell-system-under-a-port-hamiltonian-framework
year: 2025
authors: Lalitesh Kumar, Jian Chen, Xinyu Li
category: articles
tags:
  - Nonlinear Control
  - Nonaffine System
  - Proton Exchange Membrane Fuel Cell
  - Port-Hamiltonian Control
  - Air-supply Control
  - Oxygen Excess Ratio
  - Passivity
---
 
## Authors
[Lalitesh Kumar](authors/lalitesh-kumar), [Jian Chen](authors/jian-chen), [Xinyu Li](authors/xinyu-li)
 
## Abstract
The present work proposed a non-affine nonlinear air-supply subsystem model of proton exchange membrane fuel cell under a port-Hamiltonian framework. Furthermore, the control problem has been formulated in the port-Hamiltonian framework considering the balance between power consumption through the compressor and pressure distribution in the stack. Then, a novel passivity-based nonlinear control algorithm is developed via dynamic matching while preserving the port-Hamiltonian architecture. The main purpose of the control algorithm is to regulate the air-supply ratio and the excess oxygen in the optimal range. Finally, an explicit stability analysis of the closed-loop system is established, demonstrating that it is stable asymptotically in the domain of attraction. The simulation results demonstrate the effectiveness of the proposed control design approach.
 
## Keywords
Nonlinear Control; Nonaffine System; Proton Exchange Membrane Fuel Cell; Port-Hamiltonian Control; Air-supply Control; Oxygen Excess Ratio; Passivity
 
## Citation
- **Journal:** International Journal of Dynamics and Control
- **Year:** 2025
- **Volume:** 13
- **Issue:** 7
- **Pages:** 
- **Publisher:** Springer Science and Business Media LLC
- **DOI:** [10.1007/s40435-025-01741-3](https://doi.org/10.1007/s40435-025-01741-3)
 
## BibTeX
{% highlight bibtex %}
{% raw %}
@article{Kumar_2025,
  title={{Air supply control of a nonaffine proton exchange membrane fuel cell system under a port-Hamiltonian framework}},
  volume={13},
  ISSN={2195-2698},
  DOI={10.1007/s40435-025-01741-3},
  number={7},
  journal={International Journal of Dynamics and Control},
  publisher={Springer Science and Business Media LLC},
  author={Kumar, Lalitesh and Chen, Jian and Li, Xinyu},
  year={2025}
}
{% endraw %}
{% endhighlight %}
 
[Download the bib file]({{ site.baseurl }}/assets/bib/air-supply-control-of-a-nonaffine-proton-exchange-membrane-fuel-cell-system-under-a-port-hamiltonian-framework.bib)
 
## References
- Ogungbemi, E. et al. Fuel cell membranes – Pros and cons. Energy 172, 155–172 (2019) -- [10.1016/j.energy.2019.01.034](https://doi.org/10.1016/j.energy.2019.01.034)
- Sharma, S. & Ghoshal, S. K. Hydrogen the future transportation fuel: From production to applications. Renewable and Sustainable Energy Reviews 43, 1151–1158 (2015) -- [10.1016/j.rser.2014.11.093](https://doi.org/10.1016/j.rser.2014.11.093)
- Nayana & Chakrasali, R. L. Operation and performance of grid connected proton exchange membrane fuel cell with ultra capacitor. Int. J. Dynam. Control 8, 189–196 (2019) -- [10.1007/s40435-019-00535-8](https://doi.org/10.1007/s40435-019-00535-8)
- Dubau, L. et al. A review of <scp>PEM</scp> fuel cell durability: materials degradation, local heterogeneities of aging and possible mitigation strategies. WIREs Energy &amp; Environment 3, 540–560 (2014) -- [10.1002/wene.113](https://doi.org/10.1002/wene.113)
- Sinha, V. & Mondal, S. Recent development on performance modelling and fault diagnosis of fuel cell systems. Int. J. Dynam. Control 6, 511–528 (2017) -- [10.1007/s40435-017-0328-4](https://doi.org/10.1007/s40435-017-0328-4)
- Restrepo, C. et al. Simplified Mathematical Model for Calculating the Oxygen Excess Ratio of a PEM Fuel Cell System in Real-Time Applications. IEEE Trans. Ind. Electron. 61, 2816–2825 (2014) -- [10.1109/tie.2013.2276331](https://doi.org/10.1109/tie.2013.2276331)
- Wang, Y.-L., Wang, Y.-F. & Zhang, H.-K. Robust Adaptive Control of PEMFC Air Supply System Based on Radical Basis Function Neural Network. Journal of Dynamic Systems, Measurement, and Control 141, (2019) -- [10.1115/1.4042674](https://doi.org/10.1115/1.4042674)
- Matraji, I., Laghrouche, S., Jemei, S. & Wack, M. Robust control of the PEM fuel cell air-feed system via sub-optimal second order sliding mode. Applied Energy 104, 945–957 (2013) -- [10.1016/j.apenergy.2012.12.012](https://doi.org/10.1016/j.apenergy.2012.12.012)
- Hou, J., Yang, M., Ke, C. & Zhang, J. Control logics and strategies for air supply in PEM fuel cell engines. Applied Energy 269, 115059 (2020) -- [10.1016/j.apenergy.2020.115059](https://doi.org/10.1016/j.apenergy.2020.115059)
- Zhao, D., Li, F., Ma, R., Zhao, G. & Huangfu, Y. An Unknown Input Nonlinear Observer Based Fractional Order PID Control of Fuel Cell Air Supply System. IEEE Trans. on Ind. Applicat. 56, 5523–5532 (2020) -- [10.1109/tia.2020.2999037](https://doi.org/10.1109/tia.2020.2999037)
- Danzer, M. A., Wilhelm, J., Aschemann, H. & Hofer, E. P. Model-based control of cathode pressure and oxygen excess ratio of a PEM fuel cell system. Journal of Power Sources 176, 515–522 (2008) -- [10.1016/j.jpowsour.2007.08.049](https://doi.org/10.1016/j.jpowsour.2007.08.049)
- Zhu, J., Zhang, P., Li, X. & Jiang, B. Robust oxygen excess ratio control of PEMFC systems using adaptive dynamic programming. Energy Reports 8, 2036–2044 (2022) -- [10.1016/j.egyr.2022.01.134](https://doi.org/10.1016/j.egyr.2022.01.134)
- Chen, J., Liu, Z., Wang, F., Ouyang, Q. & Su, H. Optimal Oxygen Excess Ratio Control for PEM Fuel Cells. IEEE Trans. Contr. Syst. Technol. 26, 1711–1721 (2018) -- [10.1109/tcst.2017.2723343](https://doi.org/10.1109/tcst.2017.2723343)
- Wang, X., Chen, J., Quan, S., Wang, Y.-X. & He, H. Hierarchical model predictive control via deep learning vehicle speed predictions for oxygen stoichiometry regulation of fuel cells. Applied Energy 276, 115460 (2020) -- [10.1016/j.apenergy.2020.115460](https://doi.org/10.1016/j.apenergy.2020.115460)
- Gruber, J. K., Bordons, C. & Oliva, A. Nonlinear MPC for the airflow in a PEM fuel cell using a Volterra series model. Control Engineering Practice 20, 205–217 (2012) -- [10.1016/j.conengprac.2011.10.014](https://doi.org/10.1016/j.conengprac.2011.10.014)
- Kim, B. M. & Yoo, S. J. Decentralized event-triggered adaptive control for interconnected nonlinear dynamics of constrained air supply and thermal management systems of PEMFCs. Nonlinear Dyn 103, 791–808 (2021) -- [10.1007/s11071-020-06124-1](https://doi.org/10.1007/s11071-020-06124-1)
- Yin, L., Li, Q., Breaz, E., Chen, W. & Gao, F. Net Power Enhancement of PEMFC System Based on Dual Loop Multivariable Coordinated Management. IEEE Trans. Ind. Electron. 70, 11216–11230 (2023) -- [10.1109/tie.2023.3234144](https://doi.org/10.1109/tie.2023.3234144)
- Yin, X. et al. Cooperative control of air and fuel feeding for PEM fuel cell with ejector-driven recirculation. Applied Thermal Engineering 199, 117590 (2021) -- [10.1016/j.applthermaleng.2021.117590](https://doi.org/10.1016/j.applthermaleng.2021.117590)
- Li, M. et al. Air flow rate and pressure control approach for the air supply subsystems in PEMFCs. ISA Transactions 128, 624–634 (2022) -- [10.1016/j.isatra.2021.08.046](https://doi.org/10.1016/j.isatra.2021.08.046)
- Zhao, D., Xia, L., Dang, H., Wu, Z. & Li, H. Design and control of air supply system for PEMFC UAV based on dynamic decoupling strategy. Energy Conversion and Management 253, 115159 (2022) -- [10.1016/j.enconman.2021.115159](https://doi.org/10.1016/j.enconman.2021.115159)
- Laghrouche, S., Harmouche, M., Ahmed, F. S. & Chitour, Y. Control of PEMFC Air-Feed System Using Lyapunov-Based Robust and Adaptive Higher Order Sliding Mode Control. IEEE Trans. Contr. Syst. Technol. 23, 1594–1601 (2015) -- [10.1109/tcst.2014.2371826](https://doi.org/10.1109/tcst.2014.2371826)
- Martinez-Boggio, S. et al. Optimization of the air loop system in a hydrogen fuel cell for vehicle application. Energy Conversion and Management 283, 116911 (2023) -- [10.1016/j.enconman.2023.116911](https://doi.org/10.1016/j.enconman.2023.116911)
- L Yang, IEEE Trans Circuits Syst II Express Briefs (2025)
- Guo, X., Fan, N., Dong, Z. & Wang, C. Adaptive Prescribed Performance Control for PEM Fuel Cell Air Supply Systems With Unknown Air Compressor Faults. IEEE Trans. Ind. Electron. 71, 7664–7672 (2024) -- [10.1109/tie.2023.3312416](https://doi.org/10.1109/tie.2023.3312416)
- Wang, L., Wang, L., Liu, Z. & Su, H. Robust Regulation of Oxygen Excess Ratio and Cathode Pressure for PEMFC Air Supply Systems with Centrifugal Compressor. IECON 2023- 49th Annual Conference of the IEEE Industrial Electronics Society 1–6 (2023) doi:10.1109/iecon51785.2023.10312027 -- [10.1109/iecon51785.2023.10312027](https://doi.org/10.1109/iecon51785.2023.10312027)
- Cecilia, A. & Costa-Castelló, R. Estimation of the liquid water saturation in PEM fuel cells: A low-power peaking-free dead-zone observer approach. ISA Transactions 140, 368–384 (2023) -- [10.1016/j.isatra.2023.05.026](https://doi.org/10.1016/j.isatra.2023.05.026)
- [Wu, C., van der Schaft, A. & Chen, J. Robust trajectory tracking for incrementally passive nonlinear systems. Automatica 107, 595–599 (2019)](robust-trajectory-tracking-for-incrementally-passive-nonlinear-systems) -- [10.1016/j.automatica.2019.05.065](https://doi.org/10.1016/j.automatica.2019.05.065)
- [Wu, C., van der Schaft, A. & Chen, J. Stabilization of Port-Hamiltonian Systems Based on Shifted Passivity via Feedback. IEEE Trans. Automat. Contr. 66, 2219–2226 (2021)](stabilization-of-port-hamiltonian-systems-based-on-shifted-passivity-via-feedback) -- [10.1109/tac.2020.3005156](https://doi.org/10.1109/tac.2020.3005156)
- Wu, D., Ortega, R. & Duan, G. On universal stabilization property of Interconnection and Damping Assignment Control. Automatica 119, 109087 (2020) -- [10.1016/j.automatica.2020.109087](https://doi.org/10.1016/j.automatica.2020.109087)
- [Kölsch, L., Jané Soneira, P., Strehle, F. & Hohmann, S. Optimal control of port-Hamiltonian systems: A continuous-time learning approach. Automatica 130, 109725 (2021)](optimal-control-of-port-hamiltonian-systems-a-continuous-time-learning-approach) -- [10.1016/j.automatica.2021.109725](https://doi.org/10.1016/j.automatica.2021.109725)
- Guerrero-Sánchez, M. E., Montoya-Morales, J. R., Valencia-Palomo, G. & Hernández-González, O. Robust IDA-PBC for non-separable PCH systems under time-varying external disturbances. Nonlinear Dyn 113, 3499–3510 (2024) -- [10.1007/s11071-024-10380-w](https://doi.org/10.1007/s11071-024-10380-w)
- [Meng, X., Yu, H., Zhang, J. & Yang, Q. Adaptive EPCH strategy for nonlinear systems with parameters uncertainty and disturbances. Nonlinear Dyn 111, 7511–7524 (2023)](adaptive-epch-strategy-for-nonlinear-systems-with-parameters-uncertainty-and-disturbances) -- [10.1007/s11071-023-08243-x](https://doi.org/10.1007/s11071-023-08243-x)
- [Hoang, N. H. et al. Trajectory tracking for nonlinear systems using extended quadratic port-Hamiltonian models without input and state coordinate transformations. Systems &amp; Control Letters 167, 105325 (2022)](trajectory-tracking-for-nonlinear-systems-using-extended-quadratic-port-hamiltonian-models-without-input-and-state-coordinate-transformations) -- [10.1016/j.sysconle.2022.105325](https://doi.org/10.1016/j.sysconle.2022.105325)
- [van der Schaft, A. & Jeltsema, D. Limits to Energy Conversion. IEEE Trans. Automat. Contr. 67, 532–538 (2022)](limits-to-energy-conversion) -- [10.1109/tac.2021.3075652](https://doi.org/10.1109/tac.2021.3075652)
- Benmouna, A., Becherif, M., Chen, J., Chen, H. & Depernet, D. Interconnection and damping assignment passivity based control for fuel cell and battery vehicle: Simulation and experimentation. International Journal of Hydrogen Energy 44, 22467–22477 (2019) -- [10.1016/j.ijhydene.2019.02.045](https://doi.org/10.1016/j.ijhydene.2019.02.045)
- [Kumar, L., Chen, J., Wu, C., Chen, Y. & van der Schaft, A. A segmented model based fuel delivery control of PEM fuel cells: A port-Hamiltonian approach. Automatica 168, 111814 (2024)](a-segmented-model-based-fuel-delivery-control-of-pem-fuel-cells-a-port-hamiltonian-approach) -- [10.1016/j.automatica.2024.111814](https://doi.org/10.1016/j.automatica.2024.111814)
- [Kumar, L., Chen, J., Li, X. & Li, Z. Air Supply Control for PEM Fuel Cells Under Hamiltonian Framework: A Segmentation Approach. 2024 3rd Conference on Fully Actuated System Theory and Applications (FASTA) 337–342 (2024) doi:10.1109/fasta61401.2024.10595156](air-supply-control-for-pem-fuel-cells-under-hamiltonian-framework-a-segmentation-approach) -- [10.1109/fasta61401.2024.10595156](https://doi.org/10.1109/fasta61401.2024.10595156)
- Hilairet, M. et al. A passivity-based controller for coordination of converters in a fuel cell system. Control Engineering Practice 21, 1097–1109 (2013) -- [10.1016/j.conengprac.2013.04.003](https://doi.org/10.1016/j.conengprac.2013.04.003)
- [Mungporn, P. et al. Modeling and Control of Multiphase Interleaved Fuel-Cell Boost Converter Based on Hamiltonian Control Theory for Transportation Applications. IEEE Trans. Transp. Electrific. 6, 519–529 (2020)](modeling-and-control-of-multiphase-interleaved-fuel-cell-boost-converter-based-on-hamiltonian-control-theory-for-transportation-applications) -- [10.1109/tte.2020.2980193](https://doi.org/10.1109/tte.2020.2980193)
- Lin, W. & Byrnes, C. I. Passivity and absolute stabilization of a class of discrete-time nonlinear systems. Automatica 31, 263–267 (1995) -- [10.1016/0005-1098(94)00075-t](https://doi.org/10.1016/0005-1098(94)00075-t)
- Lin, W. Feedback stabilization of general nonlinear control systems: A passive system approach. Systems &amp; Control Letters 25, 41–52 (1995) -- [10.1016/0167-6911(94)00056-2](https://doi.org/10.1016/0167-6911(94)00056-2)
- Lin, W. Global asymptotic stabilization of general nonlinear systems with stable free dynamics via passivity and bounded feedback. Automatica 32, 915–924 (1996) -- [10.1016/0005-1098(96)00013-1](https://doi.org/10.1016/0005-1098(96)00013-1)
- Chen, X. et al. Research on control strategy of PEMFC air supply system for power and efficiency improvement. Energy 304, 132100 (2024) -- [10.1016/j.energy.2024.132100](https://doi.org/10.1016/j.energy.2024.132100)
- Kuang, J. et al. Oxygen excess ratio control of PEM fuel cell systems with prescribed regulation time. ISA Transactions 142, 683–692 (2023) -- [10.1016/j.isatra.2023.07.026](https://doi.org/10.1016/j.isatra.2023.07.026)
- Liu, Z., Chen, J., Chen, H. & Yan, C. Air supply regulation for PEMFC systems based on uncertainty and disturbance estimation. International Journal of Hydrogen Energy 43, 11559–11567 (2018) -- [10.1016/j.ijhydene.2018.01.189](https://doi.org/10.1016/j.ijhydene.2018.01.189)
- Li, Q., Chen, W., Liu, Z., Huang, J. & Ma, L. Net Power Control Based on Linear Matrix Inequality for Proton Exchange Membrane Fuel Cell System. IEEE Trans. Energy Convers. 29, 1–8 (2014) -- [10.1109/tec.2013.2292954](https://doi.org/10.1109/tec.2013.2292954)
- Li, C., Sun, Z., Wang, Y. & Wu, X. Fuzzy Sliding Mode Control of Air Supply Flow of a PEM Fuel Cell System. Lecture Notes in Electrical Engineering 933–942 (2013) doi:10.1007/978-1-4614-4981-2_101 -- [10.1007/978-1-4614-4981-2_101](https://doi.org/10.1007/978-1-4614-4981-2_101)
- Wu, C. & Chen, J. Adaptive control of linearly parameterized nonaffine nonlinear systems via dynamic matching. Intl J Robust &amp; Nonlinear 30, 7197–7215 (2020) -- [10.1002/rnc.5164](https://doi.org/10.1002/rnc.5164)
- [Ortega, R., van der Schaft, A., Maschke, B. & Escobar, G. Interconnection and damping assignment passivity-based control of port-controlled Hamiltonian systems. Automatica 38, 585–596 (2002)](interconnection-and-damping-assignment-passivity-based-control-of-port-controlled-hamiltonian-systems) -- [10.1016/s0005-1098(01)00278-3](https://doi.org/10.1016/s0005-1098(01)00278-3)
- [Li, N., Borja, P., Scherpen, J. M. A., van der Schaft, A. & Mahony, R. Passivity-Based Trajectory Tracking and Formation Control of Nonholonomic Wheeled Robots Without Velocity Measurements. IEEE Trans. Automat. Contr. 68, 7951–7957 (2023)](passivity-based-trajectory-tracking-and-formation-control-of-nonholonomic-wheeled-robots-without-velocity-measurements) -- [10.1109/tac.2023.3258320](https://doi.org/10.1109/tac.2023.3258320)
- Gu, Y., Li, W. & He, X. Passivity-Based Control of DC Microgrid for Self-Disciplined Stabilization. IEEE Trans. Power Syst. 30, 2623–2632 (2015) -- [10.1109/tpwrs.2014.2360300](https://doi.org/10.1109/tpwrs.2014.2360300)
- Zhang, W. & Ge, S. S. A global Implicit Function Theorem without initial point and its applications to control of non-affine systems of high dimensions. Journal of Mathematical Analysis and Applications 313, 251–261 (2006) -- [10.1016/j.jmaa.2005.08.072](https://doi.org/10.1016/j.jmaa.2005.08.072)
- I Barbalat, Revue Roumaine de Math é matique Pures et Appliqu é es (1959)
- Tao, G. A simple alternative to the Barbalat lemma. IEEE Trans. Automat. Contr. 42, 698 (1997) -- [10.1109/9.580878](https://doi.org/10.1109/9.580878)
- Bálint Farkas & Sven-Ake Wegner. Variations on Barbălat’s Lemma. The American Mathematical Monthly 123, 825 (2016) -- [10.4169/amer.math.monthly.123.8.825](https://doi.org/10.4169/amer.math.monthly.123.8.825)

