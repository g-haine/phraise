---
layout: post
title: "Energy shaping dynamic tube-MPC for underactuated mechanical systems"
date: 2021-09-12 00:00:00 +0100
permalink: energy-shaping-dynamic-tube-mpc-for-underactuated-mechanical-systems
year: 2021
authors: Guaraci Bastos, Enrico Franco
category: articles
tags:
  - Underactuated systems
  - Port-Hamiltonian systems
  - Robust control
  - IDA-PBC
  - Dynamic tube-MPC
---
 
## Authors
[Guaraci Bastos](authors/guaraci-bastos), [Enrico Franco](authors/enrico-franco)
 
## Abstract
This work investigates the tracking control problem for underactuated mechanical systems. To this end, we develop an extension of the dynamic tube Model Predictive Control (MPC) approach by combining an MPC design, an ancillary energy shaping controller constructed with the Interconnection and Damping Assignment Passivity-Based Control methodology, and an analytical expression of the dynamic tube. In addition, we extend the proposed approach by including the adaptive compensation of a class of unknown disturbances. The stability analysis is presented by employing a Lyapunov approach. The effectiveness of the proposed controller is demonstrated with simulations on two underactuated systems: a two-mass-spring-damper system with uncertain damping and either linear or nonlinear spring; an inertia-wheel-pendulum with unmodeled disturbances.
 
## Keywords
Underactuated systems; Port-Hamiltonian systems; Robust control; IDA-PBC; Dynamic tube-MPC
 
## Citation
- **Journal:** Nonlinear Dynamics
- **Year:** 2021
- **Volume:** 106
- **Issue:** 1
- **Pages:** 359--380
- **Publisher:** Springer Science and Business Media LLC
- **DOI:** [10.1007/s11071-021-06863-9](https://doi.org/10.1007/s11071-021-06863-9)
 
## BibTeX
{% highlight bibtex %}
{% raw %}
@article{Bastos_2021,
  title={{Energy shaping dynamic tube-MPC for underactuated mechanical systems}},
  volume={106},
  ISSN={1573-269X},
  DOI={10.1007/s11071-021-06863-9},
  number={1},
  journal={Nonlinear Dynamics},
  publisher={Springer Science and Business Media LLC},
  author={Bastos, Guaraci and Franco, Enrico},
  year={2021},
  pages={359--380}
}
{% endraw %}
{% endhighlight %}
 
[Download the bib file]({{ site.baseurl }}/assets/bib/energy-shaping-dynamic-tube-mpc-for-underactuated-mechanical-systems.bib)
 
## References
- F Allgower. Allgower, F., Findeisen, R., Nagy, Z.K.: Nonlinear model predictive control: from theory to application. J. Chin. Inst. Chem. Eng. 35(3), 299–315 (2004) (2004)
- Arnold, M. & Brüls, O. Convergence of the generalized-α scheme for constrained mechanical systems. Multibody System Dynamics vol. 18 185–202 (2007) -- [10.1007/s11044-007-9084-0](https://doi.org/10.1007/s11044-007-9084-0)
- Astolfi, A. & Ortega, R. Immersion and invariance: a new tool for stabilization and adaptive control of nonlinear systems. IEEE Transactions on Automatic Control vol. 48 590–606 (2003) -- [10.1109/tac.2003.809820](https://doi.org/10.1109/tac.2003.809820)
- Bastos, G., Jr. A Synergistic Optimal Design for Trajectory Tracking of Underactuated Manipulators. Journal of Dynamic Systems, Measurement, and Control vol. 141 (2018) -- [10.1115/1.4041530](https://doi.org/10.1115/1.4041530)
- Bastos Jr., G. A stable reentry trajectory for flexible manipulators. International Journal of Control vol. 94 1297–1308 (2019) -- [10.1080/00207179.2019.1644538](https://doi.org/10.1080/00207179.2019.1644538)
- Bastos, G., Jr. & Brüls, O. Analysis of open-loop control design and parallel computation for underactuated manipulators. Acta Mechanica vol. 231 2439–2456 (2020) -- [10.1007/s00707-020-02656-0](https://doi.org/10.1007/s00707-020-02656-0)
- Bastos, G., Jr., Seifried, R. & Brüls, O. Analysis of stable model inversion methods for constrained underactuated mechanical systems. Mechanism and Machine Theory vol. 111 99–117 (2017) -- [10.1016/j.mechmachtheory.2017.01.011](https://doi.org/10.1016/j.mechmachtheory.2017.01.011)
- Berger, T., Otto, S., Reis, T. & Seifried, R. Combined open-loop and funnel control for underactuated multibody systems. Nonlinear Dynamics vol. 95 1977–1998 (2018) -- [10.1007/s11071-018-4672-5](https://doi.org/10.1007/s11071-018-4672-5)
- Berger, T., Drücker, S., Lanza, L., Reis, T. & Seifried, R. Tracking control for underactuated non-minimum phase multibody systems. Nonlinear Dynamics vol. 104 3671–3699 (2021) -- [10.1007/s11071-021-06458-4](https://doi.org/10.1007/s11071-021-06458-4)
- Biegler, L. T. Efficient Solution of Dynamic Optimization and NMPC Problems. Nonlinear Model Predictive Control 219–243 (2000) doi:10.1007/978-3-0348-8407-5_13 -- [10.1007/978-3-0348-8407-5_13](https://doi.org/10.1007/978-3-0348-8407-5_13)
- R Blauwkamp. Blauwkamp, R., Basar, T.: Receding-horizon approach to robust output feedback control for nonlinear systems. Proc IEEE Conf Decis Control 5, 4879–4884 (1999) (1999)
- Brüls, O., Bastos, G. Jr. & Seifried, R. A Stable Inversion Method for Feedforward Control of Constrained Flexible Multibody Systems. Journal of Computational and Nonlinear Dynamics vol. 9 (2013) -- [10.1115/1.4025476](https://doi.org/10.1115/1.4025476)
- Chen, C. C. & Shaw, L. On receding horizon feedback control. Automatica vol. 18 349–352 (1982) -- [10.1016/0005-1098(82)90096-6](https://doi.org/10.1016/0005-1098(82)90096-6)
- CHEN, H. & ALLGöWER, F. A Quasi-Infinite Horizon Nonlinear Model Predictive Control Scheme with Guaranteed Stability∗∗This paper was not presented at any IFAC meeting. This paper was accepted for publication in revised form by Associate Editor W. Bequette under the direction of Editor Prof. S. Skogestad. Automatica vol. 34 1205–1217 (1998) -- [10.1016/s0005-1098(98)00073-9](https://doi.org/10.1016/s0005-1098(98)00073-9)
- FL Chernousko. Chernousko, F.L., Bolotnik, N.N., Gradetsky, V.: Manipulation Robots—Dynamics, Control and Optimizational. CRC Press, Boca Raton (1994) (1994)
- Chung, J. & Hulbert, G. M. A Time Integration Algorithm for Structural Dynamics With Improved Numerical Dissipation: The Generalized-α Method. Journal of Applied Mechanics vol. 60 371–375 (1993) -- [10.1115/1.2900803](https://doi.org/10.1115/1.2900803)
- Diehl, M., Bock, H. G. & Schlöder, J. P. A Real-Time Iteration Scheme for Nonlinear Optimization in Optimal Feedback Control. SIAM Journal on Control and Optimization vol. 43 1714–1736 (2005) -- [10.1137/s0363012902400713](https://doi.org/10.1137/s0363012902400713)
- Diehl, M., Findeisen, R., Bock, H. G., Allgöwer, F. & Schlöder, J. P. Nominal stability of real-time iteration scheme for nonlinear model predictive control. IEE Proceedings - Control Theory and Applications vol. 152 296–308 (2005) -- [10.1049/ip-cta:20040008](https://doi.org/10.1049/ip-cta:20040008)
- Dong, Z. & Angeli, D. Homothetic tube-based robust offset-free economic Model Predictive Control. Automatica vol. 119 109105 (2020) -- [10.1016/j.automatica.2020.109105](https://doi.org/10.1016/j.automatica.2020.109105)
- El-Ferik, S. RMPC for Uncertain Nonlinear Systems With Non-Additive Dynamic Disturbances and Noisy Measurements. IEEE Access vol. 8 44846–44857 (2020) -- [10.1109/access.2020.2975535](https://doi.org/10.1109/access.2020.2975535)
- Fesharaki, S. J., Kamali, M., Sheikholeslam, F. & Talebi, H. A. Robust model predictive control with sliding mode for constrained non‐linear systems. IET Control Theory &amp; Applications vol. 14 2592–2599 (2020) -- [10.1049/iet-cta.2019.1357](https://doi.org/10.1049/iet-cta.2019.1357)
- Franco, E. Discrete-Time IDA-PBC for Underactuated Mechanical Systems with Input-Delay and Matched Disturbances. 2018 26th Mediterranean Conference on Control and Automation (MED) 1–9 (2018) doi:10.1109/med.2018.8442979 -- [10.1109/med.2018.8442979](https://doi.org/10.1109/med.2018.8442979)
- Franco, E. Immersion and invariance adaptive control for discrete‐time systems in strict‐feedback form with input delay and disturbances. International Journal of Adaptive Control and Signal Processing vol. 32 69–82 (2017) -- [10.1002/acs.2825](https://doi.org/10.1002/acs.2825)
- Franco, E. Adaptive IDA‐PBC for underactuated mechanical systems with constant disturbances. International Journal of Adaptive Control and Signal Processing vol. 33 1–15 (2018) -- [10.1002/acs.2947](https://doi.org/10.1002/acs.2947)
- Franco, E. & Garriga-Casanovas, A. Energy-shaping control of soft continuum manipulators with in-plane disturbances. The International Journal of Robotics Research vol. 40 236–255 (2020) -- [10.1177/0278364920907679](https://doi.org/10.1177/0278364920907679)
- [Franco, E., Garriga Casanovas, A. & Donaire, A. Energy shaping control with integral action for soft continuum manipulators. Mechanism and Machine Theory vol. 158 104250 (2021)](energy-shaping-control-with-integral-action-for-soft-continuum-manipulators) -- [10.1016/j.mechmachtheory.2021.104250](https://doi.org/10.1016/j.mechmachtheory.2021.104250)
- [Franco, E., Rodriguez y Baena, F. & Astolfi, A. Robust dynamic state feedback for underactuated systems with linearly parameterized disturbances. International Journal of Robust and Nonlinear Control vol. 30 4112–4128 (2020)](robust-dynamic-state-feedback-for-underactuated-systems-with-linearly-parameterized-disturbances) -- [10.1002/rnc.4985](https://doi.org/10.1002/rnc.4985)
- [Gómez-Estern, F. & Van der Schaft, A. J. Physical Damping in IDA-PBC Controlled Underactuated Mechanical Systems. European Journal of Control vol. 10 451–468 (2004)](physical-damping-in-ida-pbc-controlled-underactuated-mechanical-systems) -- [10.3166/ejc.10.451-468](https://doi.org/10.3166/ejc.10.451-468)
- Gritli, H., Khraief, N., Chemori, A. & Belghith, S. Self-generated limit cycle tracking of the underactuated inertia wheel inverted pendulum under IDA-PBC. Nonlinear Dynamics vol. 89 2195–2226 (2017) -- [10.1007/s11071-017-3578-y](https://doi.org/10.1007/s11071-017-3578-y)
- L Grüne. Grüne, L., Baillieul, J., Samad, T.: Nominal Model-Predictive Control, pp. 1–6. Springer, London (2019) (2019)
- Grüne, L. & Pannek, J. Nonlinear Model Predictive Control. Communications and Control Engineering (Springer International Publishing, 2017). doi:10.1007/978-3-319-46024-6 -- [10.1007/978-3-319-46024-6](https://doi.org/10.1007/978-3-319-46024-6)
- Isidori, A. Nonlinear Control Systems. Communications and Control Engineering (Springer London, 1995). doi:10.1007/978-1-84628-615-5 -- [10.1007/978-1-84628-615-5](https://doi.org/10.1007/978-1-84628-615-5)
- Korayem, M. H. & Nohooji, H. R. Trajectory Optimization of Flexible Mobile Manipulators Using Open-Loop Optimal Control Method. Lecture Notes in Computer Science 54–63 (2008) doi:10.1007/978-3-540-88513-9_7 -- [10.1007/978-3-540-88513-9_7](https://doi.org/10.1007/978-3-540-88513-9_7)
- Liu, H. & Chen, G. Robust trajectory tracking control of marine surface vessels with uncertain disturbances and input saturations. Nonlinear Dynamics vol. 100 3513–3528 (2020) -- [10.1007/s11071-020-05701-8](https://doi.org/10.1007/s11071-020-05701-8)
- Liu, P., Yu, H. & Cang, S. Adaptive neural network tracking control for underactuated systems with matched and mismatched disturbances. Nonlinear Dynamics vol. 98 1447–1464 (2019) -- [10.1007/s11071-019-05170-8](https://doi.org/10.1007/s11071-019-05170-8)
- Lopez, B. T., Slotine, J.-J. E. & How, J. P. Dynamic Tube MPC for Nonlinear Systems. 2019 American Control Conference (ACC) 1655–1662 (2019) doi:10.23919/acc.2019.8814758 -- [10.23919/acc.2019.8814758](https://doi.org/10.23919/acc.2019.8814758)
- Magni, L. & Sepulchre, R. Stability margins of nonlinear receding-horizon control via inverse optimality. Systems &amp; Control Letters vol. 32 241–245 (1997) -- [10.1016/s0167-6911(97)00079-0](https://doi.org/10.1016/s0167-6911(97)00079-0)
- Mayne, D. Q. Model predictive control: Recent developments and future promise. Automatica vol. 50 2967–2986 (2014) -- [10.1016/j.automatica.2014.10.128](https://doi.org/10.1016/j.automatica.2014.10.128)
- Mayne, D. Q. Competing methods for robust and stochastic MPC. IFAC-PapersOnLine vol. 51 169–174 (2018) -- [10.1016/j.ifacol.2018.11.010](https://doi.org/10.1016/j.ifacol.2018.11.010)
- Mayne, D. Q., Kerrigan, E. C., van Wyk, E. J. & Falugi, P. Tube‐based robust nonlinear model predictive control. International Journal of Robust and Nonlinear Control vol. 21 1341–1353 (2011) -- [10.1002/rnc.1758](https://doi.org/10.1002/rnc.1758)
- Mayne, D. Q., Rawlings, J. B., Rao, C. V. & Scokaert, P. O. M. Constrained model predictive control: Stability and optimality. Automatica vol. 36 789–814 (2000) -- [10.1016/s0005-1098(99)00214-9](https://doi.org/10.1016/s0005-1098(99)00214-9)
- NM Newmark. Newmark, N.M.: A method of computation for structural dynamics. J. Eng. Mech. 85, 67–94 (1959) (1959)
- Nikou, A. & Dimarogonas, D. V. Decentralized tube‐based model predictive control of uncertain nonlinear multiagent systems. International Journal of Robust and Nonlinear Control vol. 29 2799–2818 (2019) -- [10.1002/rnc.4522](https://doi.org/10.1002/rnc.4522)
- Ortega, R., Spong, M. W., Gomez-Estern, F. & Blankenstein, G. Stabilization of a class of underactuated mechanical systems via interconnection and damping assignment. IEEE Transactions on Automatic Control vol. 47 1218–1233 (2002) -- [10.1109/tac.2002.800770](https://doi.org/10.1109/tac.2002.800770)
- Prado, Á. J., Torres-Torriti, M., Yuz, J. & Auat Cheein, F. Tube-based nonlinear model predictive control for autonomous skid-steer mobile robots with tire–terrain interactions. Control Engineering Practice vol. 101 104451 (2020) -- [10.1016/j.conengprac.2020.104451](https://doi.org/10.1016/j.conengprac.2020.104451)
- Ryalat, M. & Laila, D. S. A simplified IDA-PBC design for underactuated mechanical systems with applications. European Journal of Control vol. 27 1–16 (2016) -- [10.1016/j.ejcon.2015.12.001](https://doi.org/10.1016/j.ejcon.2015.12.001)
- Sastry, S. Nonlinear Systems. Interdisciplinary Applied Mathematics (Springer New York, 1999). doi:10.1007/978-1-4757-3108-8 -- [10.1007/978-1-4757-3108-8](https://doi.org/10.1007/978-1-4757-3108-8)
- Scokaert, P. O. M. & Rawlings, J. B. Stability of model predictive control under perturbations. Nonlinear Control Systems Design 1995 19–24 (1995) doi:10.1016/b978-0-08-042371-5.50007-1 -- [10.1016/b978-0-08-042371-5.50007-1](https://doi.org/10.1016/b978-0-08-042371-5.50007-1)
- Sebghati, A. & Shamaghdari, S. Tube‐based robust economic <scp>model predictive control</scp> with practical and relaxed stability guarantees and its application to smart grid. International Journal of Robust and Nonlinear Control vol. 30 7533–7559 (2020) -- [10.1002/rnc.5192](https://doi.org/10.1002/rnc.5192)
- Seifried, R. Dynamics of Underactuated Multibody Systems. Solid Mechanics and Its Applications (Springer International Publishing, 2014). doi:10.1007/978-3-319-01228-5 -- [10.1007/978-3-319-01228-5](https://doi.org/10.1007/978-3-319-01228-5)
- [Yaghmaei, A. & Yazdanpanah, M. J. Trajectory tracking for a class of contractive port Hamiltonian systems. Automatica vol. 83 331–336 (2017)](trajectory-tracking-for-a-class-of-contractive-port-hamiltonian-systems) -- [10.1016/j.automatica.2017.06.039](https://doi.org/10.1016/j.automatica.2017.06.039)
- Yi, B., Ortega, R., Manchester, I. R. & Siguerdidjane, H. Path following of a class of underactuated mechanical systems via immersion and invariance‐based orbital stabilization. International Journal of Robust and Nonlinear Control vol. 30 8521–8544 (2020) -- [10.1002/rnc.5258](https://doi.org/10.1002/rnc.5258)
- Yu, S., Maier, C., Chen, H. & Allgöwer, F. Tube MPC scheme based on robust control invariant set with application to Lipschitz nonlinear systems. Systems &amp; Control Letters vol. 62 194–200 (2013) -- [10.1016/j.sysconle.2012.11.004](https://doi.org/10.1016/j.sysconle.2012.11.004)
- Zhang, A., Yang, C., Gong, S. & Qiu, J. Nonlinear stabilizing control of underactuated inertia wheel pendulum based on coordinate transformation and time-reverse strategy. Nonlinear Dynamics vol. 84 2467–2476 (2016) -- [10.1007/s11071-016-2658-8](https://doi.org/10.1007/s11071-016-2658-8)
- Zhang, P., Wu, Z., Meng, Y., Tan, M. & Yu, J. Nonlinear model predictive position control for a tail-actuated robotic fish. Nonlinear Dynamics vol. 101 2235–2247 (2020) -- [10.1007/s11071-020-05963-2](https://doi.org/10.1007/s11071-020-05963-2)

