---
layout: post
title: "Energy shaping dynamic tube-MPC for underactuated mechanical systems"
date: 2021-09-12 00:00:00 +0100
permalink: energy-shaping-dynamic-tube-mpc-for-underactuated-mechanical-systems
year: 2021
authors: Guaraci Bastos, Enrico Franco
category: articles
tags:
  - Underactuated systems
  - Port-Hamiltonian systems
  - Robust control
  - IDA-PBC
  - Dynamic tube-MPC
---
 
## Authors
[Guaraci Bastos](authors/guaraci_bastos), [Enrico Franco](authors/enrico_franco)
 
## Abstract
This work investigates the tracking control problem for underactuated mechanical systems. To this end, we develop an extension of the dynamic tube Model Predictive Control (MPC) approach by combining an MPC design, an ancillary energy shaping controller constructed with the Interconnection and Damping Assignment Passivity-Based Control methodology, and an analytical expression of the dynamic tube. In addition, we extend the proposed approach by including the adaptive compensation of a class of unknown disturbances. The stability analysis is presented by employing a Lyapunov approach. The effectiveness of the proposed controller is demonstrated with simulations on two underactuated systems: a two-mass-spring-damper system with uncertain damping and either linear or nonlinear spring; an inertia-wheel-pendulum with unmodeled disturbances.
 
## Keywords
Underactuated systems; Port-Hamiltonian systems; Robust control; IDA-PBC; Dynamic tube-MPC
 
## Citation
- **Journal:** Nonlinear Dynamics
- **Year:** 2021
- **Volume:** 106
- **Issue:** 1
- **Pages:** 359--380
- **Publisher:** Springer Science and Business Media LLC
- **DOI:** [10.1007/s11071-021-06863-9](https://doi.org/10.1007/s11071-021-06863-9)
 
## BibTeX
{% highlight bibtex %}
{% raw %}
@article{Bastos_2021,
  title={{Energy shaping dynamic tube-MPC for underactuated mechanical systems}},
  volume={106},
  ISSN={1573-269X},
  DOI={10.1007/s11071-021-06863-9},
  number={1},
  journal={Nonlinear Dynamics},
  publisher={Springer Science and Business Media LLC},
  author={Bastos, Guaraci and Franco, Enrico},
  year={2021},
  pages={359--380}
}
{% endraw %}
{% endhighlight %}
 
## References
- Allgower, F., Findeisen, R., Nagy, Z.K.: Nonlinear model predictive control: from theory to application. J. Chin. Inst. Chem. Eng. 35(3), 299–315 (2004)
- Arnold, M., Brüls, O.: Convergence of the generalized-$$lpha $$ scheme for constrained mechanical systems. Multibody Syst. Dyn. 18(2), 185–202 (2007) -- [10.1007/s11044-007-9084-0](https://doi.org/10.1007/s11044-007-9084-0)
- Astolfi, A., Ortega, R.: Immersion and invariance: a new tool for stabilization and adaptive control of nonlinear systems. IEEE Trans. Autom. Control 48(4), 590–606 (2003) -- [10.1109/TAC.2003.809820](https://doi.org/10.1109/TAC.2003.809820)
- Bastos, G.: A synergistic optimal design for trajectory tracking of underactuated manipulators. J. Dyn. Syst. Meas. Control 141(2), 021015 (2018) -- [10.1115/1.4041530](https://doi.org/10.1115/1.4041530)
- Bastos, G.: A stable reentry trajectory for flexible manipulators. Int. J. Control 94(5), 1297–1308 (2021) -- [10.1080/00207179.2019.1644538](https://doi.org/10.1080/00207179.2019.1644538)
- Bastos, G., Brüls, O.: Analysis of open-loop control design and parallel computation for underactuated manipulators. Acta Mech. 231, 2439–2456 (2020) -- [10.1007/s00707-020-02656-0](https://doi.org/10.1007/s00707-020-02656-0)
- Bastos, G., Seifried, R., Brüls, O.: Analysis of stable model inversion methods for constrained underactuated mechanical systems. Mech. Mach. Theory 111, 99–117 (2017) -- [10.1016/j.mechmachtheory.2017.01.011](https://doi.org/10.1016/j.mechmachtheory.2017.01.011)
- Berger, T., Otto, S., Reis, T., Seifried, R.: Combined open-loop and funnel control for underactuated multibody systems. Nonlinear Dyn. 95, 1977–98 (2020) -- [10.1007/s11071-018-4672-5](https://doi.org/10.1007/s11071-018-4672-5)
- Berger, T., Drücker, S., Lanza, L., Reis, T., Seifried, R.: Tracking control for underactuated non-minimum phase multibody systems. Nonlinear Dyn. 104(4), 3671–3699 (2021) -- [10.1007/s11071-021-06458-4](https://doi.org/10.1007/s11071-021-06458-4)
- Biegler, L.T.: Efficient solution of dynamic optimization and NMPC problems. In: Allgöwer, F., Zheng, A. (eds.) Nonlinear model predictive control, pp. 219–243. Birkhäuser, Basel (2000) -- [10.1007/978-3-0348-8407-5_13](https://doi.org/10.1007/978-3-0348-8407-5_13)
- Blauwkamp, R., Basar, T.: Receding-horizon approach to robust output feedback control for nonlinear systems. Proc IEEE Conf Decis Control 5, 4879–4884 (1999)
- Brüls, O., Bastos, G., Seifried, R.: A stable inversion method for constrained feedforward control of flexible multibody systems. J. Comput. Nonlinear Dyn. 9, 011014 (2014) -- [10.1115/1.4025476](https://doi.org/10.1115/1.4025476)
- Chen, C., Shaw, L.: On receding horizon feedback control. Automatica 18(3), 349–352 (1982) -- [10.1016/0005-1098(82)90096-6](https://doi.org/10.1016/0005-1098(82)90096-6)
- Chen, H., Allgower, F.: A quasi-infinite horizon nonlinear model predictive control scheme with guaranteed stability. Automatica 34(10), 1205–1217 (1998) -- [10.1016/S0005-1098(98)00073-9](https://doi.org/10.1016/S0005-1098(98)00073-9)
- Chernousko, F.L., Bolotnik, N.N., Gradetsky, V.: Manipulation Robots—Dynamics, Control and Optimizational. CRC Press, Boca Raton (1994)
- Chung, J., Hulbert, G.M.: A time integration algorithm for structural dynamics with improved numerical dissipation: the generalized-$$lpha $$ method. ASME J. Appl. Mech. 60, 371–375 (1993) -- [10.1115/1.2900803](https://doi.org/10.1115/1.2900803)
- Diehl, M., Bock, H.G., Schloder, J.: A real-time iteration scheme for nonlinear optimization in optimal feedback control. SIAM J. Control Optim. 43(5), 1714–1736 (2005) -- [10.1137/S0363012902400713](https://doi.org/10.1137/S0363012902400713)
- Diehl, M., Findeisen, R., Allgöwer, F., Bock, H.G., Schlöder, J.P.: Nominal stability of real-time iteration scheme for nonlinear model predictive control. IEE Proc. Control Theory Appl. 152, 296–308 (2005) -- [10.1049/ip-cta:20040008](https://doi.org/10.1049/ip-cta:20040008)
- Dong, Z., Angeli, D.: Homothetic tube-based robust offset-free economic model predictive control. Automatica 119, 109105 (2020) -- [10.1016/j.automatica.2020.109105](https://doi.org/10.1016/j.automatica.2020.109105)
- El-Ferik, S.: RMPC for uncertain nonlinear systems with non-additive dynamic disturbances and noisy measurements. IEEE Access 8, 44846–44857 (2020) -- [10.1109/ACCESS.2020.2975535](https://doi.org/10.1109/ACCESS.2020.2975535)
- Fesharak, S.J., Kamali, M., Sheikholeslam, F., Talebi, H.A.: Robust model predictive control with sliding mode for constrained non-linear systems. IET Control Theory Appl. 14, 2592–2599 (2020) -- [10.1049/iet-cta.2019.1357](https://doi.org/10.1049/iet-cta.2019.1357)
- Franco, E.: Discrete-time IDA-PBC for underactuated mechanical systems with input-delay and matched disturbances. In: 26th Mediterranean Conference on Control and Automation, Zadar, pp. 747–752. IEEE (2018) -- [10.1109/MED.2018.8442979](https://doi.org/10.1109/MED.2018.8442979)
- Franco, E.: Immersion and invariance adaptive control for discrete-time systems in strict-feedback form with input delay and disturbances. Int. J. Adapt. Control Signal Process. 32(1), 69–82 (2018) -- [10.1002/acs.2825](https://doi.org/10.1002/acs.2825)
- Franco, E.: Adaptive IDA-PBC for underactuated mechanical systems with constant disturbances. Int. J. Adapt. Control Signal Process. 33(1), 1–15 (2019) -- [10.1002/acs.2947](https://doi.org/10.1002/acs.2947)
- Franco, E., Garriga-Casanovas, A.: Energy-shaping control of soft continuum manipulators with in-plane disturbances. Int. J. Robot. Res. 40(1), 236–255 (2021) -- [10.1177/0278364920907679](https://doi.org/10.1177/0278364920907679)
- [Franco, E., Garriga Casanovas, A., Donaire, A.: Energy shaping control with integral action for soft continuum manipulators. Mech. Mach. Theory 158, 104250 (2021)](energy-shaping-control-with-integral-action-for-soft-continuum-manipulators) -- [10.1016/j.mechmachtheory.2021.104250](https://doi.org/10.1016/j.mechmachtheory.2021.104250)
- Franco, E., Rodriguez y Baena, F., Astolfi, A.: Robust dynamic state feedback for underactuated systems with linearly parameterized disturbances. Int. J. Robust Nonlinear Control 30(10), 4112–4128 (2020) -- [10.1002/rnc.4985](https://doi.org/10.1002/rnc.4985)
- [Gómez-Estern, F., Van der Schaft, A.J.: Physical damping in IDA-PBC controlled underactuated mechanical systems. Eur. J. Control 10(5), 451–468 (2004)](physical-damping-in-ida-pbc-controlled-underactuated-mechanical-systems) -- [10.3166/ejc.10.451-468](https://doi.org/10.3166/ejc.10.451-468)
- Gritli, H., Khraief, N., Chemori, A., Belghith, S.: Self-generated limit cycle tracking of the underactuated inertia wheel inverted pendulum under IDA-PBC. Nonlinear Dyn. 89(3), 2195–2226 (2017) -- [10.1007/s11071-017-3578-y](https://doi.org/10.1007/s11071-017-3578-y)
- Grüne, L., Baillieul, J., Samad, T.: Nominal Model-Predictive Control, pp. 1–6. Springer, London (2019)
- Grune, L., Pannek, J.: Nonlinear Model Predictive Control: Theory and Algorithms. Springer, Berlin (2017) -- [10.1007/978-3-319-46024-6](https://doi.org/10.1007/978-3-319-46024-6)
- Isidori, A.: Nonlinear Control Systems, 3rd edn. Springer, London (1995) -- [10.1007/978-1-84628-615-5](https://doi.org/10.1007/978-1-84628-615-5)
- Korayem, M.H., Nohooji, H.R.: Trajectory optimization of flexible mobile manipulators using open-loop optimal control method. LNCS Lect. Notes Comput. Sci. 5314, 54–63 (2008) -- [10.1007/978-3-540-88513-9_7](https://doi.org/10.1007/978-3-540-88513-9_7)
- Liu, H., Chen, G.: Robust trajectory tracking control of marine surface vessels with uncertain disturbances and input saturations. Nonlinear Dyn. 100, 3513–28 (2020) -- [10.1007/s11071-020-05701-8](https://doi.org/10.1007/s11071-020-05701-8)
- Liu, P., Yu, H., Cang, S.: Adaptive neural network tracking control for underactuated systems with matched and mismatched disturbancesl. Nonlinear Dyn. 98, 1447–64 (2019) -- [10.1007/s11071-019-05170-8](https://doi.org/10.1007/s11071-019-05170-8)
- Lopez, B.T., Slotine, J.E., How, J.P.: Dynamic tube MPC for nonlinear systems. In: 2019 American Control Conference (ACC), pp. 1655–1662. IEEE (2019) -- [10.23919/ACC.2019.8814758](https://doi.org/10.23919/ACC.2019.8814758)
- Magni, L., Sepulchre, R.: Stability margins of nonlinear receding horizon control via inverse optimality. Syst. Control Lett. 32(4), 241–245 (1997) -- [10.1016/S0167-6911(97)00079-0](https://doi.org/10.1016/S0167-6911(97)00079-0)
- Mayne, D.Q.: Model predictive control: recent developments and future promise. Automatica 50(12), 2967–2986 (2014) -- [10.1016/j.automatica.2014.10.128](https://doi.org/10.1016/j.automatica.2014.10.128)
- Mayne, D.Q.: Competing methods for robust and stochastic MPC. IFAC Pap. Online 51(20), 169–174 (2018) -- [10.1016/j.ifacol.2018.11.010](https://doi.org/10.1016/j.ifacol.2018.11.010)
- Mayne, D.Q., Kerrigan, E.C., van Wyk, E.J., Falugi, P.: Tube-based robust nonlinear model predictive control. Int. J. Robust Nonlinear Control 21(11), 1341–1353 (2011) -- [10.1002/rnc.1758](https://doi.org/10.1002/rnc.1758)
- Mayne, D.Q., Rawlings, J.B., Rao, C.V., Scokaert, P.O.M.: Constrainerd model predictive control: stability and control. Automatica 36, 789–814 (2000) -- [10.1016/S0005-1098(99)00214-9](https://doi.org/10.1016/S0005-1098(99)00214-9)
- Newmark, N.M.: A method of computation for structural dynamics. J. Eng. Mech. 85, 67–94 (1959)
- Nikou, A., Dimarogonas, D.V.: Decentralized tube-based model predictive control of uncertain nonlinear multiagent systems. Int. J. Robust Nonlinear Control 29(10), 2799–2818 (2019) -- [10.1002/rnc.4522](https://doi.org/10.1002/rnc.4522)
- Ortega, R., Spong, M.W., Gomez-Estern, F., Blankenstein, G.: Stabilization of a class of underactuated mechanical systems via interconnection and damping assignment. IEEE Trans. Autom. Control 47(8), 1218–1233 (2002) -- [10.1109/TAC.2002.800770](https://doi.org/10.1109/TAC.2002.800770)
- Prado, Á.J., Torres-Torriti, M., Yuz, J., Auat Cheein, F.: Tube-based nonlinear model predictive control for autonomous skid-steer mobile robots with tire-terrain interactions. Control Eng. Pract. 101, 104451 (2020) -- [10.1016/j.conengprac.2020.104451](https://doi.org/10.1016/j.conengprac.2020.104451)
- Ryalat, M., Laila, D.S.: A simplified IDA-PBC design for underactuated mechanical systems with applications. Eur. J. Control 27, 1–16 (2016) -- [10.1016/j.ejcon.2015.12.001](https://doi.org/10.1016/j.ejcon.2015.12.001)
- Sastry, S.: Nonlinear Systems: Analysis, Stability and Control. Springer, Berlin (1999) -- [10.1007/978-1-4757-3108-8](https://doi.org/10.1007/978-1-4757-3108-8)
- Scokaert, P., Rawlings, J.: Stability of model predictive control under perturbations. In: IFAC Proceedings, vol 12, pp 19–24 (1995) -- [10.1016/B978-0-08-042371-5.50007-1](https://doi.org/10.1016/B978-0-08-042371-5.50007-1)
- Sebghati, A., Shamaghdari, S.: Tube-based robust economic model predictive control with practical and relaxed stability guarantees and its application to smart grid. Int. J. Robust Nonlinear Control 30(17), 7533–7559 (2020) -- [10.1002/rnc.5192](https://doi.org/10.1002/rnc.5192)
- Seifried, R.: Dynamics of Underactuated Multibody System. Springer, Berlin (2014) -- [10.1007/978-3-319-01228-5](https://doi.org/10.1007/978-3-319-01228-5)
- [Yaghmaei, A., Yazdanpanah, M.J.: Trajectory tracking for a class of contractive port Hamiltonian systems. Automatica 83, 331–336 (2017)](trajectory-tracking-for-a-class-of-contractive-port-hamiltonian-systems) -- [10.1016/j.automatica.2017.06.039](https://doi.org/10.1016/j.automatica.2017.06.039)
- Yi, B., Ortega, R., Manchester, I.R., Siguerdidjane, H.: Path following of a class of underactuated mechanical systems via immersion and invariance-based orbital stabilization. Int. J. Robust Nonlinear Control 30(18), 8521–8544 (2020) -- [10.1002/rnc.5258](https://doi.org/10.1002/rnc.5258)
- Yu, S., Maier, C., Chen, H., Allgöwer, F.: Tube MPC scheme based on robust control invariant set with application to Lipschitz nonlinear systems. Syst. Control Lett. 62(2), 194–200 (2013) -- [10.1016/j.sysconle.2012.11.004](https://doi.org/10.1016/j.sysconle.2012.11.004)
- Zhang, A., Yang, C., Gong, S., Qiu, J.: Nonlinear stabilizing control of underactuated inertia wheel pendulum based on coordinate transformation and time-reverse strategy. Nonlinear Dyn. 84(4), 2467–2476 (2016) -- [10.1007/s11071-016-2658-8](https://doi.org/10.1007/s11071-016-2658-8)
- Zhang, P., Meng, Y., Wu, Z., Tan, M., Yu, J.: Nonlinear model predictive position control for a tail-actuated robotic fish. Nonlinear Dyn. 101, 2235–47 (2020) -- [10.1007/s11071-020-05963-2](https://doi.org/10.1007/s11071-020-05963-2)

