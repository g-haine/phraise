---
layout: post
title: "A segmented model based fuel delivery control of PEM fuel cells: A port-Hamiltonian approach"
date: 2024-08-05 00:00:00 +0100
permalink: a-segmented-model-based-fuel-delivery-control-of-pem-fuel-cells-a-port-hamiltonian-approach
year: 2024
authors: Lalitesh Kumar, Jian Chen, Chengshuai Wu, Yuzhu Chen, Arjan van der Schaft
category: journal-article
tag: PEM fuel cells; Port-Hamiltonian systems; Segmented model; Sliding mode observer
---
 
## Authors
[Lalitesh Kumar](authors/lalitesh-kumar), [Jian Chen](authors/jian-chen), [Chengshuai Wu](authors/chengshuai-wu), [Yuzhu Chen](authors/yuzhu-chen), [Arjan van der Schaft](authors/arjan-van-der-schaft)
 
## Abstract
This paper proposes an extended interconnection and damping assignment passivity-based control technique to control the pressure dynamics in the fuel delivery subsystem of proton exchange membrane fuel cells. The fuel cell stack is a distributed parameter model which can be modeled by partial differential equations. In this paper, the segmentation concept is used to approximate the partial differential equations model by ordinary differential equations model. Therefore, each segment is having multiple ordinary differential equations to obtain the lump-sum model of the segments. Subsequently, a generalized multi-input multi-output lumped parameters model is developed in port-Hamiltonian framework based on mass balance to minimize the modeling error. The modeling errors arise due to the difference between spatially distributed pressures in the segments, and also due to the difference between the actual stack pressure and the measured output pressure of the anode. The segments interconnection feasibility is ensured by maintaining passivity of each segment. With consideration of re-circulation and bleeding of the anode in the modeling, an extended energy-shaping and output tracking state-feedback controller is proposed to control the spatially distributed pressure dynamics in the anode. Furthermore, a sliding mode observer of high order is designed to estimate the unmeasurable pressures with known disturbances. Performance recovery of output feedback control is accomplished with explicit stability analysis. The effectiveness of the proposed control approach is validated by the simulation results.
 
## Keywords
PEM fuel cells; Port-Hamiltonian systems; Segmented model; Sliding mode observer
 
## Citation
- **Journal:** Automatica
- **Year:** 2024
- **Volume:** 168
- **Issue:** 
- **Pages:** 111814
- **Publisher:** Elsevier BV
- **DOI:** [10.1016/j.automatica.2024.111814](https://doi.org/10.1016/j.automatica.2024.111814)
 
## BibTeX
{% highlight bibtex %}
{% raw %}
@article{Kumar_2024,
  title={{A segmented model based fuel delivery control of PEM fuel cells: A port-Hamiltonian approach}},
  volume={168},
  ISSN={0005-1098},
  DOI={10.1016/j.automatica.2024.111814},
  journal={Automatica},
  publisher={Elsevier BV},
  author={Kumar, Lalitesh and Chen, Jian and Wu, Chengshuai and Chen, Yuzhu and van der Schaft, Arjan},
  year={2024},
  pages={111814}
}
{% endraw %}
{% endhighlight %}
 
## References
- Amamou, A., Kandidayeni, M., Kelouwani, S. & Boulon, L. An Online Self Cold Startup Methodology for PEM Fuel Cells in Vehicular Applications. IEEE Transactions on Vehicular Technology vol. 69 14160–14172 (2020) -- [10.1109/TVT.2020.3011381](https://doi.org/10.1109/TVT.2020.3011381)
- Benmouna, A., Becherif, M., Chen, J., Chen, H. & Depernet, D. Interconnection and damping assignment passivity based control for fuel cell and battery vehicle: Simulation and experimentation. International Journal of Hydrogen Energy vol. 44 22467–22477 (2019) -- [10.1016/j.ijhydene.2019.02.045](https://doi.org/10.1016/j.ijhydene.2019.02.045)
- [Castaños, F., Ortega, R., van der Schaft, A. & Astolfi, A. Asymptotic stabilization via control by interconnection of port-Hamiltonian systems. Automatica vol. 45 1611–1618 (2009)](asymptotic-stabilization-via-control-by-interconnection-of-port-hamiltonian-systems) -- [10.1016/j.automatica.2009.03.015](https://doi.org/10.1016/j.automatica.2009.03.015)
- Chen, J., Huang, L., Yan, C. & Liu, Z. A dynamic scalable segmented model of PEM fuel cell systems with two-phase water flow. Mathematics and Computers in Simulation vol. 167 48–64 (2020) -- [10.1016/j.matcom.2018.05.006](https://doi.org/10.1016/j.matcom.2018.05.006)
- Chen, Y.-S. & Peng, H. A segmented model for studying water transport in a PEMFC. Journal of Power Sources vol. 185 1179–1192 (2008) -- [10.1016/j.jpowsour.2008.07.018](https://doi.org/10.1016/j.jpowsour.2008.07.018)
- Chen, Y.-S. & Peng, H. Predicting current density distribution of proton exchange membrane fuel cells with different flow field designs. Journal of Power Sources vol. 196 1992–2004 (2011) -- [10.1016/j.jpowsour.2010.09.094](https://doi.org/10.1016/j.jpowsour.2010.09.094)
- Chen, J., Wu, Z., Wu, C. & Yan, C. Observer Based Fuel Delivery Control for PEM Fuel Cells with a Segmented Anode Model. Asian Journal of Control vol. 21 1781–1795 (2018) -- [10.1002/asjc.1827](https://doi.org/10.1002/asjc.1827)
- Davila, J., Fridman, L., Pisano, A. & Usai, E. Finite-time state observation for non-linear uncertain systems via higher-order sliding modes. International Journal of Control vol. 82 1564–1574 (2009) -- [10.1080/00207170802590531](https://doi.org/10.1080/00207170802590531)
- Donaire, A., Ortega, R. & Romero, J. G. Simultaneous interconnection and damping assignment passivity-based control of mechanical systems using dissipative forces. Systems &amp; Control Letters vol. 94 118–126 (2016) -- [10.1016/j.sysconle.2016.05.006](https://doi.org/10.1016/j.sysconle.2016.05.006)
- Dubau, L. et al. A review of <scp>PEM</scp> fuel cell durability: materials degradation, local heterogeneities of aging and possible mitigation strategies. WIREs Energy and Environment vol. 3 540–560 (2014) -- [10.1002/wene.113](https://doi.org/10.1002/wene.113)
- Esmaili, Q., Nimvari, M. E., Jouybari, N. F. & Chen, Y.-S. Model based water management diagnosis in polymer electrolyte membrane fuel cell. International Journal of Hydrogen Energy vol. 45 15618–15629 (2020) -- [10.1016/j.ijhydene.2020.04.031](https://doi.org/10.1016/j.ijhydene.2020.04.031)
- Frappé, E., Bernardinis, A. D., Coquery, G., Bethoux, O., & Marchand, C. (2011). A soft-switching four-port DC-DC converter for segmented PEM fuel cell power management in vehicle application. In 2011 IEEE vehicle power and propulsion conference (pp. 1–6, Chicago, IL, USA). -- [10.1109/VPPC.2011.6043104](https://doi.org/10.1109/VPPC.2011.6043104)
- Hilairet, M. et al. Experimental Validation of a Sampled-Data Passivity-Based Controller for Coordination of Converters in a Fuel Cell System. IEEE Transactions on Industrial Electronics vol. 62 5187–5194 (2015) -- [10.1109/TIE.2014.2362497](https://doi.org/10.1109/TIE.2014.2362497)
- Hilairet, M. et al. A passivity-based controller for coordination of converters in a fuel cell system. Control Engineering Practice vol. 21 1097–1109 (2013) -- [10.1016/j.conengprac.2013.04.003](https://doi.org/10.1016/j.conengprac.2013.04.003)
- Hong, L., Chen, J., Liu, Z., Huang, L. & Wu, Z. A nonlinear control strategy for fuel delivery in PEM fuel cells considering nitrogen permeation. International Journal of Hydrogen Energy vol. 42 1565–1576 (2017) -- [10.1016/j.ijhydene.2016.07.240](https://doi.org/10.1016/j.ijhydene.2016.07.240)
- Levant, A. Higher-order sliding modes, differentiation and output-feedback control. International Journal of Control vol. 76 924–941 (2003) -- [10.1080/0020717031000099029](https://doi.org/10.1080/0020717031000099029)
- Liu, Z. et al. Anode purge management for hydrogen utilization and stack durability improvement of PEM fuel cell systems. Applied Energy vol. 275 115110 (2020) -- [10.1016/j.apenergy.2020.115110](https://doi.org/10.1016/j.apenergy.2020.115110)
- [Monshizadeh, P., Machado, J. E., Ortega, R. & van der Schaft, A. Power-controlled Hamiltonian systems: Application to electrical systems with constant power loads. Automatica vol. 109 108527 (2019)](power-controlled-hamiltonian-systems-application-to-electrical-systems-with-constant-power-loads) -- [10.1016/j.automatica.2019.108527](https://doi.org/10.1016/j.automatica.2019.108527)
- Mungporn, P. et al. Modeling and Control of Multiphase Interleaved Fuel-Cell Boost Converter Based on Hamiltonian Control Theory for Transportation Applications. IEEE Transactions on Transportation Electrification vol. 6 519–529 (2020) -- [10.1109/TTE.2020.2980193](https://doi.org/10.1109/TTE.2020.2980193)
- Ogungbemi, E. et al. Fuel cell membranes – Pros and cons. Energy vol. 172 155–172 (2019) -- [10.1016/j.energy.2019.01.034](https://doi.org/10.1016/j.energy.2019.01.034)
- Ortega, R., Spong, M. W., Gomez-Estern, F. & Blankenstein, G. Stabilization of a class of underactuated mechanical systems via interconnection and damping assignment. IEEE Transactions on Automatic Control vol. 47 1218–1233 (2002) -- [10.1109/TAC.2002.800770](https://doi.org/10.1109/TAC.2002.800770)
- [Ortega, R., van der Schaft, A., Maschke, B. & Escobar, G. Interconnection and damping assignment passivity-based control of port-controlled Hamiltonian systems. Automatica vol. 38 585–596 (2002)](interconnection-and-damping-assignment-passivity-based-control-of-port-controlled-hamiltonian-systems) -- [10.1016/S0005-1098(01)00278-3](https://doi.org/10.1016/S0005-1098(01)00278-3)
- Palma, L. & Enjeti, P. N. A Modular Fuel Cell, Modular DC–DC Converter Concept for High Performance and Enhanced Reliability. IEEE Transactions on Power Electronics vol. 24 1437–1443 (2009) -- [10.1109/TPEL.2009.2012498](https://doi.org/10.1109/TPEL.2009.2012498)
- Pang, S. et al. Interconnection and Damping Assignment Passivity-Based Control Applied to On-Board DC–DC Power Converter System Supplying Constant Power Load. IEEE Transactions on Industry Applications vol. 55 6476–6485 (2019) -- [10.1109/TIA.2019.2938149](https://doi.org/10.1109/TIA.2019.2938149)
- Panteley, E. & Loria, A. On global uniform asymptotic stability of nonlinear time-varying systems in cascade. Systems &amp; Control Letters vol. 33 131–138 (1998) -- [10.1016/S0167-6911(97)00119-9](https://doi.org/10.1016/S0167-6911(97)00119-9)
- Petrovic, V., Ortega, R., & Stankovic, A. M. (1999). A globally convergent energy-based controller for PM synchronous motors. Vol. 1, In Proceedings of the 38th IEEE conference on decision and control (pp. 334–340, Phoenix, AZ, USA). -- [10.1109/CDC.1999.832798](https://doi.org/10.1109/CDC.1999.832798)
- Petrovic, V., Ortega, R. & Stankovi, A. M. Interconnection and damping assignment approach to control of PM synchronous motors. IEEE Transactions on Control Systems Technology vol. 9 811–820 (2001) -- [10.1109/87.960344](https://doi.org/10.1109/87.960344)
- Rakhtala, S. M., Noei, A. R., Ghaderi, R. & Usai, E. Design of finite-time high-order sliding mode state observer: A practical insight to PEM fuel cell system. Journal of Process Control vol. 24 203–224 (2014) -- [10.1016/j.jprocont.2013.08.006](https://doi.org/10.1016/j.jprocont.2013.08.006)
- Sharma, S. & Ghoshal, S. K. Hydrogen the future transportation fuel: From production to applications. Renewable and Sustainable Energy Reviews vol. 43 1151–1158 (2015) -- [10.1016/j.rser.2014.11.093](https://doi.org/10.1016/j.rser.2014.11.093)
- Tolj, I., Bezmalinovic, D. & Barbir, F. Maintaining desired level of relative humidity throughout a fuel cell with spatially variable heat removal rates. International Journal of Hydrogen Energy vol. 36 13105–13113 (2011) -- [10.1016/j.ijhydene.2011.07.078](https://doi.org/10.1016/j.ijhydene.2011.07.078)
- Utkin, V. Discussion Aspects of High-Order Sliding Mode Control. IEEE Transactions on Automatic Control vol. 61 829–833 (2016) -- [10.1109/TAC.2015.2450571](https://doi.org/10.1109/TAC.2015.2450571)
- [van der Schaft, A. & Jeltsema, D. Limits to Energy Conversion. IEEE Transactions on Automatic Control vol. 67 532–538 (2022)](limits-to-energy-conversion) -- [10.1109/TAC.2021.3075652](https://doi.org/10.1109/TAC.2021.3075652)
- Weng, F.-B., Hsu, C.-Y. & Li, C.-W. Experimental investigation of PEM fuel cell aging under current cycling using segmented fuel cell. International Journal of Hydrogen Energy vol. 35 3664–3675 (2010) -- [10.1016/j.ijhydene.2010.01.065](https://doi.org/10.1016/j.ijhydene.2010.01.065)
- Wu, D., Ortega, R. & Duan, G. On universal stabilization property of Interconnection and Damping Assignment Control. Automatica vol. 119 109087 (2020) -- [10.1016/j.automatica.2020.109087](https://doi.org/10.1016/j.automatica.2020.109087)
- [Wu, C., van der Schaft, A. & Chen, J. Robust trajectory tracking for incrementally passive nonlinear systems. Automatica vol. 107 595–599 (2019)](robust-trajectory-tracking-for-incrementally-passive-nonlinear-systems) -- [10.1016/j.automatica.2019.05.065](https://doi.org/10.1016/j.automatica.2019.05.065)
- [Wu, C., van der Schaft, A. & Chen, J. Stabilization of Port-Hamiltonian Systems Based on Shifted Passivity via Feedback. IEEE Transactions on Automatic Control vol. 66 2219–2226 (2021)](stabilization-of-port-hamiltonian-systems-based-on-shifted-passivity-via-feedback) -- [10.1109/TAC.2020.3005156](https://doi.org/10.1109/TAC.2020.3005156)
- [Yaghmaei, A. & Yazdanpanah, M. J. Structure Preserving Observer Design for Port-Hamiltonian Systems. IEEE Transactions on Automatic Control vol. 64 1214–1220 (2019)](structure-preserving-observer-design-for-port-hamiltonian-systems) -- [10.1109/TAC.2018.2847904](https://doi.org/10.1109/TAC.2018.2847904)

