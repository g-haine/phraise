---
layout: post
title: "The geometric foundations of Hamiltonian Monte Carlo"
date: 2017-05-09 00:00:00 +0100
permalink: the-geometric-foundations-of-hamiltonian-monte-carlo
year: 2017
authors: Michael Betancourt, Simon Byrne, Sam Livingstone, Mark Girolami
category: articles
---
 
## Authors
[Michael Betancourt](authors/michael-betancourt), [Simon Byrne](authors/simon-byrne), [Sam Livingstone](authors/sam-livingstone), [Mark Girolami](authors/mark-girolami)
 
## Abstract
Although Hamiltonian Monte Carlo has proven an empirical success, the lack of a rigorous theoretical understanding of the algorithm has in many ways impeded both principled developments of the method and use of the algorithm in practice. In this paper we develop the formal foundations of the algorithm through the construction of measures on smooth manifolds, and demonstrate how the theory naturally identifies efficient implementations and motivates promising generalizations.
 
## Citation
- **Journal:** Bernoulli
- **Year:** 2017
- **Volume:** 23
- **Issue:** 4A
- **Pages:** 
- **Publisher:** Bernoulli Society for Mathematical Statistics and Probability
- **DOI:** [10.3150/16-BEJ810](https://doi.org/10.3150/16-BEJ810)
 
## BibTeX
{% highlight bibtex %}
{% raw %}
@article{Betancourt_2017,
  title={{The geometric foundations of Hamiltonian Monte Carlo}},
  volume={23},
  ISSN={1350-7265},
  DOI={10.3150/16-bej810},
  number={4A},
  journal={Bernoulli},
  publisher={Bernoulli Society for Mathematical Statistics and Probability},
  author={Betancourt, Michael and Byrne, Simon and Livingstone, Sam and Girolami, Mark},
  year={2017}
}
{% endraw %}
{% endhighlight %}
 
## References
- [2] Baez, J. and Muniain, J.P. (1994). <i>Gauge Fields</i>, <i>Knots and Gravity. Series on Knots and Everything</i> <b>4</b>. River Edge, NJ: World Scientific. -- [10.1142/2324](https://doi.org/10.1142/2324)
- [3] Beskos, A., Pillai, N., Roberts, G., Sanz-Serna, J.-M. and Stuart, A. (2013). Optimal tuning of the hybrid Monte Carlo algorithm. <i>Bernoulli</i> <b>19</b> 1501–1534. -- [10.3150/12-BEJ414](https://doi.org/10.3150/12-BEJ414)
- [4] Beskos, A., Pinski, F.J., Sanz-Serna, J.M. and Stuart, A.M. (2011). Hybrid Monte Carlo on Hilbert spaces. <i>Stochastic Process. Appl.</i> <b>121</b> 2201–2230. -- [10.1016/j.spa.2011.06.003](https://doi.org/10.1016/j.spa.2011.06.003)
- [5] Betancourt, M. (2013). Generalizing the No-U-Turn sampler to Riemannian manifolds. Preprint. Available at <a href="arXiv:1304.1920">arXiv:1304.1920</a>.
- [6] Betancourt, M. (2013). A general metric for Riemannian manifold Hamiltonian Monte Carlo. In <i>Geometric Science of Information</i> (F. Nielsen and F. Barbaresco, eds.). <i>Lecture Notes in Computer Science</i> <b>8085</b> 327–334. Heidelberg: Springer.
- [7] Betancourt, M. (2014). Adiabatic Monte Carlo. Preprint. Available at <a href="arXiv:1405.3489">arXiv:1405.3489</a>.
- [8] Betancourt, M. and Stein, L.C. (2011). The geometry of Hamiltonian Monte Carlo. Preprint. Available at <a href="arXiv:1410.5110">arXiv:1410.5110</a>.
- [9] Burrage, K., Lenane, I. and Lythe, G. (2007). Numerical methods for second-order stochastic differential equations. <i>SIAM J. Sci. Comput.</i> <b>29</b> 245–264 (electronic). -- [10.1137/050646032](https://doi.org/10.1137/050646032)
- [10] Byrne, S. and Girolami, M. (2013). Geodesic Monte Carlo on embedded manifolds. <i>Scand. J. Stat.</i> <b>40</b> 825–845. -- [10.1111/sjos.12036](https://doi.org/10.1111/sjos.12036)
- [11] Caflisch, R.E. (1998). Monte Carlo and quasi-Monte Carlo methods. In <i>Acta Numerica. Acta Numer.</i> <b>7</b> 1–49. Cambridge: Cambridge Univ. Press. -- [10.1017/S0962492900002804](https://doi.org/10.1017/S0962492900002804)
- [12] Cannas da Silva, A. (2001). <i>Lectures on Symplectic Geometry. Lecture Notes in Math.</i> <b>1764</b>. Berlin: Springer.
- [13] Censor, A. and Grandini, D. (2014). Borel and continuous systems of measures. <i>Rocky Mountain J. Math.</i> <b>44</b> 1073–1110. -- [10.1216/RMJ-2014-44-4-1073](https://doi.org/10.1216/RMJ-2014-44-4-1073)
- [14] Chang, J.T. and Pollard, D. (1997). Conditioning as disintegration. <i>Stat. Neerl.</i> <b>51</b> 287–317. -- [10.1111/1467-9574.00056](https://doi.org/10.1111/1467-9574.00056)
- [15] Cotter, S.L., Roberts, G.O., Stuart, A.M. and White, D. (2013). MCMC methods for functions: Modifying old algorithms to make them faster. <i>Statist. Sci.</i> <b>28</b> 424–446. -- [10.1214/13-STS421](https://doi.org/10.1214/13-STS421)
- [17] Dawid, A.P., Stone, M. and Zidek, J.V. (1973). Marginalization paradoxes in Bayesian and structural inference. <i>J. Roy. Statist. Soc. Ser. B</i> <b>35</b> 189–233. -- [10.1111/j.2517-6161.1973.tb00952.x](https://doi.org/10.1111/j.2517-6161.1973.tb00952.x)
- [18] Diaconis, P. and Freedman, D. (1999). Iterated random functions. <i>SIAM Rev.</i> <b>41</b> 45–76. -- [10.1137/S0036144598338446](https://doi.org/10.1137/S0036144598338446)
- [20] Duane, S., Kennedy, A.D., Pendleton, B.J. and Roweth, D. (1987). Hybrid Monte Carlo. <i>Phys. Lett. B</i> <b>195</b> 216–222. -- [10.1016/0370-2693(87)91197-X](https://doi.org/10.1016/0370-2693(87)91197-X)
- [21] Fang, Y., Sanz-Serna, J.-M. and Skeel, R.D. (2014). Compressible generalized hybrid Monte Carlo. <i>J. Chem. Phys.</i> <b>140</b> 174108. -- [10.1063/1.4874000](https://doi.org/10.1063/1.4874000)
- [23] Fixman, M. (1978). Simulation of polymer dynamics. I. General theory. <i>J. Chem. Phys.</i> <b>69</b> 1527–1537.
- [26] Gelfand, A.E. and Smith, A.F.M. (1990). Sampling-based approaches to calculating marginal densities. <i>J. Amer. Statist. Assoc.</i> <b>85</b> 398–409. -- [10.1080/01621459.1990.10476213](https://doi.org/10.1080/01621459.1990.10476213)
- [27] Geman, S. and Geman, D. (1984). Stochastic relaxation, Gibbs distributions, and the Bayesian restoration of images. <i>IEEE Transactions on Pattern Analysis and Machine Intelligence</i> <b>6</b> 721–741. -- [10.1109/TPAMI.1984.4767596](https://doi.org/10.1109/TPAMI.1984.4767596)
- [29] Girolami, M. and Calderhead, B. (2011). Riemann manifold Langevin and Hamiltonian Monte Carlo methods. <i>J. R. Stat. Soc. Ser. B. Stat. Methodol.</i> <b>73</b> 123–214. -- [10.1111/j.1467-9868.2010.00765.x](https://doi.org/10.1111/j.1467-9868.2010.00765.x)
- [30] Haario, H., Saksman, E. and Tamminen, J. (2001). An adaptive Metropolis algorithm. <i>Bernoulli</i> <b>7</b> 223–242. -- [10.2307/3318737](https://doi.org/10.2307/3318737)
- [32] Hairer, E., Lubich, C. and Wanner, G. (2006). <i>Geometric Numerical Integration</i>: <i>Structure-Preserving Algorithms for Ordinary Differential Equations</i>, 2nd ed. <i>Springer Series in Computational Mathematics</i> <b>31</b>. Berlin: Springer.
- [34] Hoffman, M.D. and Gelman, A. (2014). The no-U-turn sampler: Adaptively setting path lengths in Hamiltonian Monte Carlo. <i>J. Mach. Learn. Res.</i> <b>15</b> 1593–1623.
- [35] Holmes, S., Rubinstein-Salzedo, S. and Seiler, C. (2014). Curvature and concentration of Hamiltonian Monte Carlo in high dimensions. Preprint. Available at <a href="arXiv:1407.1114">arXiv:1407.1114</a>.
- [36] Horowitz, A.M. (1991). A generalized guided Monte Carlo algorithm. <i>Phys. Lett. B</i> <b>268</b> 247–252. -- [10.1016/0370-2693(91)90812-5](https://doi.org/10.1016/0370-2693(91)90812-5)
- [37] Husain, S., Vasishth, S. and Srinivasan, N. (2014). Strong expectations cancel locality effects: Evidence from Hindi. <i>PLoS ONE</i> <b>9</b> e100986. -- [10.1371/journal.pone.0100986](https://doi.org/10.1371/journal.pone.0100986)
- [38] Izaguirre, J.A. and Hampton, S.S. (2004). Shadow hybrid Monte Carlo: An efficient propagator in phase space of macromolecules. <i>J. Comput. Phys.</i> <b>200</b> 581–604. -- [10.1016/j.jcp.2004.04.016](https://doi.org/10.1016/j.jcp.2004.04.016)
- [39] Jasche, J., Kitaura, F.S., Li, C. and Ensslin, T.A. (2010). Bayesian non-linear large-scale structure inference of the Sloan digital sky survey data Release 7. <i>Mon. Not. R. Astron. Soc.</i> <b>409</b> 355–370. -- [10.1111/j.1365-2966.2010.17313.x](https://doi.org/10.1111/j.1365-2966.2010.17313.x)
- [41] Joulin, A. and Ollivier, Y. (2010). Curvature, concentration and error estimates for Markov chain Monte Carlo. <i>Ann. Probab.</i> <b>38</b> 2418–2442. -- [10.1214/10-AOP541](https://doi.org/10.1214/10-AOP541)
- [43] Lan, S., Stathopoulos, V., Shahbaba, B. and Girolami, M. (2012). Lagrangian Dynamical Monte Carlo. Preprint. Available at <a href="arXiv:1211.3759">arXiv:1211.3759</a>.
- [44] Leao, D. Jr., Fragoso, M. and Ruffino, P. (2004). Regular conditional probability, disintegration of probability and Radon spaces. <i>Proyecciones</i> <b>23</b> 15–29.
- [45] Lee, J.M. (2011). <i>Introduction to Topological Manifolds</i>, 2nd ed. <i>Graduate Texts in Mathematics</i> <b>202</b>. New York: Springer. -- [10.1007/978-1-4419-7940-7](https://doi.org/10.1007/978-1-4419-7940-7)
- [46] Lee, J.M. (2013). <i>Introduction to Smooth Manifolds</i>, 2nd ed. <i>Graduate Texts in Mathematics</i> <b>218</b>. New York: Springer.
- [48] Livingstone, S. and Girolami, M. (2014). Information-geometric Markov chain Monte Carlo methods using diffusions. <i>Entropy</i> <b>16</b> 3074–3102. -- [10.3390/e16063074](https://doi.org/10.3390/e16063074)
- [53] Neal, R.M. (2012). How to view an MCMC simulation as a permutation, with applications to parallel simulation and improved importance sampling. Preprint. Available at <a href="arXiv:1205.0070">arXiv:1205.0070</a>.
- [55] Ollivier, Y. (2009). Ricci curvature of Markov chains on metric spaces. <i>J. Funct. Anal.</i> <b>256</b> 810–864. -- [10.1016/j.jfa.2008.11.001](https://doi.org/10.1016/j.jfa.2008.11.001)
- [57] Polettini, M. (2013). Generally covariant state-dependent diffusion. <i>J. Stat. Mech. Theory Exp.</i> <b>2013</b> P07005. -- [10.1088/1742-5468/2013/07/P07005](https://doi.org/10.1088/1742-5468/2013/07/P07005)
- [58] Porter, E.K. and Carré, J. (2014). A Hamiltonian Monte-Carlo method for Bayesian inference of supermassive black hole binaries. <i>Classical Quantum Gravity</i> <b>31</b> 145004, 22. -- [10.1088/0264-9381/31/14/145004](https://doi.org/10.1088/0264-9381/31/14/145004)
- [60] Roberts, G.O., Gelman, A. and Gilks, W.R. (1997). Weak convergence and optimal scaling of random walk Metropolis algorithms. <i>Ann. Appl. Probab.</i> <b>7</b> 110–120. -- [10.1214/aoap/1034625254](https://doi.org/10.1214/aoap/1034625254)
- [61] Roberts, G.O. and Rosenthal, J.S. (2004). General state space Markov chains and MCMC algorithms. <i>Probab. Surv.</i> <b>1</b> 20–71. -- [10.1214/154957804100000024](https://doi.org/10.1214/154957804100000024)
- [62] Sanders, N., Betancourt, M. and Soderberg, A. (2014). Unsupervised transient light curve analysis via hierarchical Bayesian inference. <i>Astrophysics Journal</i> <b>800</b> no. 1, 36. The full reference including BibTex can be found at <a href="http://iopscience.iop.org/article/10.1088/0004-637X/800/1/36/meta">http://iopscience.iop.org/article/10.1088/0004-637X/800/1/36/meta</a>.
- [63] Schofield, M.R., Barker, R.J., Gelman, A., Cook, E.R. and Briffa, K. (2014). Climate reconstruction using tree-ring data. <i>J. Amer. Statist. Assoc.</i> To appear. Available at <a href="arXiv:1510.02557">arXiv:1510.02557</a>.
- [65] Simmons, D. (2012). Conditional measures and conditional expectation; Rohlin’s disintegration theorem. <i>Discrete Contin. Dyn. Syst.</i> <b>32</b> 2565–2582. -- [10.3934/dcds.2012.32.2565](https://doi.org/10.3934/dcds.2012.32.2565)
- [70] Tang, Y., Srivastava, N. and Salakhutdinov, R. (2013). Learning generative models with visual attention. Preprint. Available at <a href="arXiv:1312.6110">arXiv:1312.6110</a>.
- [71] Terada, R., Inoue, S. and Nishihara, G.N. (2013). The effect of light and temperature on the growth and photosynthesis of Gracilariopsis chorda (Gracilariales, Rhodophtya) from geographically separated locations of Japanowth and photosynthesis of Gracilariopsis chorda (Gracilariales, Rhodophtya) from geographically separated locations of Japan. <i>J. Appl. Phycol.</i> <b>25</b> 1863–1872.
- [72] Tierney, L. (1998). A note on Metropolis–Hastings kernels for general state spaces. <i>Ann. Appl. Probab.</i> <b>8</b> 1–9. -- [10.1214/aoap/1027961031](https://doi.org/10.1214/aoap/1027961031)
- [74] Wang, H., Mo, H.J., Yang, X., Jing, Y.P. and Lin, W.P. (2014). Exploring the local universe with reconstructed initial density field I: Hamiltonian Markov chain Monte Carlo method with particle mesh dynamics. Preprint. Available at <a href="arXiv:1407.3451">arXiv:1407.3451</a>.
- [77] Weinstein, A. (1983). The local structure of Poisson manifolds. <i>J. Differential Geom.</i> <b>18</b> 523–557. -- [10.4310/jdg/1214437787](https://doi.org/10.4310/jdg/1214437787)
- [1] Amari, S. and Nagaoka, H. (2007). <i>Methods of Information Geometry</i>. Providence: American Mathematical Soc. -- [10.1090/mmono/191](https://doi.org/10.1090/mmono/191)
- [16] Cowling, B.J., Freeman, G., Wong, J.Y., Wu, P., Liao, Q., Lau, E.H., Wu, J.T., Fielding, R. and Leung, G.M. (2012). Preliminary inferences on the age-specific seriousness of human disease caused by Avian influenza A (H7N9) infections in China, March to April 2013. European Communicable Disease Bulletin 18.
- [19] Draganescu, A., Lehoucq, R. and Tupper, P. (2009). Hamiltonian molecular dynamics for computational mechanicians and numerical analysts. Technical Report No. 2008–6512. Sandia National Laboratories.
- [22] Federer, H. (1969). <i>Geometric Measure Theory</i>. New York: Springer.
- [24] Folland, G.B. (1999). <i>Real Analysis</i>: <i>Modern Techniques and Their Applications</i>, 2nd ed. <i>Pure and Applied Mathematics</i> (<i>New York</i>). New York: Wiley.
- [25] Frenkel, D. and Smit, B. (2001). <i>Understanding Molecular Simulation</i>: <i>From Algorithms to Applications</i>. San Diego: Academic Press.
- [28] Ghitza, Y. and Gelman, A. (2014). The great society, Reagan’s revolution, and generations of presidential voting. Unpublished manuscript.
- [31] Haile, J.M. (1992). <i>Molecular Dynamics Simulation</i>: <i>Elementary Methods</i>. New York: Wiley.
- [33] Halmos, P.R. (1950). <i>Measure Theory</i>. New York: D. Van Nostrand Company. -- [10.1007/978-1-4684-9440-2](https://doi.org/10.1007/978-1-4684-9440-2)
- [40] José, J.V. and Saletan, E.J. (1998). <i>Classical Dynamics</i>: <i>A Contemporary Approach</i>. Cambridge: Cambridge Univ. Press. -- [10.1017/CBO9780511803772](https://doi.org/10.1017/CBO9780511803772)
- [42] Kardar, M. (2007). <i>Statistical Physics of Particles</i>. Cambridge: Cambridge Univ. Press. -- [10.1017/CBO9780511815898](https://doi.org/10.1017/CBO9780511815898)
- [47] Leimkuhler, B. and Reich, S. (2004). <i>Simulating Hamiltonian Dynamics</i>. Cambridge: Cambridge Univ. Press.
- [49] Marx, D. and Hutter, J. (2009). <i>Ab Initio Molecular Dynamics</i>: <i>Basic Theory and Advanced Methods</i>. Cambridge: Cambridge Univ. Press. -- [10.1017/CBO9780511609633](https://doi.org/10.1017/CBO9780511609633)
- [50] Meyn, S. and Tweedie, R.L. (2009). <i>Markov Chains and Stochastic Stability</i>, 2nd ed. Cambridge: Cambridge Univ. Press. -- [10.1017/CBO9780511626630](https://doi.org/10.1017/CBO9780511626630)
- [51] Murray, I. and Elliott, L.T. (2012). Driving Markov chain Monte Carlo with a dependent random stream. Unpublished manuscript.
- [52] Neal, R.M. (2011). MCMC using Hamiltonian dynamics. In <i>Handbook of Markov Chain Monte Carlo</i> (S. Brooks, A. Gelman, G.L. Jones and X.-L. Meng, eds.) New York: CRC Press.
- [54] Øksendal, B. (2003). <i>Stochastic Differential Equations</i>, 6th ed. <i>Universitext</i>. Berlin: Springer. -- [10.1007/978-3-642-14394-6](https://doi.org/10.1007/978-3-642-14394-6)
- [56] Petersen, K. (1989). <i>Ergodic Theory</i>. Cambridge: Cambridge Univ. Press.
- [59] Robert, C.P. and Casella, G. (1999). <i>Monte Carlo Statistical Methods</i>. New York: Springer. -- [10.1007/978-1-4757-3071-5](https://doi.org/10.1007/978-1-4757-3071-5)
- [64] Schutz, B. (1980). <i>Geometrical Methods of Mathematical Physics</i>. New York: Cambridge Univ. Press. -- [10.1017/CBO9781139171540](https://doi.org/10.1017/CBO9781139171540)
- [66] Sohl-Dickstein, J., Mudigonda, M. and DeWeese, M. (2014). Hamiltonian Monte Carlo without detailed balance. In <i>Proceedings of the</i> 31<i>st International Conference on Machine Learning</i>. 719–726. Beijing, China.
- [67] Souriau, J.-M. (1997). <i>Structure of Dynamical Systems</i>: <i>A Symplectic View of Physics</i>. Boston, MA: Birkhäuser. -- [10.1007/978-1-4612-0281-3](https://doi.org/10.1007/978-1-4612-0281-3)
- [68] Stan Development Team (2014). Stan: A C++ Library for Probability and Sampling, Version 2.5.
- [69] Sutherland, D.J., Póczos, B. and Schneider, J. (2013). Active learning and search on low-rank matrices. In <i>Proceedings of the</i> 19<i>th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining. KDD ’</i>13 212–220. New York: ACM.
- [73] Tjur, T. (1980). <i>Probability Based on Radon Measures</i>. Chichester: Wiley.
- [75] Wang, Z., Mohamed, S. and de Freitas, N. (2013). Adaptive Hamiltonian and Riemann Manifold Monte Carlo. In <i>Proceedings of the</i> 30<i>th International Conference on Machine Learning</i> (<i>ICML-</i>13) 1462–1470. Atlanta, Georgia, USA.
- [76] Weber, S., Carpenter, B., Lee, D., Bois, F.Y., Gelman, A. and Racine, A. (2014). Bayesian drug disease model with Stan-Using published longitudinal data summaries in population models. In <i>Annual Meeting of the Population Approach Group in Europe</i> 2014, <i>Vol.</i> 23. Alicante, Spain.
- [78] Zaslavsky, G.M. (2005). <i>Hamiltonian Chaos and Fractional Dynamics</i>. Oxford: Oxford Univ. Press.

