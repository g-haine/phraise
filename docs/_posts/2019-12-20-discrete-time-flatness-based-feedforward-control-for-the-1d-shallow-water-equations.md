---
layout: post
title: "Discrete-Time Flatness-Based Feedforward Control for the 1D Shallow Water Equations"
date: 2019-12-20 00:00:00 +0100
permalink: discrete-time-flatness-based-feedforward-control-for-the-1d-shallow-water-equations
year: 2019
authors: Paul Kotyczka
category: journal-article
tag: Port-Hamiltonian systems; nonlinear conservation laws; structure-preserving discretization; geometric integration; discrete-time systems; flatness-based trajectory planning
---
 
## Authors
[Paul Kotyczka](authors/paul-kotyczka)
 
## Abstract
Flatness of given outputs for quasilinear 1D hyperbolic systems is conserved under an appropriate port-Hamiltonian spatial discretization. Combining the spatial with a structure-preserving temporal scheme leads to a fully discretized control model of the infinite-dimensional system, which can be exploited for discrete-time trajectory planning. We show that with a suitable approximation of the continuous nonlinear equations, a stable explicit numerical scheme is obtained for flatness-based feedforward control of quasilinear hyperbolic systems. As an example, we consider the 1D shallow water equations and the inverse flow routing problem, i. e. the computation of the upstream discharge trajectory from a given downstream hydrograph. We compare our approach with known results based on the method of characteristics.
 
## Keywords
Port-Hamiltonian systems; nonlinear conservation laws; structure-preserving discretization; geometric integration; discrete-time systems; flatness-based trajectory planning
 
## Citation
- **Journal:** IFAC-PapersOnLine
- **Year:** 2019
- **Volume:** 52
- **Issue:** 16
- **Pages:** 42--47
- **Publisher:** Elsevier BV
- **DOI:** [10.1016/j.ifacol.2019.11.753](https://doi.org/10.1016/j.ifacol.2019.11.753)
- **Note:** 11th IFAC Symposium on Nonlinear Control Systems NOLCOS 2019- Vienna, Austria, 4–6 September 2019
 
## BibTeX
{% highlight bibtex %}
{% raw %}
@article{Kotyczka_2019,
  title={{Discrete-Time Flatness-Based Feedforward Control for the 1D Shallow Water Equations}},
  volume={52},
  ISSN={2405-8963},
  DOI={10.1016/j.ifacol.2019.11.753},
  number={16},
  journal={IFAC-PapersOnLine},
  publisher={Elsevier BV},
  author={Kotyczka, Paul},
  year={2019},
  pages={42--47}
}
{% endraw %}
{% endhighlight %}
 
## References
- [Cardoso-Ribeiro, F. L., Matignon, D. & Lefèvre, L. A structure-preserving Partitioned Finite Element Method for the 2D wave equation ⁎ ⁎This work is supported by the project ANR-16-CE92-0028, entitled Interconnected Infinite-Dimensional systems for Heterogeneous Media, INFIDHEM, financed by the French National Research Agency (ANR). Further information is available at https://websites.isae-supaero.fr/infidhem/the-project/. IFAC-PapersOnLine vol. 51 119–124 (2018)](a-structure-preserving-partitioned-finite-element-method-for-the-2d-wave-equation) -- [10.1016/j.ifacol.2018.06.033](https://doi.org/10.1016/j.ifacol.2018.06.033)
- Devasia, S., Degang Chen & Paden, B. Nonlinear inversion-based output tracking. IEEE Transactions on Automatic Control vol. 41 930–942 (1996) -- [10.1109/9.508898](https://doi.org/10.1109/9.508898)
- Egger, H. (2018). Structure preserving approximation of dissipative evolution problems. arXiv:1804.08648v1.
- FLIESS, M., LÉVINE, J., MARTIN, P. & ROUCHON, P. Flatness and defect of non-linear systems: introductory theory and examples. International Journal of Control vol. 61 1327–1361 (1995) -- [10.1080/00207179508921959](https://doi.org/10.1080/00207179508921959)
- Knuppel, T., Woittennek, F. & Rudolph, J. Flatness-based trajectory planning for the shallow water equations. 49th IEEE Conference on Decision and Control (CDC) 2960–2965 (2010) doi:10.1109/cdc.2010.5717438 -- [10.1109/CDC.2010.5717438](https://doi.org/10.1109/CDC.2010.5717438)
- [Kotyczka, P. Finite Volume Structure-Preserving Discretization of 1D Distributed-Parameter Port-Hamiltonian Systems. IFAC-PapersOnLine vol. 49 298–303 (2016)](finite-volume-structure-preserving-discretization-of-1d-distributed-parameter-port-hamiltonian-systems) -- [10.1016/j.ifacol.2016.07.457](https://doi.org/10.1016/j.ifacol.2016.07.457)
- [Kotyczka, P. & Blancato, A. Feedforward control of a channel flow based on a discretized port-Hamiltonian model. IFAC-PapersOnLine vol. 48 194–199 (2015)](feedforward-control-of-a-channel-flow-based-on-a-discretized-port-hamiltonian-model) -- [10.1016/j.ifacol.2015.10.238](https://doi.org/10.1016/j.ifacol.2015.10.238)
- [Kotyczka, P. & Lefèvre, L. Discrete-time port-Hamiltonian systems based on Gauss-Legendre collocation ⁎ ⁎P. Kotyczka received financial support as a part-time post-doctoral researcher (03/17–08/17) from the DFG-ANR funded project INFI-DHEM (no ANR-16-CE92-0028) and by a part-time visiting fellowship of Grenoble INP in summer term 2017. The work makes also part of the project KO 4750/1-1, funded by the German Research Foundation (DFG). IFAC-PapersOnLine vol. 51 125–130 (2018)](discrete-time-port-hamiltonian-systems-based-on-gauss-legendre-collocation) -- [10.1016/j.ifacol.2018.06.035](https://doi.org/10.1016/j.ifacol.2018.06.035)
- [Kotyczka, P., Maschke, B. & Lefèvre, L. Weak form of Stokes–Dirac structures and geometric discretization of port-Hamiltonian systems. Journal of Computational Physics vol. 361 442–476 (2018)](weak-form-of-stokes-dirac-structures-and-geometric-discretization-of-port-hamiltonian-systems) -- [10.1016/j.jcp.2018.02.006](https://doi.org/10.1016/j.jcp.2018.02.006)
- Laroche, B., Martin, P. & Rouchon, P. Motion planning for the heat equation. International Journal of Robust and Nonlinear Control vol. 10 629–643 (2000) -- [10.1002/1099-1239(20000715)10:8<629::AID-RNC502>3.0.CO;2-N](https://doi.org/10.1002/1099-1239(20000715)10:8<629::AID-RNC502>3.0.CO;2-N)
- Meurer, T. Flatness-based trajectory planning for diffusion–reaction systems in a parallelepipedon—A spectral approach. Automatica vol. 47 935–949 (2011) -- [10.1016/j.automatica.2011.02.004](https://doi.org/10.1016/j.automatica.2011.02.004)
- Morrison, P. J. Hamiltonian description of the ideal fluid. Reviews of Modern Physics vol. 70 467–521 (1998) -- [10.1103/RevModPhys.70.467](https://doi.org/10.1103/RevModPhys.70.467)
- [Moulla, R., Lefévre, L. & Maschke, B. Pseudo-spectral methods for the spatial symplectic reduction of open systems of conservation laws. Journal of Computational Physics vol. 231 1272–1292 (2012)](pseudo-spectral-methods-for-the-spatial-symplectic-reduction-of-open-systems-of-conservation-laws) -- [10.1016/j.jcp.2011.10.008](https://doi.org/10.1016/j.jcp.2011.10.008)
- Mounier, H. & Rudolph, J. Flatness-based control of nonlinear delay systems: A chemical reactor example. International Journal of Control vol. 71 871–890 (1998) -- [10.1080/002071798221614](https://doi.org/10.1080/002071798221614)
- Rabbani, T. S., Meglio, F. D., Litrico, X. & Bayen, A. M. Feed-Forward Control of Open Channel Flow Using Differential Flatness. IEEE Transactions on Control Systems Technology vol. 18 213–221 (2010) -- [10.1109/TCST.2009.2014640](https://doi.org/10.1109/TCST.2009.2014640)
- Szymkiewicz, R. Solution of the inverse problem for the Saint Venant equations. Journal of Hydrology vol. 147 105–120 (1993) -- [10.1016/0022-1694(93)90077-M](https://doi.org/10.1016/0022-1694(93)90077-M)
- [Trenchant, V., Ramirez, H., Le Gorrec, Y. & Kotyczka, P. Finite differences on staggered grids preserving the port-Hamiltonian structure with application to an acoustic duct. Journal of Computational Physics vol. 373 673–697 (2018)](finite-differences-on-staggered-grids-preserving-the-port-hamiltonian-structure-with-application-to-an-acoustic-duct) -- [10.1016/j.jcp.2018.06.051](https://doi.org/10.1016/j.jcp.2018.06.051)
- [van der Schaft, A. J. & Maschke, B. M. Hamiltonian formulation of distributed-parameter systems with boundary energy flow. Journal of Geometry and Physics vol. 42 166–194 (2002)](hamiltonian-formulation-of-distributed-parameter-systems-with-boundary-energy-flow) -- [10.1016/S0393-0440(01)00083-3](https://doi.org/10.1016/S0393-0440(01)00083-3)
- Woittennek, F. & Rudolph, J. Controller Canonical Forms and Flatness Based State Feedback for 1D Hyperbolic Systems. IFAC Proceedings Volumes vol. 45 792–797 (2012) -- [10.3182/20120215-3-AT-3016.00140](https://doi.org/10.3182/20120215-3-AT-3016.00140)

