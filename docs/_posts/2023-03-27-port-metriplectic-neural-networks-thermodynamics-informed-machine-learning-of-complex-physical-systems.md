---
layout: post
title: "Port-metriplectic neural networks: thermodynamics-informed machine learning of complex physical systems"
date: 2023-03-27 00:00:00 +0100
permalink: port-metriplectic-neural-networks-thermodynamics-informed-machine-learning-of-complex-physical-systems
year: 2023
authors: Quercus Hernández, Alberto Badías, Francisco Chinesta, Elías Cueto
category: journal-article
tag: Port-Hamiltonian; Thermodynamics; Scientific machine learning; Inductive biases
---
 
## Authors
**Quercus Hernández, Alberto Badías, Francisco Chinesta, Elías Cueto**
 
## Abstract
We develop inductive biases for the machine learning of complex physical systems based on the port-Hamiltonian formalism. To satisfy by construction the principles of thermodynamics in the learned physics (conservation of energy, non-negative entropy production), we modify accordingly the port-Hamiltonian formalism so as to achieve a port-metriplectic one. We show that the constructed networks are able to learn the physics of complex systems by parts, thus alleviating the burden associated to the experimental characterization and posterior learning process of this kind of systems. Predictions can be done, however, at the scale of the complete system. Examples are shown on the performance of the proposed technique.
 
## Keywords
Port-Hamiltonian; Thermodynamics; Scientific machine learning; Inductive biases
 
## Citation
- **Journal:** Computational Mechanics
- **Year:** 2023
- **Volume:** 72
- **Issue:** 3
- **Pages:** 553--561
- **Publisher:** Springer Science and Business Media LLC
- **DOI:** [10.1007/s00466-023-02296-w](https://doi.org/10.1007/s00466-023-02296-w)
 
## BibTeX
{% highlight bibtex %}
{% raw %}
@article{Hern_ndez_2023,
  title={{Port-metriplectic neural networks: thermodynamics-informed machine learning of complex physical systems}},
  volume={72},
  ISSN={1432-0924},
  DOI={10.1007/s00466-023-02296-w},
  number={3},
  journal={Computational Mechanics},
  publisher={Springer Science and Business Media LLC},
  author={Hernández, Quercus and Badías, Alberto and Chinesta, Francisco and Cueto, Elías},
  year={2023},
  pages={553--561}
}
{% endraw %}
{% endhighlight %}
 
## References
- Stachenfeld K, Fielding DB, Kochkov D, Cranmer M, Pfaff T, Godwin J, Cui C, Ho S, Battaglia P, Sanchez-Gonzalez A (2021) Learned simulators for turbulence. In: International conference on learning representations
- Allen KR, Lopez-Guevara T, Stachenfeld K, Sanchez-Gonzalez A, Battaglia P, Hamrick J, Pfaff T (2022) Physical design using differentiable learned simulators. arXiv preprint arXiv:2202.00728
- Battaglia PW, Hamrick JB, Bapst V, Sanchez-Gonzalez A, Zambaldi V, Malinowski M, Tacchetti A, Raposo D, Santoro A, Faulkner R et al (2018) Relational inductive biases, deep learning, and graph networks. arXiv preprint arXiv:1806.01261
- Bhattoo Ravinder, Ranu Sayan, Krishnan NM (2021) Lagrangian neural network with differentiable symmetries and relational inductive bias. arXiv preprint arXiv:2110.03266
- Mitchell TM (1980) The need for biases in learning generalizations. Department of Computer Science, Laboratory for Computer Science Research
- Dirac PAM (1929) Quantum mechanics of many-electron systems. Proc R Soc Lond Ser A Contain Papers Math Phys Character 123(792):714–733
- [Van Der Schaft A et al (2014) Port-Hamiltonian systems theory: an introductory overview. Found Trends® Syst Control 1(2–3):173–378](port-hamiltonian-systems-theory-an-introductory-overview-journal) -- [10.1561/2600000002](https://doi.org/10.1561/2600000002)
- [Beattie CA, Mehrmann V, Van DP (2019) Robust port-Hamiltonian representations of passive systems. Automatica 100:182–186](robust-port-hamiltonian-representations-of-passive-systems) -- [10.1016/j.automatica.2018.11.013](https://doi.org/10.1016/j.automatica.2018.11.013)
- [Rashad R, Califano F, van der Schaft AJ, Stramigioli S (2020) Twenty years of distributed port-hamiltonian systems: a literature review. IMA J Math Control Inf 37(4):1400–1422](twenty-years-of-distributed-port-hamiltonian-systems-a-literature-review) -- [10.1093/imamci/dnaa018](https://doi.org/10.1093/imamci/dnaa018)
- Weinan E (2017) A proposal on machine learning via dynamical systems. Commun Math Stat 5(1):1–11 -- [10.1007/s40304-017-0103-z](https://doi.org/10.1007/s40304-017-0103-z)
- Cueto E, Chinesta F (2022) Thermodynamics of learning physical phenomena. arXiv preprint arXiv:2207.12749 -- [10.1007/s11831-023-09954-5](https://doi.org/10.1007/s11831-023-09954-5)
- González D, Chinesta F, Cueto E (2019) Thermodynamically consistent data-driven computational mechanics. Contin Mech Thermodyn 31(1):239–253 -- [10.1007/s00161-018-0677-z](https://doi.org/10.1007/s00161-018-0677-z)
- González D, Chinesta F, Cueto E (2019) Learning corrections for hyperelastic models from data. Front Mater 6:14 -- [10.3389/fmats.2019.00014](https://doi.org/10.3389/fmats.2019.00014)
- González D, Chinesta F, Cueto E (2021) Learning non-Markovian physics from data. J Comput Phys 428:109982 -- [10.1016/j.jcp.2020.109982](https://doi.org/10.1016/j.jcp.2020.109982)
- Jin P, Zhang Z, Zhu A, Tang Y, Karniadakis GE (2020) Sympnets: intrinsic structure-preserving symplectic networks for identifying Hamiltonian systems. Neural Netw 132:166–179 -- [10.1016/j.neunet.2020.08.017](https://doi.org/10.1016/j.neunet.2020.08.017)
- Chen Z, Feng M, Yan J, Zha H (2022) Learning neural Hamiltonian dynamics: a methodological overview. arXiv preprint arXiv:2203.00128
- Miller ST, Lindner JF, Choudhary A, Sinha S, Ditto WL (2020) Mastering high-dimensional dynamics with Hamiltonian neural networks. arXiv preprint arXiv:2008.04214
- Galimberti CL, Xu L, Trecate GF (2021) A unified framework for Hamiltonian deep neural networks. In: Learning for dynamics and control, pp 275–286. PMLR, USA
- Bertalan T, Dietrich F, Mezić I, Kevrekidis IG (2019) On learning Hamiltonian systems from data. Chaos Interdiscip J Nonlinear Sci 29(12):121107 -- [10.1063/1.5128231](https://doi.org/10.1063/1.5128231)
- Toth P, Rezende DJ, Jaegle A, Racanière S, Botev A, Higgins I (2019) Hamiltonian generative networks. arXiv preprint arXiv:1909.13789
- Bhat HS, Ranka K, Isborn CM (2020) Machine learning a molecular Hamiltonian for predicting electron dynamics. Int J Dyn Control 8(4):1089–1101 -- [10.1007/s40435-020-00699-8](https://doi.org/10.1007/s40435-020-00699-8)
- Kochkov D, Pfaff T, Sanchez-Gonzalez A, Battaglia P, Clark BK (2021) Learning ground states of quantum hamiltonians with graph networks. arXiv preprint arXiv:2110.06390
- Yuanqi G, Wang X, Nanpeng Y, Wong BM (2022) Harnessing deep reinforcement learning to construct time-dependent optimal fields for quantum control dynamics. Phys Chem Chem Phys 24(39):24012–24020 -- [10.1039/D2CP02495K](https://doi.org/10.1039/D2CP02495K)
- Lutter M, Ritter C, Peters J (2019) Deep Lagrangian networks: using physics as model prior for deep learning. arXiv preprint arXiv:1907.04490
- Zhong YD, Leonard N (2020) Unsupervised learning of Lagrangian dynamics from images for prediction and control. Adv Neural Inf Proc Syst 33:10741–10752
- Lee S-C, Kim Y-H (2002) An enhanced Lagrangian neural network for the eld problems with piecewise quadratic cost functions and nonlinear constraints. Electr Power Syst Res 60(3):167–177 -- [10.1016/S0378-7796(01)00181-X](https://doi.org/10.1016/S0378-7796(01)00181-X)
- Allen-Blanchette C, Veer S, Majumdar A, Leonard NE (2020) Lagnetvip: a Lagrangian neural network for video prediction. arXiv preprint arXiv:2010.12932
- Hohenberg PC, Halperin BI (1977) Theory of dynamic critical phenomena. Rev Modern Phys 49(3):435 -- [10.1103/RevModPhys.49.435](https://doi.org/10.1103/RevModPhys.49.435)
- Weinan E (2020) Machine learning and computational mathematics. Commun Comput Phys 28(5):1639–1670 -- [10.4208/cicp.OA-2020-0185](https://doi.org/10.4208/cicp.OA-2020-0185)
- Zhong YD, Dey B, Chakraborty A (2020) Dissipative symoden: encoding hamiltonian dynamics with dissipation and control into deep learning. arXiv preprint arXiv:2002.08860
- Zhong YD, Dey B, Chakraborty A (2021) Benchmarking energy-conserving neural networks for learning dynamics from data. In: Learning for dynamics and control, pp 1218–1229. PMLR, USA
- Gruver N, Finzi M, Stanton S, Wilson AG (2022) Deconstructing the inductive biases of hamiltonian neural networks. arXiv preprint arXiv:2202.04836
- Han J, Huang W, Ma H, Li J, Tenenbaum JB, Gan C (2022) Learning physical dynamics with subequivariant graph neural networks. arXiv preprint arXiv:2210.06876
- Wang R, Walters R, Yu R (2022) Approximately equivariant networks for imperfectly symmetric dynamics. arXiv preprint arXiv:2201.11969
- Eidnes S, Stasik AJ, Sterud C, Bøhn E, Riemer-Sø RS (2022) Port-hamiltonian neural networks with state dependent ports. arXiv preprint arXiv:2206.02660 -- [10.1016/j.physd.2023.133673](https://doi.org/10.1016/j.physd.2023.133673)
- Morrison Philip J (1984) Bracket formulation for irreversible classical fields. Phys Lett A 100(8):423–427 -- [10.1016/0375-9601(84)90635-2](https://doi.org/10.1016/0375-9601(84)90635-2)
- Morrison PJ (1986) A paradigm for joined Hamiltonian and dissipative systems. Phys D Nonlinear Phenom 18(1–3):410–419 -- [10.1016/0167-2789(86)90209-5](https://doi.org/10.1016/0167-2789(86)90209-5)
- Grmela M (1984) Particle and bracket formulations of kinetic equations. Contemp Math 28:125–132 -- [10.1090/conm/028/751978](https://doi.org/10.1090/conm/028/751978)
- Grmela M (1984) Bracket formulation of dissipative fluid mechanics equations. Phys Lett A 102(8):355–358 -- [10.1016/0375-9601(84)90297-4](https://doi.org/10.1016/0375-9601(84)90297-4)
- Kaufman AN (1984) Dissipative Hamiltonian systems: a unifying principle. Phys Lett A 100(8):419–422 -- [10.1016/0375-9601(84)90634-0](https://doi.org/10.1016/0375-9601(84)90634-0)
- Öttinger HC, Grmela M (1997) Dynamics and thermodynamics of complex fluids. ii. illustrations of a general formalism. Phys Rev E 56(6):6633 -- [10.1103/PhysRevE.56.6633](https://doi.org/10.1103/PhysRevE.56.6633)
- Öttinger HC (2005) Beyond equilibrium thermodynamics. John Wiley & Sons, New York -- [10.1002/0471727903](https://doi.org/10.1002/0471727903)
- Grmela M (2018) Generic guide to the multiscale dynamics and thermodynamics. J Phys Commun 2(3):032001 -- [10.1088/2399-6528/aab642](https://doi.org/10.1088/2399-6528/aab642)
- Grmela M, Klika V, Pavelka M (2019) Gradient and generic evolution towards reduced dynamics -- [10.1098/rsta.2019.0472](https://doi.org/10.1098/rsta.2019.0472)
- Pavelka M, Klika V, Grmela M (2018) Multiscale thermo-dynamics. In : Multiscale thermo-dynamics. de Gruyter, Berlin -- [10.1515/9783110350951](https://doi.org/10.1515/9783110350951)
- Quercus H, Badías A, González D, Chinesta F, Cueto E (2021) Structure-preserving neural networks. J Comput Phys 426:109950 -- [10.1016/j.jcp.2020.109950](https://doi.org/10.1016/j.jcp.2020.109950)
- Quercus H, Badias A, Gonzalez D, Chinesta F, Cueto E (2021) Deep learning of thermodynamics-aware reduced-order models from data. Comput Methods Appl Mech Eng 379:113763 -- [10.1016/j.cma.2021.113763](https://doi.org/10.1016/j.cma.2021.113763)
- Hernández Q, Badías A, Chinesta F, Cueto E (2022) Thermodynamics-informed graph neural networks. arXiv preprint arXiv:2203.01874 -- [10.1109/TAI.2022.3179681](https://doi.org/10.1109/TAI.2022.3179681)
- Moya B, Badias A, Gonzalez D, Chinesta F, Cueto E (2021) Physics perception in sloshing scenes with guaranteed thermodynamic consistency. arXiv preprint arXiv:2106.13301
- Moya B, Badias A, Gonzalez D, Chinesta F, Cueto E (2022) Physics-informed reinforcement learning for perception and reasoning about fluids. arXiv preprint arXiv:2203.05775 -- [10.1007/s00466-023-02279-x](https://doi.org/10.1007/s00466-023-02279-x)
- Zhang Z, Shin Y, Em Karniadakis G (2022) Gfinns: generic formalism informed neural networks for deterministic and stochastic dynamical systems. Philos Trans R Soc A 380(2229):20210207 -- [10.1098/rsta.2021.0207](https://doi.org/10.1098/rsta.2021.0207)
- Lee K, Trask N, Stinis P (2021) Machine learning structure preserving brackets for forecasting irreversible processes. Adv Neural Inf Process Syst 34:5696–5707
- Öttinger HC (2006) Nonequilibrium thermodynamics for open systems. Phys Rev E 73:036126 -- [10.1103/PhysRevE.73.036126](https://doi.org/10.1103/PhysRevE.73.036126)
- Badlyan AM, Maschke B, Beattie C, Mehrmann V (2018) Open physical systems: from generic to port-hamiltonian systems. arXiv preprint arXiv:1804.04064
- Betsch P, Schiebl M (2018) Variational formulations for large strain thermo-elastodynamics based on the generic formalism. In: Proceedings of the 6th European conference on computational mechanics, Glasgow, UK, pp 11–15
- Grmela M, Öttinger HC (1997) Dynamics and thermodynamics of complex fluids. i. development of a general formalism. Phys Rev E 56(6):6620 -- [10.1103/PhysRevE.56.6620](https://doi.org/10.1103/PhysRevE.56.6620)
- Romero I (2009) Thermodynamically consistent time-stepping algorithms for non-linear thermomechanical systems. Int J Numer Methods Eng 79(6):706–732 -- [10.1002/nme.2588](https://doi.org/10.1002/nme.2588)

