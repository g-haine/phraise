---
layout: post
title: "Port-metriplectic neural networks: thermodynamics-informed machine learning of complex physical systems"
date: 2023-03-27 00:00:00 +0100
permalink: port-metriplectic-neural-networks-thermodynamics-informed-machine-learning-of-complex-physical-systems
year: 2023
authors: Quercus Hernández, Alberto Badías, Francisco Chinesta, Elías Cueto
category: articles
tags:
  - Port-Hamiltonian
  - Thermodynamics
  - Scientific machine learning
  - Inductive biases
---
 
## Authors
[Quercus Hernández](authors/quercus-hernandez), [Alberto Badías](authors/alberto-badias), [Francisco Chinesta](authors/francisco-chinesta), [Elías Cueto](authors/elias-cueto)
 
## Abstract
We develop inductive biases for the machine learning of complex physical systems based on the port-Hamiltonian formalism. To satisfy by construction the principles of thermodynamics in the learned physics (conservation of energy, non-negative entropy production), we modify accordingly the port-Hamiltonian formalism so as to achieve a port-metriplectic one. We show that the constructed networks are able to learn the physics of complex systems by parts, thus alleviating the burden associated to the experimental characterization and posterior learning process of this kind of systems. Predictions can be done, however, at the scale of the complete system. Examples are shown on the performance of the proposed technique.
 
## Keywords
Port-Hamiltonian; Thermodynamics; Scientific machine learning; Inductive biases
 
## Citation
- **Journal:** Computational Mechanics
- **Year:** 2023
- **Volume:** 72
- **Issue:** 3
- **Pages:** 553--561
- **Publisher:** Springer Science and Business Media LLC
- **DOI:** [10.1007/s00466-023-02296-w](https://doi.org/10.1007/s00466-023-02296-w)
 
## BibTeX
{% highlight bibtex %}
{% raw %}
@article{Hern_ndez_2023,
  title={{Port-metriplectic neural networks: thermodynamics-informed machine learning of complex physical systems}},
  volume={72},
  ISSN={1432-0924},
  DOI={10.1007/s00466-023-02296-w},
  number={3},
  journal={Computational Mechanics},
  publisher={Springer Science and Business Media LLC},
  author={Hernández, Quercus and Badías, Alberto and Chinesta, Francisco and Cueto, Elías},
  year={2023},
  pages={553--561}
}
{% endraw %}
{% endhighlight %}
 
[Download the bib file]({{ site.baseurl }}/assets/bib/port-metriplectic-neural-networks-thermodynamics-informed-machine-learning-of-complex-physical-systems.bib)
 
## References
- Stachenfeld K, Fielding DB, Kochkov D, Cranmer M, Pfaff T, Godwin J, Cui C, Ho S, Battaglia P, Sanchez-Gonzalez A (2021) Learned simulators for turbulence. In: International conference on learning representations
- Allen KR, Lopez-Guevara T, Stachenfeld K, Sanchez-Gonzalez A, Battaglia P, Hamrick J, Pfaff T (2022) Physical design using differentiable learned simulators. arXiv preprint arXiv:2202.00728
- Battaglia PW, Hamrick JB, Bapst V, Sanchez-Gonzalez A, Zambaldi V, Malinowski M, Tacchetti A, Raposo D, Santoro A, Faulkner R et al (2018) Relational inductive biases, deep learning, and graph networks. arXiv preprint arXiv:1806.01261
- Bhattoo Ravinder, Ranu Sayan, Krishnan NM (2021) Lagrangian neural network with differentiable symmetries and relational inductive bias. arXiv preprint arXiv:2110.03266
- Mitchell TM (1980) The need for biases in learning generalizations. Department of Computer Science, Laboratory for Computer Science Research
- PAM Dirac. Dirac PAM (1929) Quantum mechanics of many-electron systems. Proc R Soc Lond Ser A Contain Papers Math Phys Character 123(792):714–733 (1929)
- [van der Schaft, A. & Jeltsema, D. Port-Hamiltonian Systems Theory: An Introductory Overview. Foundations and Trends® in Systems and Control vol. 1 173–378 (2014)](port-hamiltonian-systems-theory-an-introductory-overview) -- [10.1561/2600000002](https://doi.org/10.1561/2600000002)
- [Beattie, C. A., Mehrmann, V. & Van Dooren, P. Robust port-Hamiltonian representations of passive systems. Automatica vol. 100 182–186 (2019)](robust-port-hamiltonian-representations-of-passive-systems) -- [10.1016/j.automatica.2018.11.013](https://doi.org/10.1016/j.automatica.2018.11.013)
- [Rashad, R., Califano, F., van der Schaft, A. J. & Stramigioli, S. Twenty years of distributed port-Hamiltonian systems: a literature review. IMA Journal of Mathematical Control and Information vol. 37 1400–1422 (2020)](twenty-years-of-distributed-port-hamiltonian-systems-a-literature-review) -- [10.1093/imamci/dnaa018](https://doi.org/10.1093/imamci/dnaa018)
- E, W. A Proposal on Machine Learning via Dynamical Systems. Communications in Mathematics and Statistics vol. 5 1–11 (2017) -- [10.1007/s40304-017-0103-z](https://doi.org/10.1007/s40304-017-0103-z)
- Cueto, E. & Chinesta, F. Thermodynamics of Learning Physical Phenomena. Archives of Computational Methods in Engineering vol. 30 4653–4666 (2023) -- [10.1007/s11831-023-09954-5](https://doi.org/10.1007/s11831-023-09954-5)
- González, D., Chinesta, F. & Cueto, E. Thermodynamically consistent data-driven computational mechanics. Continuum Mechanics and Thermodynamics vol. 31 239–253 (2018) -- [10.1007/s00161-018-0677-z](https://doi.org/10.1007/s00161-018-0677-z)
- González, D., Chinesta, F. & Cueto, E. Learning Corrections for Hyperelastic Models From Data. Frontiers in Materials vol. 6 (2019) -- [10.3389/fmats.2019.00014](https://doi.org/10.3389/fmats.2019.00014)
- González, D., Chinesta, F. & Cueto, E. Learning non-Markovian physics from data. Journal of Computational Physics vol. 428 109982 (2021) -- [10.1016/j.jcp.2020.109982](https://doi.org/10.1016/j.jcp.2020.109982)
- Jin, P., Zhang, Z., Zhu, A., Tang, Y. & Karniadakis, G. E. SympNets: Intrinsic structure-preserving symplectic networks for identifying Hamiltonian systems. Neural Networks vol. 132 166–179 (2020) -- [10.1016/j.neunet.2020.08.017](https://doi.org/10.1016/j.neunet.2020.08.017)
- Chen Z, Feng M, Yan J, Zha H (2022) Learning neural Hamiltonian dynamics: a methodological overview. arXiv preprint arXiv:2203.00128
- Miller ST, Lindner JF, Choudhary A, Sinha S, Ditto WL (2020) Mastering high-dimensional dynamics with Hamiltonian neural networks. arXiv preprint arXiv:2008.04214
- Galimberti CL, Xu L, Trecate GF (2021) A unified framework for Hamiltonian deep neural networks. In: Learning for dynamics and control, pp 275–286. PMLR, USA
- Bertalan, T., Dietrich, F., Mezić, I. & Kevrekidis, I. G. On learning Hamiltonian systems from data. Chaos: An Interdisciplinary Journal of Nonlinear Science vol. 29 (2019) -- [10.1063/1.5128231](https://doi.org/10.1063/1.5128231)
- Toth P, Rezende DJ, Jaegle A, Racanière S, Botev A, Higgins I (2019) Hamiltonian generative networks. arXiv preprint arXiv:1909.13789
- Bhat, H. S., Ranka, K. & Isborn, C. M. Machine learning a molecular Hamiltonian for predicting electron dynamics. International Journal of Dynamics and Control vol. 8 1089–1101 (2020) -- [10.1007/s40435-020-00699-8](https://doi.org/10.1007/s40435-020-00699-8)
- Kochkov D, Pfaff T, Sanchez-Gonzalez A, Battaglia P, Clark BK (2021) Learning ground states of quantum hamiltonians with graph networks. arXiv preprint arXiv:2110.06390
- Gao, Y., Wang, X., Yu, N. & Wong, B. M. Harnessing deep reinforcement learning to construct time-dependent optimal fields for quantum control dynamics. Physical Chemistry Chemical Physics vol. 24 24012–24020 (2022) -- [10.1039/d2cp02495k](https://doi.org/10.1039/d2cp02495k)
- Lutter M, Ritter C, Peters J (2019) Deep Lagrangian networks: using physics as model prior for deep learning. arXiv preprint arXiv:1907.04490
- YD Zhong. Zhong YD, Leonard N (2020) Unsupervised learning of Lagrangian dynamics from images for prediction and control. Adv Neural Inf Proc Syst 33:10741–10752 (2020)
- Lee, S. C. & Kim, Y. H. An enhanced Lagrangian neural network for the ELD problems with piecewise quadratic cost functions and nonlinear constraints. Electric Power Systems Research vol. 60 167–177 (2002) -- [10.1016/s0378-7796(01)00181-x](https://doi.org/10.1016/s0378-7796(01)00181-x)
- Allen-Blanchette C, Veer S, Majumdar A, Leonard NE (2020) Lagnetvip: a Lagrangian neural network for video prediction. arXiv preprint arXiv:2010.12932
- Hohenberg, P. C. & Halperin, B. I. Theory of dynamic critical phenomena. Reviews of Modern Physics vol. 49 435–479 (1977) -- [10.1103/revmodphys.49.435](https://doi.org/10.1103/revmodphys.49.435)
- Weinan E, W. E. Machine Learning and Computational Mathematics. Communications in Computational Physics vol. 28 1639–1670 (2020) -- [10.4208/cicp.oa-2020-0185](https://doi.org/10.4208/cicp.oa-2020-0185)
- Zhong YD, Dey B, Chakraborty A (2020) Dissipative symoden: encoding hamiltonian dynamics with dissipation and control into deep learning. arXiv preprint arXiv:2002.08860
- Zhong YD, Dey B, Chakraborty A (2021) Benchmarking energy-conserving neural networks for learning dynamics from data. In: Learning for dynamics and control, pp 1218–1229. PMLR, USA
- Gruver N, Finzi M, Stanton S, Wilson AG (2022) Deconstructing the inductive biases of hamiltonian neural networks. arXiv preprint arXiv:2202.04836
- Han J, Huang W, Ma H, Li J, Tenenbaum JB, Gan C (2022) Learning physical dynamics with subequivariant graph neural networks. arXiv preprint arXiv:2210.06876
- Wang R, Walters R, Yu R (2022) Approximately equivariant networks for imperfectly symmetric dynamics. arXiv preprint arXiv:2201.11969
- [Eidnes, S., Stasik, A. J., Sterud, C., Bøhn, E. & Riemer-Sørensen, S. Pseudo-Hamiltonian neural networks with state-dependent external forces. Physica D: Nonlinear Phenomena vol. 446 133673 (2023)](pseudo-hamiltonian-neural-networks-with-state-dependent-external-forces) -- [10.1016/j.physd.2023.133673](https://doi.org/10.1016/j.physd.2023.133673)
- Morrison, P. J. Bracket formulation for irreversible classical fields. Physics Letters A vol. 100 423–427 (1984) -- [10.1016/0375-9601(84)90635-2](https://doi.org/10.1016/0375-9601(84)90635-2)
- Morrison, P. J. A paradigm for joined Hamiltonian and dissipative systems. Physica D: Nonlinear Phenomena vol. 18 410–419 (1986) -- [10.1016/0167-2789(86)90209-5](https://doi.org/10.1016/0167-2789(86)90209-5)
- Grmela, M. Particle and bracket formulations of kinetic equations. Contemporary Mathematics 125–132 (1984) doi:10.1090/conm/028/751978 -- [10.1090/conm/028/751978](https://doi.org/10.1090/conm/028/751978)
- Grmela, M. Bracket formulation of dissipative fluid mechanics equations. Physics Letters A vol. 102 355–358 (1984) -- [10.1016/0375-9601(84)90297-4](https://doi.org/10.1016/0375-9601(84)90297-4)
- Kaufman, A. N. Dissipative hamiltonian systems: A unifying principle. Physics Letters A vol. 100 419–422 (1984) -- [10.1016/0375-9601(84)90634-0](https://doi.org/10.1016/0375-9601(84)90634-0)
- Öttinger, H. C. & Grmela, M. Dynamics and thermodynamics of complex fluids.  II. Illustrations of a general formalism. Physical Review E vol. 56 6633–6655 (1997) -- [10.1103/physreve.56.6633](https://doi.org/10.1103/physreve.56.6633)
- Öttinger, H. C. Beyond Equilibrium Thermodynamics. (2005) doi:10.1002/0471727903 -- [10.1002/0471727903](https://doi.org/10.1002/0471727903)
- Grmela, M. GENERIC guide to the multiscale dynamics and thermodynamics. Journal of Physics Communications vol. 2 032001 (2018) -- [10.1088/2399-6528/aab642](https://doi.org/10.1088/2399-6528/aab642)
- Grmela, M., Klika, V. & Pavelka, M. Gradient and GENERIC time evolution towards reduced dynamics. Philosophical Transactions of the Royal Society A: Mathematical, Physical and Engineering Sciences vol. 378 20190472 (2020) -- [10.1098/rsta.2019.0472](https://doi.org/10.1098/rsta.2019.0472)
- Pavelka, M., Klika, V. & Grmela, M. Multiscale Thermo-Dynamics. (2018) doi:10.1515/9783110350951 -- [10.1515/9783110350951](https://doi.org/10.1515/9783110350951)
- Hernández, Q., Badías, A., González, D., Chinesta, F. & Cueto, E. Structure-preserving neural networks. Journal of Computational Physics vol. 426 109950 (2021) -- [10.1016/j.jcp.2020.109950](https://doi.org/10.1016/j.jcp.2020.109950)
- Hernandez, Q., Badías, A., González, D., Chinesta, F. & Cueto, E. Deep learning of thermodynamics-aware reduced-order models from data. Computer Methods in Applied Mechanics and Engineering vol. 379 113763 (2021) -- [10.1016/j.cma.2021.113763](https://doi.org/10.1016/j.cma.2021.113763)
- Hernández, Q., Badías, A., Chinesta, F. & Cueto, E. Thermodynamics-Informed Graph Neural Networks. IEEE Transactions on Artificial Intelligence vol. 5 967–976 (2024) -- [10.1109/tai.2022.3179681](https://doi.org/10.1109/tai.2022.3179681)
- Moya B, Badias A, Gonzalez D, Chinesta F, Cueto E (2021) Physics perception in sloshing scenes with guaranteed thermodynamic consistency. arXiv preprint arXiv:2106.13301
- Moya, B., Badías, A., González, D., Chinesta, F. & Cueto, E. A thermodynamics-informed active learning approach to perception and reasoning about fluids. Computational Mechanics vol. 72 577–591 (2023) -- [10.1007/s00466-023-02279-x](https://doi.org/10.1007/s00466-023-02279-x)
- Zhang, Z., Shin, Y. & Em Karniadakis, G. GFINNs: GENERIC formalism informed neural networks for deterministic and stochastic dynamical systems. Philosophical Transactions of the Royal Society A: Mathematical, Physical and Engineering Sciences vol. 380 (2022) -- [10.1098/rsta.2021.0207](https://doi.org/10.1098/rsta.2021.0207)
- K Lee. Lee K, Trask N, Stinis P (2021) Machine learning structure preserving brackets for forecasting irreversible processes. Adv Neural Inf Process Syst 34:5696–5707 (2021)
- Öttinger, H. C. Nonequilibrium thermodynamics for open systems. Physical Review E vol. 73 (2006) -- [10.1103/physreve.73.036126](https://doi.org/10.1103/physreve.73.036126)
- Badlyan AM, Maschke B, Beattie C, Mehrmann V (2018) Open physical systems: from generic to port-hamiltonian systems. arXiv preprint arXiv:1804.04064
- Betsch P, Schiebl M (2018) Variational formulations for large strain thermo-elastodynamics based on the generic formalism. In: Proceedings of the 6th European conference on computational mechanics, Glasgow, UK, pp 11–15
- Grmela, M. & Öttinger, H. C. Dynamics and thermodynamics of complex fluids.  I. Development of a general formalism. Physical Review E vol. 56 6620–6632 (1997) -- [10.1103/physreve.56.6620](https://doi.org/10.1103/physreve.56.6620)
- Romero, I. Thermodynamically consistent time‐stepping algorithms for non‐linear thermomechanical systems. International Journal for Numerical Methods in Engineering vol. 79 706–732 (2009) -- [10.1002/nme.2588](https://doi.org/10.1002/nme.2588)

