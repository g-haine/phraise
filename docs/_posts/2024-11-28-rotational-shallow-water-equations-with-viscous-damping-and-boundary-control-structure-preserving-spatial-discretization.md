---
layout: post
title: "Rotational shallow water equations with viscous damping and boundary control: structure-preserving spatial discretization"
date: 2024-11-28 00:00:00 +0100
permalink: rotational-shallow-water-equations-with-viscous-damping-and-boundary-control-structure-preserving-spatial-discretization
year: 2024
authors: Flávio Luiz Cardoso-Ribeiro, Ghislain Haine, Laurent Lefèvre, Denis Matignon
category: articles
tags:
  - Shallow water equations (SWE)
  - Port-Hamiltonian systems (pHs)
  - Viscous damping
  - Partitioned finite element method (PFEM)
  - 76D55
  - 35Q35
  - 76M10
---
 
## Authors
[Flávio Luiz Cardoso-Ribeiro](authors/flavio-luiz-cardoso-ribeiro), [Ghislain Haine](authors/ghislain-haine), [Laurent Lefèvre](authors/laurent-lefevre), [Denis Matignon](authors/denis-matignon)
 
## Abstract
This paper is dedicated to structure-preserving spatial discretization of shallow water dynamics. First, a port-Hamiltonian formulation is provided for the two-dimensional rotational shallow water equations with viscous damping. Both tangential and normal boundary port variables are introduced. Then, the corresponding weak form is derived and a partitioned finite element method is applied to obtain a finite-dimensional continuous-time port-Hamiltonian approximation. Four simulation scenarios are investigated to illustrate the approach and show its effectiveness.
 
## Keywords
Shallow water equations (SWE); Port-Hamiltonian systems (pHs); Viscous damping; Partitioned finite element method (PFEM); 76D55; 35Q35; 76M10
 
## Citation
- **Journal:** Mathematics of Control, Signals, and Systems
- **Year:** 2024
- **Volume:** 
- **Issue:** 
- **Pages:** 
- **Publisher:** Springer Science and Business Media LLC
- **DOI:** [10.1007/s00498-024-00404-6](https://doi.org/10.1007/s00498-024-00404-6)
 
## BibTeX
{% highlight bibtex %}
{% raw %}
@article{Cardoso_Ribeiro_2024,
  title={{Rotational shallow water equations with viscous damping and boundary control: structure-preserving spatial discretization}},
  ISSN={1435-568X},
  DOI={10.1007/s00498-024-00404-6},
  journal={Mathematics of Control, Signals, and Systems},
  publisher={Springer Science and Business Media LLC},
  author={Cardoso-Ribeiro, Flávio Luiz and Haine, Ghislain and Lefèvre, Laurent and Matignon, Denis},
  year={2024}
}
{% endraw %}
{% endhighlight %}
 
## References
- Robles RR, Serrano JP (2014) Sloshing mechanical model for stability and handling qualities evaluation of the C295 aircraft with the OSD system. In: Proceedings of 29th Congress of the International Council of the Aeronautical Sciences, St. Petersburg, Russia
- Cho Y-S, Sohn D-H, Lee SO (2007) Practical modified scheme of linear shallow-water equations for distant propagation of tsunamis. Ocean Eng 34(11–12):1769–1777 -- [10.1016/j.oceaneng.2006.08.014](https://doi.org/10.1016/j.oceaneng.2006.08.014)
- Clifford M, Horton C, Schmitz J (1994) Swafs: Shallow water analysis and forecast system. In: Proceedings of OCEANS’94, vol. 3, p. 82. IEEE -- [10.1109/OCEANS.1994.364176](https://doi.org/10.1109/OCEANS.1994.364176)
- Barati R, Rahimi S, Akbari GH (2012) Analysis of dynamic wave model for flood routing in natural rivers. Water Sci Eng 5(3):243–258
- Gilman PA (2000) Magnetohydrodynamic shallow water equations for the solar tachocline. Astrophys J 544(1):79 -- [10.1086/317291](https://doi.org/10.1086/317291)
- Zeitlin V (2018) Geophysical fluid dynamics: understanding (almost) everything with rotating shallow water models. Oxford University Press, Oxford -- [10.1093/oso/9780198804338.001.0001](https://doi.org/10.1093/oso/9780198804338.001.0001)
- Fraccarollo L, Toro EF (1995) Experimental and numerical assessment of the shallow water model for two-dimensional dam-break type problems. J Hydraul Res 33(6):843–864 -- [10.1080/00221689509498555](https://doi.org/10.1080/00221689509498555)
- [Cardoso-Ribeiro FL, Brugnoli A, Matignon D, Lefèvre L (2019) Port-Hamiltonian modeling, discretization and feedback control of a circular water tank. In: 2019 IEEE 58th Conference on Decision and Control (CDC), pp 6881–6886. 10.1109/CDC40024.2019.9030007](port-hamiltonian-modeling-discretization-and-feedback-control-of-a-circular-water-tank) -- [10.1109/CDC40024.2019.9030007](https://doi.org/10.1109/CDC40024.2019.9030007)
- Noble DR, Davey T, Smith HC, Kaklis P, Robinson A, Bruce T (2015) Spatial variation in currents generated in the flowave ocean energy research facility. In: Proceedings of the 11th European Wave and Tidal Energy Conference (EWTEC2015), pp 1–8 (2015). Nantes France
- Kirstetter G, Hu J, Delestre O, Darboux F, Lagrée P-Y, Popinet S, Fullana JM, Josserand C (2016) Modeling rain-driven overland flow: empirical versus analytical friction terms in the shallow water approximation. J Hydrol 536:1–9. https://doi.org/10.1016/j.jhydrol.2016.02.022 -- [10.1016/j.jhydrol.2016.02.022](https://doi.org/10.1016/j.jhydrol.2016.02.022)
- James F, Lagrée P-Y, Le MH, Legrand M (2019) Towards a new friction model for shallow water equations through an interactive viscous layer. ESAIM: M2AN 53(1), 269–299. 10.1051/m2an/2018076 -- [10.1051/m2an/2018076](https://doi.org/10.1051/m2an/2018076)
- Lagrée P-Y (2021) Equations de Saint Venant et application aux mouvements de fonds érodables, Paris, France. Class notes. http://www.lmm.jussieu.fr/%7Elagree/COURS/MFEnv/MFEnv.pdf
- Gerbeau J-F, Perthame B (2001) Derivation of viscous Saint-Venant system for laminar shallow water; numerical validation. Dis Contin Dyn Syst B 1(1):89–102. https://doi.org/10.3934/dcdsb.2001.1.89 -- [10.3934/dcdsb.2001.1.89](https://doi.org/10.3934/dcdsb.2001.1.89)
- Marche F (2007) Derivation of a new two-dimensional viscous shallow water model with varying topography, bottom friction and capillary effects. Eur J Mech B/Fluids 26:49–63. https://doi.org/10.1016/j.euromechflu.2006.04.007 -- [10.1016/j.euromechflu.2006.04.007](https://doi.org/10.1016/j.euromechflu.2006.04.007)
- Sundbye L (1998) Global existence for the cauchy problem for the viscous shallow water equations. Rocky Mountain J Math 28(3):1135–1152 -- [10.1216/rmjm/1181071760](https://doi.org/10.1216/rmjm/1181071760)
- [Duindam V, Macchelli A, Stramigioli S, Bruyninckx H (2009) Modeling and Control of Complex Physical Systems: The Port-Hamiltonian Approach, p. 442. Springer, Berlin, Heidelberg. 10.1007/978-3-642-03196-0](modeling-and-control-of-complex-physical-systems) -- [10.1007/978-3-642-03196-0](https://doi.org/10.1007/978-3-642-03196-0)
- [van der Schaft AJ, Jeltsema D (2014) Port-Hamiltonian systems theory: an introductory overview. Found Trends Syst Control 1(2):173–378](port-hamiltonian-systems-theory-an-introductory-overview-journal) -- [10.1561/2600000002](https://doi.org/10.1561/2600000002)
- [Rashad R, Califano F, van der Schaft AJ, Stramigioli S (2020) Twenty years of distributed port-Hamiltonian systems: a literature review. IMA J Math Control Inf 37(4):1400–1422](twenty-years-of-distributed-port-hamiltonian-systems-a-literature-review) -- [10.1093/imamci/dnaa018](https://doi.org/10.1093/imamci/dnaa018)
- [Hamroun B, Lefevre L, Mendes E (2007) Port-based modelling and geometric reduction for open channel irrigation systems. In: Proceedings of the 46th IEEE Conference on Decision and Control, pp. 1578–1583. IEEE, New Orleans, LA, USA. 10.1109/CDC.2007.4434237](port-based-modelling-and-geometric-reduction-for-open-channel-irrigation-systems) -- [10.1109/CDC.2007.4434237](https://doi.org/10.1109/CDC.2007.4434237)
- [Pasumarthy R, Ambati VR, van der Schaft AJ (2012) Port-Hamiltonian discretization for open channel flows. Syst Control Lett 61(9):950–958](port-hamiltonian-discretization-for-open-channel-flows) -- [10.1016/j.sysconle.2012.05.003](https://doi.org/10.1016/j.sysconle.2012.05.003)
- Hamroun B, Dimofte A, Lefèvre L, Mendes E (2010) Control by interconnection and energy-shaping methods of port hamiltonian models. Application to the Shallow Water Equations. Eur J Control 16(5):545–563 -- [10.3166/ejc.16.545-563](https://doi.org/10.3166/ejc.16.545-563)
- [Cardoso-Ribeiro FL, Matignon D, Pommier-Budinger V (2017) A port-Hamiltonian model of liquid sloshing in moving containers and application to a fluid-structure system. J Fluids Struct 69:402–427. https://doi.org/10.1016/j.jfluidstructs.2016.12.007](a-port-hamiltonian-model-of-liquid-sloshing-in-moving-containers-and-application-to-a-fluid-structure-system) -- [10.1016/j.jfluidstructs.2016.12.007](https://doi.org/10.1016/j.jfluidstructs.2016.12.007)
- [Cardoso-Ribeiro FL, Matignon D, Pommier-Budinger V (2020) Port-Hamiltonian model of two-dimensional shallow water equations in moving containers. IMA J Math Control Inf 37(4):1348–1366. https://doi.org/10.1093/imamci/dnaa016](port-hamiltonian-model-of-two-dimensional-shallow-water-equations-in-moving-containers) -- [10.1093/imamci/dnaa016](https://doi.org/10.1093/imamci/dnaa016)
- [Califano F, Rashad R, Schuller FP, Stramigioli S (2021) Geometric and energy-aware decomposition of the Navier-Stokes equations: a port-Hamiltonian approach. Phys Fluids 33(4):047114. https://doi.org/10.1063/5.0048359](geometric-and-energy-aware-decomposition-of-the-navier-stokes-equations-a-port-hamiltonian-approach) -- [10.1063/5.0048359](https://doi.org/10.1063/5.0048359)
- [Cardoso-Ribeiro FL, Matignon D, Lefèvre L (2021) Dissipative Shallow Water equations: a port-Hamiltonian formulation. IFAC-PapersOnLine 54(19):167–172](dissipative-shallow-water-equations-a-port-hamiltonian-formulation) -- [10.1016/j.ifacol.2021.11.073](https://doi.org/10.1016/j.ifacol.2021.11.073)
- Limache A, Sánchez PJ, Dalcín L, Idelsohn S (2008) Objectivity tests for Navier-Stokes simulations: the revealing of non-physical solutions produced by Laplace formulations. Comput Methods Appl Mech Engrg 197:4180–4192. https://doi.org/10.1016/j.cma.2008.04.020 -- [10.1016/j.cma.2008.04.020](https://doi.org/10.1016/j.cma.2008.04.020)
- Leborgne G (2023) Objectivity in continuum mechanics, an introduction. motions, Eulerian and Lagrangian variables and functions, deformation gradient, Lie derivatives, velocity-addition formula, Coriolis. arXiv preprint arXiv:2301.01056
- Bossavit A (1998) Computational electromagnetism: variational formulations, complementarity, edge elements. Academic Press, San Diego
- [Kotyczka P, Maschke B, Lefèvre L (2018) Weak form of Stokes-Dirac structures and geometric discretization of port-Hamiltonian systems. J Comput Phys 361:442–476](weak-form-of-stokes-dirac-structures-and-geometric-discretization-of-port-hamiltonian-systems) -- [10.1016/j.jcp.2018.02.006](https://doi.org/10.1016/j.jcp.2018.02.006)
- [Cardoso-Ribeiro FL, Matignon D, Lefèvre L (2021) A Partitioned Finite-Element Method for power-preserving discretization of open systems of conservation laws. IMA J Math Control Inf 38(2):493–533. https://doi.org/10.1093/imamci/dnaa038](a-partitioned-finite-element-method-for-power-preserving-discretization-of-open-systems-of-conservation-laws) -- [10.1093/imamci/dnaa038](https://doi.org/10.1093/imamci/dnaa038)
- [Ferraro G, Fournié M, Haine G (2024) Simulation and control of interactions in multi-physics, a Python package for port-Hamiltonian systems. IFAC-PapersOnLine 58(6):119–124](simulation-and-control-of-interactions-in-multi-physics-a-python-package-for-port-hamiltonian-systems) -- [10.1016/j.ifacol.2024.08.267](https://doi.org/10.1016/j.ifacol.2024.08.267)
- [Haine G, Matignon D, Serhani A (2023) Numerical analysis of a structure-preserving space-discretization for an anisotropic and heterogeneous boundary controlled $${N}$$-dimensional wave equation as a port-Hamiltonian system. Int J Numer Anal Mod 20(1):92–133. https://doi.org/10.4208/ijnam2023-1005](numerical-analysis-of-a-structure-preserving-space-discretization-for-an-anisotropic-and-heterogeneous-boundary-controlled-n-dimensional-wave-equation-as-a-port-hamiltonian-system) -- [10.4208/ijnam2023-1005](https://doi.org/10.4208/ijnam2023-1005)
- Boyer F, Fabrie P (2013) Mathematical Tools for the Study of the Incompressible Navier-Stokes Equations and Related Models. Applied Mathematical Sciences, vol 183, p 525. Springer, New York -- [10.1007/978-1-4614-5975-0](https://doi.org/10.1007/978-1-4614-5975-0)
- Cotter CJ (2023) Compatible finite element methods for geophysical fluid dynamics. Acta Numer 32:291–393. https://doi.org/10.1017/S0962492923000028 -- [10.1017/S0962492923000028](https://doi.org/10.1017/S0962492923000028)
- Arnold DN, Falk RS, Winther R (2006) Finite element exterior calculus, homological techniques, and applications. Acta Numer 15:1–155. https://doi.org/10.1017/S0962492906210018 -- [10.1017/S0962492906210018](https://doi.org/10.1017/S0962492906210018)
- Olver PJ (1993) Applications of lie groups to differential equations, vol 107, 2nd edn. Springer, New York -- [10.1007/978-1-4612-4350-2](https://doi.org/10.1007/978-1-4612-4350-2)
- [van der Schaft AJ, Maschke BM (2002) Hamiltonian formulation of distributed-parameter systems with boundary energy flow. J Geom Phys 42:166–194](hamiltonian-formulation-of-distributed-parameter-systems-with-boundary-energy-flow) -- [10.1016/S0393-0440(01)00083-3](https://doi.org/10.1016/S0393-0440(01)00083-3)
- [Mehrmann V, Unger B (2023) Control of port-Hamiltonian differential-algebraic systems and applications. Acta Numer 32:395–515. https://doi.org/10.1017/S0962492922000083](control-of-port-hamiltonian-differential-algebraic-systems-and-applications) -- [10.1017/S0962492922000083](https://doi.org/10.1017/S0962492922000083)
- [Altmann R, Schulze P (2017) A port-Hamiltonian formulation of the Navier-Stokes equations for reactive flows. Syst Control Lett 100:51–55. https://doi.org/10.1016/j.sysconle.2016.12.005](a-port-hamiltonian-formulation-of-the-navier-stokes-equations-for-reactive-flows) -- [10.1016/j.sysconle.2016.12.005](https://doi.org/10.1016/j.sysconle.2016.12.005)
- Chorin AJ, Marsden JE (1992) A mathematical introduction to fluid mechanics, vol 4. Texts in Applied Mathematics. Springer, New York
- Moses Badlyan A, Maschke B, Beattie CA, Mehrmann V (2018) Open physical systems: from GENERIC to Port-Hamiltonian systems. In: Proceeding of the International Symposium on Mathematical Theory of Networks and Systems, Hong Kong, China, pp 204–211
- [Brugnoli A, Alazard D, Pommier-Budinger V, Matignon D (2019) Port-Hamiltonian formulation and symplectic discretization of plate models Part I: Mindlin model for thick plates. Appl Math Model 75:940–960. https://doi.org/10.1016/j.apm.2019.04.035](port-hamiltonian-formulation-and-symplectic-discretization-of-plate-models-part-i-mindlin-model-for-thick-plates) -- [10.1016/j.apm.2019.04.035](https://doi.org/10.1016/j.apm.2019.04.035)
- [Mora LA, Le Gorrec Y, Matignon D, Ramirez H, Yuz JI (2021) On port-Hamiltonian formulations of 3-dimensional compressible Newtonian fluids. Phys Fluids 33(11):117117. https://doi.org/10.1063/5.0067784](on-port-hamiltonian-formulations-of-3-dimensional-compressible-newtonian-fluids) -- [10.1063/5.0067784](https://doi.org/10.1063/5.0067784)
- Sundbye L (1996) Global existence for the Dirichlet problem for the viscous shallow water equations. J Math Anal Appl 202(1):236–258. https://doi.org/10.1006/jmaa.1996.0315 -- [10.1006/jmaa.1996.0315](https://doi.org/10.1006/jmaa.1996.0315)
- Kloeden PE (1985) Global existence of classical solutions in the dissipative shallow water equations. SIAM J Math Anal 16(2):301–315. https://doi.org/10.1137/0516022 -- [10.1137/0516022](https://doi.org/10.1137/0516022)
- [Serhani A, Matignon D, Haine G (2019) A partitioned finite element method for the structure-preserving discretization of damped infinite-dimensional port-Hamiltonian systems with boundary control. In: Geometric Science of Information, pp 549–558. Springer, Cham. 10.1007/978-3-030-26980-7_57](a-partitioned-finite-element-method-for-the-structure-preserving-discretization-of-damped-infinite-dimensional-port-hamiltonian-systems-with-boundary-control) -- [10.1007/978-3-030-26980-7_57](https://doi.org/10.1007/978-3-030-26980-7_57)
- van der Schaft AJ (2013) Port-Hamiltonian differential-algebraic systems. Springer, Berlin, pp 173–226
- [Mehrmann V, van der Schaft A (2023) Differential-algebraic systems with dissipative Hamiltonian structure. Math Control Signals Syst 35:541–584. https://doi.org/10.1007/s00498-023-00349-2](differential-algebraic-systems-with-dissipative-hamiltonian-structure) -- [10.1007/s00498-023-00349-2](https://doi.org/10.1007/s00498-023-00349-2)
- [Beattie C, Mehrmann V, Xu H, Zwart H (2018) Linear port-Hamiltonian descriptor systems. Math Control Signals Syst 30:17. https://doi.org/10.1007/s00498-018-0223-3](linear-port-hamiltonian-descriptor-systems) -- [10.1007/s00498-018-0223-3](https://doi.org/10.1007/s00498-018-0223-3)
- [van der Schaft A, Mehrmann V (2023) Linear port-Hamiltonian DAE systems revisited. Syst Control Lett 177:105564. https://doi.org/10.1016/j.sysconle.2023.105564](linear-port-hamiltonian-dae-systems-revisited) -- [10.1016/j.sysconle.2023.105564](https://doi.org/10.1016/j.sysconle.2023.105564)
- [Bendimerad-Hohl A, Haine G, Matignon D, Maschke B (2022) Structure-preserving discretization of a coupled Allen-Cahn and heat equation system. IFAC-PapersOnLine 55(18):99–104. https://doi.org/10.1016/j.ifacol.2022.08.037](structure-preserving-discretization-of-a-coupled-allen-cahn-and-heat-equation-system) -- [10.1016/j.ifacol.2022.08.037](https://doi.org/10.1016/j.ifacol.2022.08.037)
- [Bendimerad-Hohl A, Haine G, Matignon D (2023) Structure-preserving discretization of the Cahn-Hilliard equations recast as a port-Hamiltonian system. In: Geometric Science of Information, pp 192–201. Springer, Cham. 10.1007/978-3-031-38299-4_21](structure-preserving-discretization-of-the-cahn-hilliard-equations-recast-as-a-port-hamiltonian-system) -- [10.1007/978-3-031-38299-4_21](https://doi.org/10.1007/978-3-031-38299-4_21)
- Balay S, Abhyankar S, Adams MF, Benson S, Brown J, Brune P, Buschelman K, Constantinescu E, Dalcin L, Dener A, Eijkhout V, Faibussowitsch J, Gropp WD, Hapla V, Isaac T, Jolivet P, Karpeev D, Kaushik D, Knepley MG, Kong F, Kruger S, May DA, McInnes LC, Mills RT, Mitchell L, Munson T, Roman JE, Rupp K, Sanan P, Sarich J, Smith BF, Zampini S, Zhang H, Zhang H, Zhang J (2023) PETSc/TAO users manual. Technical Report ANL-21/39 - Revision 3.20, Argonne National Laboratory. 10.2172/1968587 -- [10.2172/2205494](https://doi.org/10.2172/2205494)
- Stoker JJ (1992) Water waves. Wiley, New York -- [10.1002/9781118033159](https://doi.org/10.1002/9781118033159)

