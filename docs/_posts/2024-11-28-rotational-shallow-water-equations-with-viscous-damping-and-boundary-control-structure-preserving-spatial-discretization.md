---
layout: post
title: "Rotational shallow water equations with viscous damping and boundary control: structure-preserving spatial discretization"
date: 2024-11-28 00:00:00 +0100
permalink: rotational-shallow-water-equations-with-viscous-damping-and-boundary-control-structure-preserving-spatial-discretization
year: 2025
authors: Flávio Luiz Cardoso-Ribeiro, Ghislain Haine, Laurent Lefèvre, Denis Matignon
category: articles
tags:
  - Shallow water equations (SWE)
  - Port-Hamiltonian systems (pHs)
  - Viscous damping
  - Partitioned finite element method (PFEM)
  - 76D55
  - 35Q35
  - 76M10
---
 
## Authors
[Flávio Luiz Cardoso-Ribeiro](authors/flavio-luiz-cardoso-ribeiro), [Ghislain Haine](authors/ghislain-haine), [Laurent Lefèvre](authors/laurent-lefevre), [Denis Matignon](authors/denis-matignon)
 
## Abstract
This paper is dedicated to structure-preserving spatial discretization of shallow water dynamics. First, a port-Hamiltonian formulation is provided for the two-dimensional rotational shallow water equations with viscous damping. Both tangential and normal boundary port variables are introduced. Then, the corresponding weak form is derived and a partitioned finite element method is applied to obtain a finite-dimensional continuous-time port-Hamiltonian approximation. Four simulation scenarios are investigated to illustrate the approach and show its effectiveness.
 
## Keywords
Shallow water equations (SWE); Port-Hamiltonian systems (pHs); Viscous damping; Partitioned finite element method (PFEM); 76D55; 35Q35; 76M10
 
## Citation
- **Journal:** Mathematics of Control, Signals, and Systems
- **Year:** 2025
- **Volume:** 37
- **Issue:** 2
- **Pages:** 361--394
- **Publisher:** Springer Science and Business Media LLC
- **DOI:** [10.1007/s00498-024-00404-6](https://doi.org/10.1007/s00498-024-00404-6)
 
## BibTeX
{% highlight bibtex %}
{% raw %}
@article{Cardoso_Ribeiro_2024,
  title={{Rotational shallow water equations with viscous damping and boundary control: structure-preserving spatial discretization}},
  volume={37},
  ISSN={1435-568X},
  DOI={10.1007/s00498-024-00404-6},
  number={2},
  journal={Mathematics of Control, Signals, and Systems},
  publisher={Springer Science and Business Media LLC},
  author={Cardoso-Ribeiro, Flávio Luiz and Haine, Ghislain and Lefèvre, Laurent and Matignon, Denis},
  year={2025},
  pages={361--394}
}
{% endraw %}
{% endhighlight %}
 
[Download the bib file]({{ site.baseurl }}/assets/bib/rotational-shallow-water-equations-with-viscous-damping-and-boundary-control-structure-preserving-spatial-discretization.bib)
 
## References
- Cho, Y.-S., Sohn, D.-H. & Lee, S. O. Practical modified scheme of linear shallow-water equations for distant propagation of tsunamis. Ocean Engineering 34, 1769–1777 (2007) -- [10.1016/j.oceaneng.2006.08.014](https://doi.org/10.1016/j.oceaneng.2006.08.014)
- Clifford, M., Horton, C. & Schmitz, J. SWAFS: shallow water analysis and forecast system. Proceedings of OCEANS’94 vol. 3 III/82-III/87 -- [10.1109/oceans.1994.364176](https://doi.org/10.1109/oceans.1994.364176)
- R Barati, Water Sci Eng (2012)
- Gilman, P. A. Magnetohydrodynamic “Shallow Water” Equations for the Solar Tachocline. The Astrophysical Journal 544, L79–L82 (2000) -- [10.1086/317291](https://doi.org/10.1086/317291)
- Zeitlin, V. Geophysical Fluid Dynamics. (2018) doi:10.1093/oso/9780198804338.001.0001 -- [10.1093/oso/9780198804338.001.0001](https://doi.org/10.1093/oso/9780198804338.001.0001)
- Fraccarollo, L. & Toro, E. F. Experimental and numerical assessment of the shallow water model for two-dimensional dam-break type problems. Journal of Hydraulic Research 33, 843–864 (1995) -- [10.1080/00221689509498555](https://doi.org/10.1080/00221689509498555)
- [Cardoso-Ribeiro, F. L., Brugnoli, A., Matignon, D. & Lefevre, L. Port-Hamiltonian modeling, discretization and feedback control of a circular water tank. 2019 IEEE 58th Conference on Decision and Control (CDC) 6881–6886 (2019) doi:10.1109/cdc40024.2019.9030007](port-hamiltonian-modeling-discretization-and-feedback-control-of-a-circular-water-tank) -- [10.1109/cdc40024.2019.9030007](https://doi.org/10.1109/cdc40024.2019.9030007)
- Kirstetter, G. et al. Modeling rain-driven overland flow: Empirical versus analytical friction terms in the shallow water approximation. Journal of Hydrology 536, 1–9 (2016) -- [10.1016/j.jhydrol.2016.02.022](https://doi.org/10.1016/j.jhydrol.2016.02.022)
- James, F., Lagrée, P.-Y., Le, M. H. & Legrand, M. Towards a new friction model for shallow water equations through an interactive viscous layer. ESAIM: M2AN 53, 269–299 (2019) -- [10.1051/m2an/2018076](https://doi.org/10.1051/m2an/2018076)
- Gerbeau, J.-F. & Perthame, B. Derivation of viscous Saint-Venant system for laminar shallow water; Numerical validation. Discrete &amp; Continuous Dynamical Systems - B 1, 89–102 (2001) -- [10.3934/dcdsb.2001.1.89](https://doi.org/10.3934/dcdsb.2001.1.89)
- Marche, F. Derivation of a new two-dimensional viscous shallow water model with varying topography, bottom friction and capillary effects. European Journal of Mechanics - B/Fluids 26, 49–63 (2007) -- [10.1016/j.euromechflu.2006.04.007](https://doi.org/10.1016/j.euromechflu.2006.04.007)
- Sundbye, L. Global Existence for the Cauchy Problem for the Viscous Shallow Water Equations. Rocky Mountain J. Math. 28, (1998) -- [10.1216/rmjm/1181071760](https://doi.org/10.1216/rmjm/1181071760)
- [Duindam, V., Macchelli, A., Stramigioli, S. & Bruyninckx, H. Modeling and Control of Complex Physical Systems. (Springer Berlin Heidelberg, 2009). doi:10.1007/978-3-642-03196-0](modeling-and-control-of-complex-physical-systems) -- [10.1007/978-3-642-03196-0](https://doi.org/10.1007/978-3-642-03196-0)
- [van der Schaft, A. & Jeltsema, D. Port-Hamiltonian Systems Theory: An Introductory Overview. FnT in Systems and Control 1, 173–378 (2014)](port-hamiltonian-systems-theory-an-introductory-overview) -- [10.1561/2600000002](https://doi.org/10.1561/2600000002)
- [Rashad, R., Califano, F., van der Schaft, A. J. & Stramigioli, S. Twenty years of distributed port-Hamiltonian systems: a literature review. IMA Journal of Mathematical Control and Information 37, 1400–1422 (2020)](twenty-years-of-distributed-port-hamiltonian-systems-a-literature-review) -- [10.1093/imamci/dnaa018](https://doi.org/10.1093/imamci/dnaa018)
- [Hamroun, B., Lefevre, L. & Mendes, E. Port-based modelling and geometric reduction for open channel irrigation systems. 2007 46th IEEE Conference on Decision and Control 1578–1583 (2007) doi:10.1109/cdc.2007.4434237](port-based-modelling-and-geometric-reduction-for-open-channel-irrigation-systems) -- [10.1109/cdc.2007.4434237](https://doi.org/10.1109/cdc.2007.4434237)
- [Pasumarthy, R., Ambati, V. R. & van der Schaft, A. J. Port-Hamiltonian discretization for open channel flows. Systems &amp; Control Letters 61, 950–958 (2012)](port-hamiltonian-discretization-for-open-channel-flows) -- [10.1016/j.sysconle.2012.05.003](https://doi.org/10.1016/j.sysconle.2012.05.003)
- [Hamroun, B., Dimofte, A., Lefèvre, L. & Mendes, E. Control by Interconnection and Energy-Shaping Methods of Port Hamiltonian Models. Application to the Shallow Water Equations. European Journal of Control 16, 545–563 (2010)](control-by-interconnection-and-energy-shaping-methods-of-port-hamiltonian-models-application-to-the-shallow-water-equations) -- [10.3166/ejc.16.545-563](https://doi.org/10.3166/ejc.16.545-563)
- [Cardoso-Ribeiro, F. L., Matignon, D. & Pommier-Budinger, V. A port-Hamiltonian model of liquid sloshing in moving containers and application to a fluid-structure system. Journal of Fluids and Structures 69, 402–427 (2017)](a-port-hamiltonian-model-of-liquid-sloshing-in-moving-containers-and-application-to-a-fluid-structure-system) -- [10.1016/j.jfluidstructs.2016.12.007](https://doi.org/10.1016/j.jfluidstructs.2016.12.007)
- [Cardoso-Ribeiro, F. L., Matignon, D. & Pommier-Budinger, V. Port-Hamiltonian model of two-dimensional shallow water equations in moving containers. IMA Journal of Mathematical Control and Information 37, 1348–1366 (2020)](port-hamiltonian-model-of-two-dimensional-shallow-water-equations-in-moving-containers) -- [10.1093/imamci/dnaa016](https://doi.org/10.1093/imamci/dnaa016)
- [Califano, F., Rashad, R., Schuller, F. P. & Stramigioli, S. Geometric and energy-aware decomposition of the Navier–Stokes equations: A port-Hamiltonian approach. Physics of Fluids 33, (2021)](geometric-and-energy-aware-decomposition-of-the-navier-stokes-equations-a-port-hamiltonian-approach) -- [10.1063/5.0048359](https://doi.org/10.1063/5.0048359)
- [Cardoso-Ribeiro, F. L., Matignon, D. & Lefèvre, L. Dissipative Shallow Water Equations: a port-Hamiltonian formulation. IFAC-PapersOnLine 54, 167–172 (2021)](dissipative-shallow-water-equations-a-port-hamiltonian-formulation) -- [10.1016/j.ifacol.2021.11.073](https://doi.org/10.1016/j.ifacol.2021.11.073)
- Limache, A. C., Sánchez, P. J., Dalcín, L. D. & Idelsohn, S. R. Objectivity tests for Navier–Stokes simulations: The revealing of non-physical solutions produced by Laplace formulations. Computer Methods in Applied Mechanics and Engineering 197, 4180–4192 (2008) -- [10.1016/j.cma.2008.04.020](https://doi.org/10.1016/j.cma.2008.04.020)
- A Bossavit, Computational electromagnetism: variational formulations, complementarity, edge elements (1998)
- [Kotyczka, P., Maschke, B. & Lefèvre, L. Weak form of Stokes–Dirac structures and geometric discretization of port-Hamiltonian systems. Journal of Computational Physics 361, 442–476 (2018)](weak-form-of-stokes-dirac-structures-and-geometric-discretization-of-port-hamiltonian-systems) -- [10.1016/j.jcp.2018.02.006](https://doi.org/10.1016/j.jcp.2018.02.006)
- [Cardoso-Ribeiro, F. L., Matignon, D. & Lefèvre, L. A partitioned finite element method for power-preserving discretization of open systems of conservation laws. IMA Journal of Mathematical Control and Information 38, 493–533 (2020)](a-partitioned-finite-element-method-for-power-preserving-discretization-of-open-systems-of-conservation-laws) -- [10.1093/imamci/dnaa038](https://doi.org/10.1093/imamci/dnaa038)
- [Ferraro, G., Fournié, M. & Haine, G. Simulation and control of interactions in multi-physics, a Python package for port-Hamiltonian systems. IFAC-PapersOnLine 58, 119–124 (2024)](simulation-and-control-of-interactions-in-multi-physics-a-python-package-for-port-hamiltonian-systems) -- [10.1016/j.ifacol.2024.08.267](https://doi.org/10.1016/j.ifacol.2024.08.267)
- [Ghislain Haine, G. H., Denis Matignon, D. M. & Anass Serhani, A. S. Numerical Analysis of a Structure-Preserving Space-Discretization for an Anisotropic and Heterogeneous Boundary Controlled $N$-Dimensional Wave Equation as a Port-Hamiltonian System. IJNAM 20, 92–133 (2023)](numerical-analysis-of-a-structure-preserving-space-discretization-for-an-anisotropic-and-heterogeneous-boundary-controlled-n-dimensional-wave-equation-as-a-port-hamiltonian-system) -- [10.4208/ijnam2023-1005](https://doi.org/10.4208/ijnam2023-1005)
- Boyer, F. & Fabrie, P. Mathematical Tools for the Study of the Incompressible Navier-Stokes Equations and Related Models. Applied Mathematical Sciences (Springer New York, 2013). doi:10.1007/978-1-4614-5975-0 -- [10.1007/978-1-4614-5975-0](https://doi.org/10.1007/978-1-4614-5975-0)
- Cotter, C. J. Compatible finite element methods for geophysical fluid dynamics. Acta Numerica 32, 291–393 (2023) -- [10.1017/s0962492923000028](https://doi.org/10.1017/s0962492923000028)
- Arnold, D. N., Falk, R. S. & Winther, R. Finite element exterior calculus, homological techniques, and applications. Acta Numerica 15, 1–155 (2006) -- [10.1017/s0962492906210018](https://doi.org/10.1017/s0962492906210018)
- Olver, P. J. Applications of Lie Groups to Differential Equations. Graduate Texts in Mathematics (Springer New York, 1993). doi:10.1007/978-1-4612-4350-2 -- [10.1007/978-1-4612-4350-2](https://doi.org/10.1007/978-1-4612-4350-2)
- [van der Schaft, A. J. & Maschke, B. M. Hamiltonian formulation of distributed-parameter systems with boundary energy flow. Journal of Geometry and Physics 42, 166–194 (2002)](hamiltonian-formulation-of-distributed-parameter-systems-with-boundary-energy-flow) -- [10.1016/s0393-0440(01)00083-3](https://doi.org/10.1016/s0393-0440(01)00083-3)
- [Mehrmann, V. & Unger, B. Control of port-Hamiltonian differential-algebraic systems and applications. Acta Numerica 32, 395–515 (2023)](control-of-port-hamiltonian-differential-algebraic-systems-and-applications) -- [10.1017/s0962492922000083](https://doi.org/10.1017/s0962492922000083)
- [Altmann, R. & Schulze, P. A port-Hamiltonian formulation of the Navier–Stokes equations for reactive flows. Systems &amp; Control Letters 100, 51–55 (2017)](a-port-hamiltonian-formulation-of-the-navier-stokes-equations-for-reactive-flows) -- [10.1016/j.sysconle.2016.12.005](https://doi.org/10.1016/j.sysconle.2016.12.005)
- AJ Chorin, A mathematical introduction to fluid mechanics (1992)
- [Brugnoli, A., Alazard, D., Pommier-Budinger, V. & Matignon, D. Port-Hamiltonian formulation and symplectic discretization of plate models Part I: Mindlin model for thick plates. Applied Mathematical Modelling 75, 940–960 (2019)](port-hamiltonian-formulation-and-symplectic-discretization-of-plate-models-part-i-mindlin-model-for-thick-plates) -- [10.1016/j.apm.2019.04.035](https://doi.org/10.1016/j.apm.2019.04.035)
- [Mora, L. A., Le Gorrec, Y., Matignon, D., Ramirez, H. & Yuz, J. I. On port-Hamiltonian formulations of 3-dimensional compressible Newtonian fluids. Physics of Fluids 33, (2021)](on-port-hamiltonian-formulations-of-3-dimensional-compressible-newtonian-fluids) -- [10.1063/5.0067784](https://doi.org/10.1063/5.0067784)
- Sundbye, L. Global Existence for the Dirichlet Problem for the Viscous Shallow Water Equations. Journal of Mathematical Analysis and Applications 202, 236–258 (1996) -- [10.1006/jmaa.1996.0315](https://doi.org/10.1006/jmaa.1996.0315)
- Kloeden, P. E. Global Existence of Classical Solutions in the Dissipative Shallow Water Equations. SIAM J. Math. Anal. 16, 301–315 (1985) -- [10.1137/0516022](https://doi.org/10.1137/0516022)
- [Serhani, A., Matignon, D. & Haine, G. A Partitioned Finite Element Method for the Structure-Preserving Discretization of Damped Infinite-Dimensional Port-Hamiltonian Systems with Boundary Control. Lecture Notes in Computer Science 549–558 (2019) doi:10.1007/978-3-030-26980-7_57](a-partitioned-finite-element-method-for-the-structure-preserving-discretization-of-damped-infinite-dimensional-port-hamiltonian-systems-with-boundary-control) -- [10.1007/978-3-030-26980-7_57](https://doi.org/10.1007/978-3-030-26980-7_57)
- AJ van der Schaft, Port-Hamiltonian differential-algebraic systems (2013)
- [Mehrmann, V. & van der Schaft, A. Differential–algebraic systems with dissipative Hamiltonian structure. Math. Control Signals Syst. 35, 541–584 (2023)](differential-algebraic-systems-with-dissipative-hamiltonian-structure) -- [10.1007/s00498-023-00349-2](https://doi.org/10.1007/s00498-023-00349-2)
- [Beattie, C., Mehrmann, V., Xu, H. & Zwart, H. Linear port-Hamiltonian descriptor systems. Math. Control Signals Syst. 30, (2018)](linear-port-hamiltonian-descriptor-systems) -- [10.1007/s00498-018-0223-3](https://doi.org/10.1007/s00498-018-0223-3)
- [van der Schaft, A. & Mehrmann, V. Linear port-Hamiltonian DAE systems revisited. Systems &amp; Control Letters 177, 105564 (2023)](linear-port-hamiltonian-dae-systems-revisited) -- [10.1016/j.sysconle.2023.105564](https://doi.org/10.1016/j.sysconle.2023.105564)
- [Bendimerad-Hohl, A., Haine, G., Matignon, D. & Maschke, B. Structure-preserving discretization of a coupled Allen-Cahn and heat equation system. IFAC-PapersOnLine 55, 99–104 (2022)](structure-preserving-discretization-of-a-coupled-allen-cahn-and-heat-equation-system) -- [10.1016/j.ifacol.2022.08.037](https://doi.org/10.1016/j.ifacol.2022.08.037)
- [Bendimerad-Hohl, A., Haine, G. & Matignon, D. Structure-preserving Discretization of the Cahn-Hilliard Equations Recast as a Port-Hamiltonian System. Lecture Notes in Computer Science 192–201 (2023) doi:10.1007/978-3-031-38299-4_21](structure-preserving-discretization-of-the-cahn-hilliard-equations-recast-as-a-port-hamiltonian-system) -- [10.1007/978-3-031-38299-4_21](https://doi.org/10.1007/978-3-031-38299-4_21)
- Balay, S. et al. PETSc/TAO Users Manual (Rev. 3.20). http://dx.doi.org/10.2172/2205494 (2023) doi:10.2172/2205494 -- [10.2172/2205494](https://doi.org/10.2172/2205494)
- Stoker, J. J. Water Waves. (1992) doi:10.1002/9781118033159 -- [10.1002/9781118033159](https://doi.org/10.1002/9781118033159)

