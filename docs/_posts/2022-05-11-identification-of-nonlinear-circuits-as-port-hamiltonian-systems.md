---
layout: post
title: "Identification of Nonlinear Circuits as Port-Hamiltonian Systems"
date: 2022-05-11 00:00:00 +0100
permalink: identification-of-nonlinear-circuits-as-port-hamiltonian-systems
year: 2021
authors: Judy Najnudel, Remy Muller, Thomas Helie, David Roze
category: proceedings
---
 
## Authors
[Judy Najnudel](authors/judy-najnudel), [Remy Muller](authors/remy-muller), [Thomas Helie](authors/thomas-helie), [David Roze](authors/david-roze)
 
## Abstract
This paper addresses identification of nonlinear circuits for power-balanced virtual analog modeling and simulation. The proposed method combines a port-Hamiltonian system formulation with kernel-based methods to retrieve model laws from measurements. This combination allows for the estimated model to retain physical properties that are crucial for the accuracy of simulations, while representing a variety of nonlinear behaviors. As an illustration, the method is used to identify a nonlinear passive peaking EQ.
 
## Citation
- **Journal:** 2021 24th International Conference on Digital Audio Effects (DAFx)
- **Year:** 2021
- **Volume:** 
- **Issue:** 
- **Pages:** 1--8
- **Publisher:** IEEE
- **DOI:** [10.23919/dafx51585.2021.9768224](https://doi.org/10.23919/dafx51585.2021.9768224)
 
## BibTeX
{% highlight bibtex %}
{% raw %}
@inproceedings{Najnudel_2021,
  title={{Identification of Nonlinear Circuits as Port-Hamiltonian Systems}},
  DOI={10.23919/dafx51585.2021.9768224},
  booktitle={{2021 24th International Conference on Digital Audio Effects (DAFx)}},
  publisher={IEEE},
  author={Najnudel, Judy and Muller, Remy and Helie, Thomas and Roze, David},
  year={2021},
  pages={1--8}
}
{% endraw %}
{% endhighlight %}
 
[Download the bib file]({{ site.baseurl }}/assets/bib/identification-of-nonlinear-circuits-as-port-hamiltonian-systems.bib)
 
## References
- Wendland, H. Piecewise polynomial, positive definite and compactly supported radial functions of minimal degree. Adv Comput Math 4, 389–396 (1995) -- [10.1007/bf02123482](https://doi.org/10.1007/bf02123482)
- mongillo, Choosing basis functions and shape pa-rameters for radial basis function methods. SIAM under-graduate research online (2011)
- higham, Analysis of the Cholesky Decomposition of A Semi-definite Matrix (1990)
- Biolek, Z., Biolek, D., Kolka, Z. & Biolkova, V. Real-World Capacitor as a Memcapacitive Element. 2018 New Trends in Signal Processing (NTSP) 1–6 (2018) doi:10.23919/ntsp.2018.8524089 -- [10.23919/ntsp.2018.8524089](https://doi.org/10.23919/ntsp.2018.8524089)
- najnudel, A power-balanced dynamic model of ferromagnetic coils. Proceedings of the 23rd International Conference on Digital Audio Effects (DAFx-20) (0)
- Bigelow, T. A. Power and Energy in Electric Circuits. Electric Circuits, Systems, and Motors 105–121 (2020) doi:10.1007/978-3-030-31355-5_4 -- [10.1007/978-3-030-31355-5_4](https://doi.org/10.1007/978-3-030-31355-5_4)
- Fasshauer, G. E. & Zhang, J. G. On choosing “optimal” shape parameters for RBF approximation. Numer Algor 45, 345–368 (2007) -- [10.1007/s11075-007-9072-8](https://doi.org/10.1007/s11075-007-9072-8)
- nelles, Nonlinear System Identification (2002)
- Schaback, R. Native Hilbert Spaces for Radial Basis Functions I. New Developments in Approximation Theory 255–282 (1999) doi:10.1007/978-3-0348-8696-3_16 -- [10.1007/978-3-0348-8696-3_16](https://doi.org/10.1007/978-3-0348-8696-3_16)
- benoit, Note sur une m&#x00E9;thode de resolution des &#x00E9;quations normales provenant de 1&#x2019; application de la m&#x00E9;thode des moindres carr&#x00E9;s &#x00E0; un syst&#x00E9;me d&#x2019; &#x00E9;quations lin&#x00E9;aires en nombre inf&#x00E9;rieur &#x00E0; celui des inconnues. Application de la m&#x00E9;thode &#x00E0; la r&#x00E9;solution d'un syst&#x00E8;me d&#x00E9;fini d'&#x00E9;quations lin&#x00E9;aires (prec&#x00E9;d&#x00E9; du Commandant Cholesky). Bull G&#x00E9;od&#x00E9;sique (1924)
- Helie, T. Volterra Series and State Transformation for Real-Time Simulations of Audio Circuits Including Saturations: Application to the Moog Ladder Filter. IEEE Trans. Audio Speech Lang. Process. 18, 747–759 (2010) -- [10.1109/tasl.2009.2035211](https://doi.org/10.1109/tasl.2009.2035211)
- schaback, A practical guide to radial basis functions. Electronic Resource (2007)
- Boyd, S., Tang, Y. & Chua, L. Measuring Volterra kernels. IEEE Trans. Circuits Syst. 30, 571–577 (1983) -- [10.1109/tcs.1983.1085391](https://doi.org/10.1109/tcs.1983.1085391)
- Orcioni, S., Terenzi, A., Cecchi, S., Piazza, F. & Carini, A. Identification of Volterra Models of Tube Audio Devices using Multiple-Variance Method. J. Audio Eng. Soc. 66, 823–838 (2018) -- [10.17743/jaes.2018.0046](https://doi.org/10.17743/jaes.2018.0046)
- bouvier, Phase-based order separation for Volterra series identification. Ternational Journal of Control (2019)
- sondhi, Lattice Wave Digital Filter based IIR system iden-tification with reduced coefficients. The International Symposium on Intelligent Systems Technologies and Applications (0)
- Paduart, J. et al. Identification of nonlinear systems using Polynomial Nonlinear State Space models. Automatica 46, 647–656 (2010) -- [10.1016/j.automatica.2010.01.001](https://doi.org/10.1016/j.automatica.2010.01.001)
- parker, Mod-elling of nonlinear state-space systems using a deep neural network. Proceedings of the 22rd International Confer-ence on Digital Audio Effects (DAFx-19) (2019)
- nercessian, Lightweight and interpretable neural modeling of an au-dio distortion effect using hyperconditioned differentiable bi-quads. ArXiv Preprint (2021)
- Maschke, B. M., Van Der Schaft, A. J. & Breedveld, P. C. An intrinsic hamiltonian formulation of network dynamics: non-standard poisson structures and gyrators. Journal of the Franklin Institute 329, 923–966 (1992) -- [10.1016/s0016-0032(92)90049-m](https://doi.org/10.1016/s0016-0032(92)90049-m)
- [van der Schaft, A. & Jeltsema, D. Port-Hamiltonian Systems Theory: An Introductory Overview. FnT in Systems and Control 1, 173–378 (2014)](port-hamiltonian-systems-theory-an-introductory-overview) -- [10.1561/2600000002](https://doi.org/10.1561/2600000002)
- lutter, Deep la-grangian networks: Using physics as model prior for deep learning. ArXiv Preprint (2019)
- cohen, Real-time simulation of a guitar power amplifier. Proceedings of the 13th International Conference on Digital Audio Effects (DAFx-10) (0)
- gillespie, Modeling non-linear circuits with linearized dynamical models via kernel regression. IEEE Workshop on Applications of Signal Processing to Audio and Acoustics (0)
- alberto, Wave digital modeling of nonlinear 3-terminal devices for virtual analog applications. Circuits Systems and Signal Processing (2020)
- Holters, M. & Zolzer, U. A generalized method for the derivation of non-linear state-space models from circuit schematics. 2015 23rd European Signal Processing Conference (EUSIPCO) 1073–1077 (2015) doi:10.1109/eusipco.2015.7362548 -- [10.1109/eusipco.2015.7362548](https://doi.org/10.1109/eusipco.2015.7362548)
- [Duindam, V., Macchelli, A., Stramigioli, S. & Bruyninckx, H. Modeling and Control of Complex Physical Systems. (Springer Berlin Heidelberg, 2009). doi:10.1007/978-3-642-03196-0](modeling-and-control-of-complex-physical-systems) -- [10.1007/978-3-642-03196-0](https://doi.org/10.1007/978-3-642-03196-0)
- macak, Simu-lation of Fender type guitar preamp using approximation and state space model. Proceedings of the 15th International Conference on Digital Audio Effects (DAFx-12) (0)
- Martínez Ramírez, M. A., Benetos, E. & Reiss, J. D. Deep Learning for Black-Box Modeling of Audio Effects. Applied Sciences 10, 638 (2020) -- [10.3390/app10020638](https://doi.org/10.3390/app10020638)
- damskägg, Real-time modeling of audio distortion circuits with deep learning. Proceedings of the International Sound and Mu-sic Computing Conference (SMC-19) (2019)
- Werner, K. J., Bernardini, A., Smith, J. O. & Sarti, A. Modeling Circuits With Arbitrary Topologies and Active Linear Multiports Using Wave Digital Filters. IEEE Trans. Circuits Syst. I 65, 4233–4246 (2018) -- [10.1109/tcsi.2018.2837912](https://doi.org/10.1109/tcsi.2018.2837912)
- Hélie, T. & Roze, D. Sound synthesis of a nonlinear string using Volterra series. Journal of Sound and Vibration 314, 275–306 (2008) -- [10.1016/j.jsv.2008.01.038](https://doi.org/10.1016/j.jsv.2008.01.038)
- Fettweis, A. Wave digital filters: Theory and practice. Proc. IEEE 74, 270–327 (1986) -- [10.1109/proc.1986.13458](https://doi.org/10.1109/proc.1986.13458)
- [Najnudel, J., Helie, T., Roze, D. & Boutin, H. Simulation of an Ondes Martenot Circuit. IEEE/ACM Trans. Audio Speech Lang. Process. 28, 2651–2660 (2020)](simulation-of-an-ondes-martenot-circuit) -- [10.1109/taslp.2020.3019643](https://doi.org/10.1109/taslp.2020.3019643)
- Park, J. & Sandberg, I. W. Universal Approximation Using Radial-Basis-Function Networks. Neural Computation 3, 246–257 (1991) -- [10.1162/neco.1991.3.2.246](https://doi.org/10.1162/neco.1991.3.2.246)
- bohn, Operator adjustable equalizers: An overview. Audio Engineering Society Conference 6th International Conference Sound Reinforcement (0)
- [Falaize, A. & Hélie, T. Passive Guaranteed Simulation of Analog Audio Circuits: A Port-Hamiltonian Approach. Applied Sciences 6, 273 (2016)](passive-guaranteed-simulation-of-analog-audio-circuits-a-port-hamiltonian-approach) -- [10.3390/app6100273](https://doi.org/10.3390/app6100273)
- Matsuda, T. & Miyatake, Y. Estimation of Ordinary Differential Equation Models with Discretization Error Quantification. SIAM/ASA J. Uncertainty Quantification 9, 302–331 (2021) -- [10.1137/19m1278405](https://doi.org/10.1137/19m1278405)
- vapnik, Support vector method for function approximation, regression estimation, and signal processing. Advances in neural information processing systems (1997)
- Cieśliński, J. L. & Ratkiewicz, B. Discrete gradient algorithms of high order for one-dimensional systems. Computer Physics Communications 183, 617–627 (2012) -- [10.1016/j.cpc.2011.12.008](https://doi.org/10.1016/j.cpc.2011.12.008)
- [Benner, P., Goyal, P. & Van Dooren, P. Identification of port-Hamiltonian systems from frequency response data. Systems &amp; Control Letters 143, 104741 (2020)](identification-of-port-hamiltonian-systems-from-frequency-response-data) -- [10.1016/j.sysconle.2020.104741](https://doi.org/10.1016/j.sysconle.2020.104741)
- mclachlan, Discrete gra-dient methods have an energy conservation law. ArXiv Preprint (2013)
- medianu, Identification for port-controlled Hamilto-nian systems (2017)
- Deuflhard, P. Newton Methods for Nonlinear Problems. Springer Series in Computational Mathematics (Springer Berlin Heidelberg, 2011). doi:10.1007/978-3-642-23899-4 -- [10.1007/978-3-642-23899-4](https://doi.org/10.1007/978-3-642-23899-4)
- Schaback, R. & Wendland, H. Kernel techniques: From machine learning to meshless methods. Acta Numerica 15, 543–639 (2006) -- [10.1017/s0962492906270016](https://doi.org/10.1017/s0962492906270016)
- Boyd, S. & Vandenberghe, L. Convex Optimization. (2004) doi:10.1017/cbo9780511804441 -- [10.1017/cbo9780511804441](https://doi.org/10.1017/cbo9780511804441)
- [Cherifi, K. An overview on recent machine learning techniques for Port Hamiltonian systems. Physica D: Nonlinear Phenomena 411, 132620 (2020)](an-overview-on-recent-machine-learning-techniques-for-port-hamiltonian-systems) -- [10.1016/j.physd.2020.132620](https://doi.org/10.1016/j.physd.2020.132620)

