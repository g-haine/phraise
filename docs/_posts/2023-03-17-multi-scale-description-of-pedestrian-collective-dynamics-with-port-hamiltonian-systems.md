---
layout: post
title: "Multi-scale description of pedestrian collective dynamics with port-Hamiltonian systems"
date: 2023-03-17 00:00:00 +0100
permalink: multi-scale-description-of-pedestrian-collective-dynamics-with-port-hamiltonian-systems
year: 2023
authors: Antoine Tordeux, Claudia Totzeck
category: journal-article
---
 
## Authors
[Antoine Tordeux](authors/antoine-tordeux), [Claudia Totzeck](authors/claudia-totzeck)
 
## Abstract
Port-Hamiltonian systems (PHS) theory is a recent but already well-established modelling approach for non-linear physical systems. Some studies have shown lately that PHS frameworks are relevant for modelling and control of swarm and multi-agent systems. We identify in this contribution a general class of microscopic force-based pedestrian models that can be formulated as a port-Hamiltonian system. The pedestrian PHS has linear structure and dissipation components. Non-linear effects come from isotropic pedestrian interactions. Simulation results on a torus with disordered initial states show that the port-Hamiltonian pedestrian model can exhibit different types of dynamics. They range from relaxed speed models with no interaction, dynamical billiards, or crystallization dynamics to realistic pedestrian collective behaviors, including lane and strip formation for counter and crossing flow. The port-Hamiltonian framework is a natural multiscale description of pedestrian dynamics as the Hamiltonian turns out to be a generic order parameter that allows us to identify specific behaviours of the dynamics from a macroscopic viewpoint. Particular cases even enable through energy balance to determine the Hamiltonian behavior without requiring the tedious computation of the microscopic dynamics. Using PHS theory, we systematically identify a critical threshold value for the Hamiltonian, which relies only on exogenous input and can be physically interpreted.
 
## Citation
- **Journal:** Networks and Heterogeneous Media
- **Year:** 2023
- **Volume:** 18
- **Issue:** 2
- **Pages:** 906--929
- **Publisher:** American Institute of Mathematical Sciences (AIMS)
- **DOI:** [10.3934/nhm.2023039](https://doi.org/10.3934/nhm.2023039)
 
## BibTeX
{% highlight bibtex %}
{% raw %}
@article{Tordeux_2023,
  title={{Multi-scale description of pedestrian collective dynamics with port-Hamiltonian systems}},
  volume={18},
  ISSN={1556-1801},
  DOI={10.3934/nhm.2023039},
  number={2},
  journal={Networks and Heterogeneous Media},
  publisher={American Institute of Mathematical Sciences (AIMS)},
  author={Tordeux, Antoine and Totzeck, Claudia},
  year={2023},
  pages={906--929}
}
{% endraw %}
{% endhighlight %}
 
## References
- [AJ van der Schaft, Port-hamiltonian systems: an introductory survey, <i>Proceedings of the international congress of mathematicians</i>, <b>3</b> (2006), 1339–1365.](port-hamiltonian-systems-an-introductory-survey) -- [10.4171/022-3/65](https://doi.org/10.4171/022-3/65)
- [AJ van der Schaft, D. Jeltsema, Port-hamiltonian systems theory: An introductory overview, <i>Found. Trends Syst. Control.</i>, <b>1</b> (2014), 173–378. https://doi.org/10.1561/2600000002](port-hamiltonian-systems-theory-an-introductory-overview-journal) -- [10.1561/2600000002](https://doi.org/10.1561/2600000002)
- AJ van der Schaft, Symmetries and conservation laws for hamiltonian systems with inputs and outputs: A generalization of Noether's theorem, <i>Syst. Control. Lett.</i>, <b>1</b> (1981). -- [10.1016/S0167-6911(81)80046-1](https://doi.org/10.1016/S0167-6911(81)80046-1)
- B. Maschke, A Van Der Schaft, P. C. Breedveld, An intrinsic hamiltonian formulation of network dynamics: Non-standard poisson structures and gyrators, <i>J Franklin Inst</i>, <b>329</b> (1992), 923–966. https://doi.org/10.1016/S0016-0032(92)90049-M -- [10.1016/S0016-0032(92)90049-M](https://doi.org/10.1016/S0016-0032(92)90049-M)
- [B. Maschke, AJ van der Schaft, Port-controlled hamiltonian systems: modelling origins and systemtheoretic properties, <i>Nonlinear Control Systems Design 1992</i>, Netherlands: Elsevier, 1993,359–365.](port-controlled-hamiltonian-systems-modelling-origins-and-systemtheoretic-properties-93) -- [10.1016/B978-0-08-041901-5.50064-6](https://doi.org/10.1016/B978-0-08-041901-5.50064-6)
- [AJ van der Schaft, Port-hamiltonian systems: network modeling and control of nonlinear physical systems, <i>Advanced dynamics and control of structures and machines</i>, Berlin: Springer, 2004,127–167.](port-hamiltonian-systems-network-modeling-and-control-of-nonlinear-physical-systems) -- [10.1007/978-3-7091-2774-2_9](https://doi.org/10.1007/978-3-7091-2774-2_9)
- [AJ van der Schaft, B. Maschke, Port-hamiltonian systems on graphs, <i>SIAM J Control Optim</i>, <b>51</b> (2013), 906–937. https://doi.org/10.1137/110840091](port-hamiltonian-systems-on-graphs) -- [10.1137/110840091](https://doi.org/10.1137/110840091)
- [R. Rashad, F. Califano, AJ van der Schaft, S. Stramigioli, Twenty years of distributed port-hamiltonian systems: a literature review, <i>IMA J. Math. Control. Inf.</i>, <b>37</b> (2020), 1400–1422. https://doi.org/10.1093/imamci/dnaa018](twenty-years-of-distributed-port-hamiltonian-systems-a-literature-review) -- [10.1093/imamci/dnaa018](https://doi.org/10.1093/imamci/dnaa018)
- S. Knorn, Z. Y. Chen, R. H Middleton, Overview: Collective control of multiagent systems, <i>IEEE Trans. Control. Netw. Syst.</i>, <b>3</b> (2015), 334–347. https://doi.org/10.1109/TCNS.2015.2468991 -- [10.1109/TCNS.2015.2468991](https://doi.org/10.1109/TCNS.2015.2468991)
- S. Knorn, A. Ahlén, Deviation bounds in multi agent systems described by undirected graphs, <i>Automatica</i>, <b>67</b> (2016), 205–210. https://doi.org/10.1016/j.automatica.2016.01.038 -- [10.1016/j.automatica.2016.01.038](https://doi.org/10.1016/j.automatica.2016.01.038)
- B. Wang, X. Wang, H. Wang, Output synchronization of multi-agent port-hamiltonian systems with link dynamics. <i>Kybernetika</i>, <b>52</b> (2016), 89–105. https://doi.org/10.1016/j.automatica.2016.01.038 -- [10.1016/j.automatica.2016.01.038](https://doi.org/10.1016/j.automatica.2016.01.038)
- A. Cristofaro, G. Giunta, P. R. Giordano, Fault-tolerant formation control of passive multi-agent systems using energy tanks, <i>IEEE Contr. Syst. Lett.</i>, <b>6</b> (2022), 2551–2556. https://doi.org/10.1109/LCSYS.2022.3169308 -- [10.1109/LCSYS.2022.3169308](https://doi.org/10.1109/LCSYS.2022.3169308)
- AJ van der Schaft, B. Maschke, Port-hamiltonian dynamics on graphs: Consensus and coordination control algorithms, <i>IFAC-PapersOnLine</i>, <b>43</b> (2010), 175–178. https://doi.org/10.3182/20100913-2-FR-4014.00012 -- [10.3182/20100913-2-FR-4014.00012](https://doi.org/10.3182/20100913-2-FR-4014.00012)
- [D. Xue, S. Hirche, M. Cao, Opinion behavior analysis in social networks under the influence of coopetitive media, <i>IEEE Trans. Netw. Sci. Eng.</i>, <b>7</b> (2019), 961–974. https://doi.org/10.1109/TNSE.2019.2894565](opinion-behavior-analysis-in-social-networks-under-the-influence-of-coopetitive-media) -- [10.1109/TNSE.2019.2894565](https://doi.org/10.1109/TNSE.2019.2894565)
- M. Sharf, D. Zelazo, Analysis and synthesis of MIMO multi-agent systems using network optimization, <i>IEEE Trans. Automat. Contr.</i>, <b>64</b> (2019), 4512–4524. https://doi.org/10.1109/TAC.2019.2908258 -- [10.1109/TAC.2019.2908258](https://doi.org/10.1109/TAC.2019.2908258)
- I. Matei, C.Mavridis, J. S Baras, M. Zhenirovskyy, Inferring particle interaction physical models and their dynamical properties, <i>2019 IEEE 58th Conference on Decision and Control (CDC)</i>, (2019), 4615–4621. -- [10.1109/CDC40024.2019.9029524](https://doi.org/10.1109/CDC40024.2019.9029524)
- [Y. Ma, J. Chen, J. M. Wang, Y. C. Xu, Y. X. Wang, Path-tracking considering yaw stability with passivity-based control for autonomous vehicles, <i>IEEE trans Intell Transp Syst</i>, <b>23</b> (2021), 8736–8746. https://doi.org/10.1109/TITS.2021.3085713](path-tracking-considering-yaw-stability-with-passivity-based-control-for-autonomous-vehicles) -- [10.1109/TITS.2021.3085713](https://doi.org/10.1109/TITS.2021.3085713)
- [S. Knorn, A. Donaire, J. C Agüero, R. H Middleton, Passivity-based control for multi-vehicle systems subject to string constraints, <i>Automatica</i>, <b>50</b> (2014), 3224–3230. https://doi.org/10.1016/j.automatica.2014.10.038](passivity-based-control-for-multi-vehicle-systems-subject-to-string-constraints) -- [10.1016/j.automatica.2014.10.038](https://doi.org/10.1016/j.automatica.2014.10.038)
- S. Dai, X. Koutsoukos, Safety analysis of integrated adaptive cruise control and lane keeping control using discrete-time models of port-hamiltonian systems. <i>2017 American Control Conference (ACC)</i>, (2017), 2980–2985. -- [10.23919/ACC.2017.7963404](https://doi.org/10.23919/ACC.2017.7963404)
- [S. Y Dai, X. Koutsoukos, Safety analysis of integrated adaptive cruise and lane keeping control using multi-modal port-hamiltonian systems, <i>NONLINEAR ANAL-HYBRI</i>, <b>35</b> (2020), 100816. https://doi.org/10.1016/j.nahs.2019.100816](safety-analysis-of-integrated-adaptive-cruise-and-lane-keeping-control-using-multi-modal-port-hamiltonian-systems) -- [10.1016/j.nahs.2019.100816](https://doi.org/10.1016/j.nahs.2019.100816)
- [H. Bansal, P Schulze, M. H. Abbasi, H. Zwart, L. Iapichino, W. H. A Schilders, et al., Port-hamiltonian formulation of two-phase flow models, <i>Syst. Control. Lett.</i>, <b>149</b> (2021), 104881. https://doi.org/10.1016/j.sysconle.2021.104881](port-hamiltonian-formulation-of-two-phase-flow-models) -- [10.1016/j.sysconle.2021.104881](https://doi.org/10.1016/j.sysconle.2021.104881)
- [R. Rashad, F. Califano, F. P Schuller, S. Stramigioli, Port-hamiltonian modeling of ideal fluid flow: Part i. foundations and kinetic energy, <i>J. Geom. Phys.</i>, <b>164</b> (2021), 104201. https://doi.org/10.1016/j.geomphys.2021.104201](port-hamiltonian-modeling-of-ideal-fluid-flow-part-i-foundations-and-kinetic-energy) -- [10.1016/j.geomphys.2021.104201](https://doi.org/10.1016/j.geomphys.2021.104201)
- K. Hirai, K Tarui, A simulation of the behavior of a crowd in panic, <i>Proceedings of the 1975 International Conference on Cybernetics and Society</i>, (1975), 409–411. https://doi.org/10.5694/j.1326-5377.1975.tb105931.x -- [10.5694/j.1326-5377.1975.tb105931.x](https://doi.org/10.5694/j.1326-5377.1975.tb105931.x)
- L. F. Henderson, The statistics of crowd fluids, <i>Nature</i>, <b>229</b> (1971), 381–383. https://doi.org/10.1038/229381a0 -- [10.1038/229381a0](https://doi.org/10.1038/229381a0)
- F. Martinez-Gil, M. Lozano, I. García-Fernández, F. Fernández, Modeling, evaluation, and scale on artificial pedestrians: a literature review, <i>ACM Comput Surv</i>, <b>50</b> (2017), 1–35. https://doi.org/10.1145/3117808 -- [10.1145/3117808](https://doi.org/10.1145/3117808)
- M. Chraibi, A. Tordeux, A. Schadschneider, A. Seyfried, <i>Modelling of Pedestrian and Evacuation Dynamics</i>, Heidelberg: Springer Berlin Heidelberg, 2018, 1–22. -- [10.1007/978-3-642-27737-5_705-1](https://doi.org/10.1007/978-3-642-27737-5_705-1)
- N. Bellomo, C. Dogbe, On the modeling of traffic and crowds: A survey of models, speculations, and perspectives, <i>SIAM review</i>, <b>53</b> (2011), 409–463. https://doi.org/10.1137/090746677 -- [10.1137/090746677](https://doi.org/10.1137/090746677)
- G. Albi, N. Bellomo, L. Fermo, S. Y Ha, J Kim, L. Pareschi, et al., Vehicular traffic, crowds, and swarms: From kinetic theory and multiscale methods to applications and research perspectives, <i>Math Models Methods Appl Sci</i>, <b>29</b> (2019), 1901–2005. https://doi.org/10.1142/S0218202519500374 -- [10.1142/S0218202519500374](https://doi.org/10.1142/S0218202519500374)
- N. Bellomo, L. Gibelli, A. Quaini, A. Reali, Towards a mathematical theory of behavioral human crowds, <i>Math Models Methods Appl Sci</i>, <b>32</b> (2022), 1–38. https://doi.org/10.1142/S0218202522500014 -- [10.1142/S0218202522500014](https://doi.org/10.1142/S0218202522500014)
- M. Fischer, G. Jankowiak, M. T. Wolfram, Micro- and macroscopic modeling of crowding and pushing in corridors, <i>Netw. Heterog. Media</i>, <b>15</b> (2020), 405–426. https://doi.org/10.3934/nhm.2020025 -- [10.3934/nhm.2020025](https://doi.org/10.3934/nhm.2020025)
- J. Barré, P. Degond, D. Peurichard, E. Zatorska, Modelling pattern formation through differential repulsion, <i>Netw. Heterog. Media</i>, <b>15</b> (2020), 307–352. https://doi.org/10.3934/nhm.2020021 -- [10.3934/nhm.2020021](https://doi.org/10.3934/nhm.2020021)
- M. Burger, L. M. Kreusser, C. Totzeck, Mean-field optimal control for biological pattern formation, <i>ESAIM CONTR OPTIM CA</i>, <b>27</b> (2021), 40. https://doi.org/10.1051/cocv/2021034 -- [10.1051/cocv/2021034](https://doi.org/10.1051/cocv/2021034)
- M. Burger, R. Pinnau, C. Totzeck, O. Tse, Mean-field optimal control and optimality conditions in the space of probability measures, <i>SIAM J Control Optim</i>, <b>59</b> (2021), 977–1006. https://doi.org/10.1137/19M1249461 -- [10.1137/19M1249461](https://doi.org/10.1137/19M1249461)
- D. Helbing, P. Molnár, Social force model for pedestrian dynamics, <i>Phys. Rev. E</i>, <b>51</b> (1995), 4282–4286. https://doi.org/10.1103/PhysRevE.51.4282 -- [10.1103/PhysRevE.51.4282](https://doi.org/10.1103/PhysRevE.51.4282)
- M. Chraibi, U. Kemloh, A. Schadschneider, A. Seyfried, Force-based models of pedestrian dynamics, <i>Netw. Heterog. Media</i>, <b>6</b> (2011), 425. https://doi.org/10.3934/nhm.2011.6.425 -- [10.3934/nhm.2011.6.425](https://doi.org/10.3934/nhm.2011.6.425)
- J van den Berg, M. Lin, D. Manocha, Reciprocal velocity obstacles for real-time multi-agent navigation, <i>2008 IEEE International Conference on Robotics and Automation</i>, 2008, 1928–1935. -- [10.1109/ROBOT.2008.4543489](https://doi.org/10.1109/ROBOT.2008.4543489)
- J van den Berg, S. Guy, M. Lin, D. Manocha, Reciprocal n-body collision avoidance, <i>Robotics Research: The 14th International Symposium ISRR</i>, 2011, 3–19. -- [10.1007/978-3-642-19457-3_1](https://doi.org/10.1007/978-3-642-19457-3_1)
- W. V. Toll, J. Pettré, Algorithms for microscopic crowd simulation: Advancements in the 2010s, <i>Computer Graphics Forum</i>, New York: Wiley Online Library, (2021), 731–754. -- [10.1111/cgf.142664](https://doi.org/10.1111/cgf.142664)
- M. Chraibi, T. Ezaki, A. Tordeux, K. Nishinari, A. Schadschneider, A. Seyfried, Jamming transitions in force-based models for pedestrian dynamics, <i>Phys Rev E</i>, <b>92</b> (2015), 042809. https://doi.org/10.1103/PhysRevE.92.042809 -- [10.1103/PhysRevE.92.042809](https://doi.org/10.1103/PhysRevE.92.042809)
- S. Nowak, A. Schadschneider, Quantitative analysis of pedestrian counterflow in a cellular automaton model, <i>Phy Rev E</i>, <b>85</b> (2012), 066128. -- [10.1103/PhysRevE.85.066128](https://doi.org/10.1103/PhysRevE.85.066128)
- B. Khelfa, R. Korbmacher, A. Schadschneider, A. Tordeux, Heterogeneity-induced lane and band formation in self-driven particle systems, <i>Sci. Rep.</i>, <b>12</b> (2022), 1–11. https://doi.org/10.1038/s41598-021-99269-x -- [10.1038/s41598-021-99269-x](https://doi.org/10.1038/s41598-021-99269-x)
- C. Totzeck, An anisotropic interaction model with collision avoidance, <i>Kinet. Relat. Models</i>, <b>13</b> (2020), 1219–1242. https://doi.org/10.3934/krm.2020044 -- [10.3934/krm.2020044](https://doi.org/10.3934/krm.2020044)
- R. Ortega, AJ Van Der Schaft, I. Mareels, B. Maschke, Putting energy back in control, <i>IEEE Control Syst</i>, <b>21</b> (2001), 18–33. -- [10.1109/37.915398](https://doi.org/10.1109/37.915398)
- A. Seyfried, B. Steffen, W. Klingsch, M. Boltes, The fundamental diagram of pedestrian movement revisited, <i>J. Stat. Mech. Theory Exp.</i>, <b>2005</b> (2005), P10002. https://doi.org/10.1109/37.915398 -- [10.1109/37.915398](https://doi.org/10.1109/37.915398)
- M. Chraibi, A. Seyfried, A. Schadschneider, Generalized centrifugal-force model for pedestrian dynamics, <i>Physical Review E</i>, <b>82</b> (2010), 046111. https://doi.org/10.1063/1.3584870 -- [10.1063/1.3584870](https://doi.org/10.1063/1.3584870)
- A. Tordeux, M. Chraibi, A. Seyfried, Collision-free speed model for pedestrian dynamics, <i>Traffic and Granular Flow'15</i>, Berlin: Springer, 2016,225–232.. -- [10.1007/978-3-319-33482-0_29](https://doi.org/10.1007/978-3-319-33482-0_29)
- U. Wilensky, Netlogo. Evanston, IL: Center for connected learning and computer-based modeling, <i>Northwestern University</i>, (1999).
- M. Boltes, J. Zhang, A. Tordeux, A. Schadschneider, A. Seyfried, <i>Empirical Results of Pedestrian and Evacuation Dynamics</i>, Heidelberg: Springer, 2018, 1–29. -- [10.1007/978-3-642-27737-5_706-1](https://doi.org/10.1007/978-3-642-27737-5_706-1)
- A. Schadschneider, M. Chraibi, A. Seyfried, A. Tordeux, J. Zhan, <i>Pedestrian Dynamics–From Empirical Results to Modeling</i>, Birkhäuser: Cham Press, 2018, 63–102. -- [10.1007/978-3-030-05129-7_4](https://doi.org/10.1007/978-3-030-05129-7_4)
- M. Rex, H. Löwen, Lane formation in oppositely charged colloids driven by an electric field: Chaining and two-dimensional crystallization, <i>Phys. Rev. E</i>, <b>75</b> (2007), 051402. -- [10.1103/PhysRevE.75.051402](https://doi.org/10.1103/PhysRevE.75.051402)
- S. Nowak, A. Schadschneider, Quantitative analysis of pedestrian counterflow in a cellular automaton model, <i>Phys. Rev. E</i>, <b>85</b> (2012), 066128. -- [10.1103/PhysRevE.85.066128](https://doi.org/10.1103/PhysRevE.85.066128)
- Q. C Xu, M. Chraibi, A. Tordeux, J. Zhang, Generalized collision-free velocity model for pedestrian dynamics, <i>Physica A</i>, <b>535</b> (2019), 122521. https://doi.org/10.1016/j.physa.2019.122521 -- [10.1016/j.physa.2019.122521](https://doi.org/10.1016/j.physa.2019.122521)

